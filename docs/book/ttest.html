<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 13 Comparing two means | Learning statistics with R: A tutorial for psychology students and other beginners. (Version 0.6.1)</title>
  <meta name="description" content="Learning Statistics with R covers the contents of an introductory statistics class, as typically taught to undergraduate psychology students, focusing on the use of the R statistical software.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 13 Comparing two means | Learning statistics with R: A tutorial for psychology students and other beginners. (Version 0.6.1)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Learning Statistics with R covers the contents of an introductory statistics class, as typically taught to undergraduate psychology students, focusing on the use of the R statistical software." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Comparing two means | Learning statistics with R: A tutorial for psychology students and other beginners. (Version 0.6.1)" />
  
  <meta name="twitter:description" content="Learning Statistics with R covers the contents of an introductory statistics class, as typically taught to undergraduate psychology students, focusing on the use of the R statistical software." />
  

<meta name="author" content="Danielle Navarro (bookdown translation: Emily Kothe)">


<meta name="date" content="2019-01-11">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chisquare.html">
<link rel="next" href="anova.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />








<!-- ###### start inserted header ##### -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115940772-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-115940772-1');
</script>

<!-- plausible analytics -->
<script async defer data-domain="learningstatisticswithr.com" src="https://plausible.io/js/plausible.js"></script>

<!-- add the twitter card and open graph tags -->
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@djnavarro">
<meta property="og:image" content="http://learningstatisticswithr.com/images/jasmine-faint.jpg">
<meta name="twitter:image" content="http://learningstatisticswithr.com/images/jasmine-faint.jpg">

<!-- ###### end inserted header ##### -->


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Learning Statistics with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="licensing.html"><a href="licensing.html"><i class="fa fa-check"></i>Licensing</a></li>
<li class="chapter" data-level="" data-path="dedication.html"><a href="dedication.html"><i class="fa fa-check"></i>Dedication</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="preface.html"><a href="preface.html#preface-to-version-0.6.1"><i class="fa fa-check"></i><b>0.1</b> Preface to Version 0.6.1</a></li>
<li class="chapter" data-level="0.2" data-path="preface.html"><a href="preface.html#preface-to-version-0.6"><i class="fa fa-check"></i><b>0.2</b> Preface to Version 0.6</a></li>
<li class="chapter" data-level="0.3" data-path="preface.html"><a href="preface.html#preface-to-version-0.5"><i class="fa fa-check"></i><b>0.3</b> Preface to Version 0.5</a></li>
<li class="chapter" data-level="0.4" data-path="preface.html"><a href="preface.html#preface-to-version-0.4"><i class="fa fa-check"></i><b>0.4</b> Preface to Version 0.4</a></li>
<li class="chapter" data-level="0.5" data-path="preface.html"><a href="preface.html#preface-to-version-0.3"><i class="fa fa-check"></i><b>0.5</b> Preface to Version 0.3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-background.html"><a href="part-i-background.html"><i class="fa fa-check"></i>Part I. Background</a></li>
<li class="chapter" data-level="1" data-path="why-do-we-learn-statistics.html"><a href="why-do-we-learn-statistics.html"><i class="fa fa-check"></i><b>1</b> Why do we learn statistics?</a><ul>
<li class="chapter" data-level="1.1" data-path="why-do-we-learn-statistics.html"><a href="why-do-we-learn-statistics.html#whywhywhy"><i class="fa fa-check"></i><b>1.1</b> On the psychology of statistics</a><ul>
<li class="chapter" data-level="1.1.1" data-path="why-do-we-learn-statistics.html"><a href="why-do-we-learn-statistics.html#the-curse-of-belief-bias"><i class="fa fa-check"></i><b>1.1.1</b> The curse of belief bias</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="why-do-we-learn-statistics.html"><a href="why-do-we-learn-statistics.html#the-cautionary-tale-of-simpsons-paradox"><i class="fa fa-check"></i><b>1.2</b> The cautionary tale of Simpson’s paradox</a></li>
<li class="chapter" data-level="1.3" data-path="why-do-we-learn-statistics.html"><a href="why-do-we-learn-statistics.html#statistics-in-psychology"><i class="fa fa-check"></i><b>1.3</b> Statistics in psychology</a></li>
<li class="chapter" data-level="1.4" data-path="why-do-we-learn-statistics.html"><a href="why-do-we-learn-statistics.html#statistics-in-everyday-life"><i class="fa fa-check"></i><b>1.4</b> Statistics in everyday life</a></li>
<li class="chapter" data-level="1.5" data-path="why-do-we-learn-statistics.html"><a href="why-do-we-learn-statistics.html#theres-more-to-research-methods-than-statistics"><i class="fa fa-check"></i><b>1.5</b> There’s more to research methods than statistics</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="studydesign.html"><a href="studydesign.html"><i class="fa fa-check"></i><b>2</b> A brief introduction to research design</a><ul>
<li class="chapter" data-level="2.1" data-path="studydesign.html"><a href="studydesign.html#measurement"><i class="fa fa-check"></i><b>2.1</b> Introduction to psychological measurement</a><ul>
<li class="chapter" data-level="2.1.1" data-path="studydesign.html"><a href="studydesign.html#some-thoughts-about-psychological-measurement"><i class="fa fa-check"></i><b>2.1.1</b> Some thoughts about psychological measurement</a></li>
<li class="chapter" data-level="2.1.2" data-path="studydesign.html"><a href="studydesign.html#operationalisation-defining-your-measurement"><i class="fa fa-check"></i><b>2.1.2</b> Operationalisation: defining your measurement</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="studydesign.html"><a href="studydesign.html#scales"><i class="fa fa-check"></i><b>2.2</b> Scales of measurement</a><ul>
<li class="chapter" data-level="2.2.1" data-path="studydesign.html"><a href="studydesign.html#nominal-scale"><i class="fa fa-check"></i><b>2.2.1</b> Nominal scale</a></li>
<li class="chapter" data-level="2.2.2" data-path="studydesign.html"><a href="studydesign.html#ordinal-scale"><i class="fa fa-check"></i><b>2.2.2</b> Ordinal scale</a></li>
<li class="chapter" data-level="2.2.3" data-path="studydesign.html"><a href="studydesign.html#interval-scale"><i class="fa fa-check"></i><b>2.2.3</b> Interval scale</a></li>
<li class="chapter" data-level="2.2.4" data-path="studydesign.html"><a href="studydesign.html#ratio-scale"><i class="fa fa-check"></i><b>2.2.4</b> Ratio scale</a></li>
<li class="chapter" data-level="2.2.5" data-path="studydesign.html"><a href="studydesign.html#continuousdiscrete"><i class="fa fa-check"></i><b>2.2.5</b> Continuous versus discrete variables</a></li>
<li class="chapter" data-level="2.2.6" data-path="studydesign.html"><a href="studydesign.html#some-complexities"><i class="fa fa-check"></i><b>2.2.6</b> Some complexities</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="studydesign.html"><a href="studydesign.html#reliability"><i class="fa fa-check"></i><b>2.3</b> Assessing the reliability of a measurement</a></li>
<li class="chapter" data-level="2.4" data-path="studydesign.html"><a href="studydesign.html#ivdv"><i class="fa fa-check"></i><b>2.4</b> The “role” of variables: predictors and outcomes</a></li>
<li class="chapter" data-level="2.5" data-path="studydesign.html"><a href="studydesign.html#researchdesigns"><i class="fa fa-check"></i><b>2.5</b> Experimental and non-experimental research</a><ul>
<li class="chapter" data-level="2.5.1" data-path="studydesign.html"><a href="studydesign.html#experimental-research"><i class="fa fa-check"></i><b>2.5.1</b> Experimental research</a></li>
<li class="chapter" data-level="2.5.2" data-path="studydesign.html"><a href="studydesign.html#non-experimental-research"><i class="fa fa-check"></i><b>2.5.2</b> Non-experimental research</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="studydesign.html"><a href="studydesign.html#validity"><i class="fa fa-check"></i><b>2.6</b> Assessing the validity of a study</a><ul>
<li class="chapter" data-level="2.6.1" data-path="studydesign.html"><a href="studydesign.html#internal-validity"><i class="fa fa-check"></i><b>2.6.1</b> Internal validity</a></li>
<li class="chapter" data-level="2.6.2" data-path="studydesign.html"><a href="studydesign.html#external-validity"><i class="fa fa-check"></i><b>2.6.2</b> External validity</a></li>
<li class="chapter" data-level="2.6.3" data-path="studydesign.html"><a href="studydesign.html#construct-validity"><i class="fa fa-check"></i><b>2.6.3</b> Construct validity</a></li>
<li class="chapter" data-level="2.6.4" data-path="studydesign.html"><a href="studydesign.html#face-validity"><i class="fa fa-check"></i><b>2.6.4</b> Face validity</a></li>
<li class="chapter" data-level="2.6.5" data-path="studydesign.html"><a href="studydesign.html#ecological-validity"><i class="fa fa-check"></i><b>2.6.5</b> Ecological validity</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="studydesign.html"><a href="studydesign.html#confounds-artifacts-and-other-threats-to-validity"><i class="fa fa-check"></i><b>2.7</b> Confounds, artifacts and other threats to validity</a><ul>
<li class="chapter" data-level="2.7.1" data-path="studydesign.html"><a href="studydesign.html#history-effects"><i class="fa fa-check"></i><b>2.7.1</b> History effects</a></li>
<li class="chapter" data-level="2.7.2" data-path="studydesign.html"><a href="studydesign.html#maturation-effects"><i class="fa fa-check"></i><b>2.7.2</b> Maturation effects</a></li>
<li class="chapter" data-level="2.7.3" data-path="studydesign.html"><a href="studydesign.html#repeated-testing-effects"><i class="fa fa-check"></i><b>2.7.3</b> Repeated testing effects</a></li>
<li class="chapter" data-level="2.7.4" data-path="studydesign.html"><a href="studydesign.html#selection-bias"><i class="fa fa-check"></i><b>2.7.4</b> Selection bias</a></li>
<li class="chapter" data-level="2.7.5" data-path="studydesign.html"><a href="studydesign.html#differentialattrition"><i class="fa fa-check"></i><b>2.7.5</b> Differential attrition</a></li>
<li class="chapter" data-level="2.7.6" data-path="studydesign.html"><a href="studydesign.html#non-response-bias"><i class="fa fa-check"></i><b>2.7.6</b> Non-response bias</a></li>
<li class="chapter" data-level="2.7.7" data-path="studydesign.html"><a href="studydesign.html#regression-to-the-mean"><i class="fa fa-check"></i><b>2.7.7</b> Regression to the mean</a></li>
<li class="chapter" data-level="2.7.8" data-path="studydesign.html"><a href="studydesign.html#experimenter-bias"><i class="fa fa-check"></i><b>2.7.8</b> Experimenter bias</a></li>
<li class="chapter" data-level="2.7.9" data-path="studydesign.html"><a href="studydesign.html#demand-effects-and-reactivity"><i class="fa fa-check"></i><b>2.7.9</b> Demand effects and reactivity</a></li>
<li class="chapter" data-level="2.7.10" data-path="studydesign.html"><a href="studydesign.html#placebo-effects"><i class="fa fa-check"></i><b>2.7.10</b> Placebo effects</a></li>
<li class="chapter" data-level="2.7.11" data-path="studydesign.html"><a href="studydesign.html#situation-measurement-and-subpopulation-effects"><i class="fa fa-check"></i><b>2.7.11</b> Situation, measurement and subpopulation effects</a></li>
<li class="chapter" data-level="2.7.12" data-path="studydesign.html"><a href="studydesign.html#fraud-deception-and-self-deception"><i class="fa fa-check"></i><b>2.7.12</b> Fraud, deception and self-deception</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="studydesign.html"><a href="studydesign.html#summary"><i class="fa fa-check"></i><b>2.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-an-introduction-to-r.html"><a href="part-ii-an-introduction-to-r.html"><i class="fa fa-check"></i>Part II. An introduction to R</a></li>
<li class="chapter" data-level="3" data-path="introR.html"><a href="introR.html"><i class="fa fa-check"></i><b>3</b> Getting started with R</a><ul>
<li class="chapter" data-level="3.1" data-path="introR.html"><a href="introR.html#gettingR"><i class="fa fa-check"></i><b>3.1</b> Installing R</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introR.html"><a href="introR.html#installing-r-on-a-windows-computer"><i class="fa fa-check"></i><b>3.1.1</b> Installing R on a Windows computer</a></li>
<li class="chapter" data-level="3.1.2" data-path="introR.html"><a href="introR.html#installing-r-on-a-mac"><i class="fa fa-check"></i><b>3.1.2</b> Installing R on a Mac</a></li>
<li class="chapter" data-level="3.1.3" data-path="introR.html"><a href="introR.html#installing-r-on-a-linux-computer"><i class="fa fa-check"></i><b>3.1.3</b> Installing R on a Linux computer</a></li>
<li class="chapter" data-level="3.1.4" data-path="introR.html"><a href="introR.html#installingrstudio"><i class="fa fa-check"></i><b>3.1.4</b> Downloading and installing RStudio</a></li>
<li class="chapter" data-level="3.1.5" data-path="introR.html"><a href="introR.html#startingR"><i class="fa fa-check"></i><b>3.1.5</b> Starting up R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introR.html"><a href="introR.html#firstcommand"><i class="fa fa-check"></i><b>3.2</b> Typing commands at the R console</a><ul>
<li class="chapter" data-level="3.2.1" data-path="introR.html"><a href="introR.html#an-important-digression-about-formatting"><i class="fa fa-check"></i><b>3.2.1</b> An important digression about formatting</a></li>
<li class="chapter" data-level="3.2.2" data-path="introR.html"><a href="introR.html#be-very-careful-to-avoid-typos"><i class="fa fa-check"></i><b>3.2.2</b> Be very careful to avoid typos</a></li>
<li class="chapter" data-level="3.2.3" data-path="introR.html"><a href="introR.html#r-is-a-bit-flexible-with-spacing"><i class="fa fa-check"></i><b>3.2.3</b> R is (a bit) flexible with spacing</a></li>
<li class="chapter" data-level="3.2.4" data-path="introR.html"><a href="introR.html#r-can-sometimes-tell-that-youre-not-finished-yet-but-not-often"><i class="fa fa-check"></i><b>3.2.4</b> R can sometimes tell that you’re not finished yet (but not often)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introR.html"><a href="introR.html#arithmetic"><i class="fa fa-check"></i><b>3.3</b> Doing simple calculations with R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="introR.html"><a href="introR.html#adding-subtracting-multiplying-and-dividing"><i class="fa fa-check"></i><b>3.3.1</b> Adding, subtracting, multiplying and dividing</a></li>
<li class="chapter" data-level="3.3.2" data-path="introR.html"><a href="introR.html#taking-powers"><i class="fa fa-check"></i><b>3.3.2</b> Taking powers</a></li>
<li class="chapter" data-level="3.3.3" data-path="introR.html"><a href="introR.html#bedmas"><i class="fa fa-check"></i><b>3.3.3</b> Doing calculations in the right order</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introR.html"><a href="introR.html#assign"><i class="fa fa-check"></i><b>3.4</b> Storing a number as a variable</a><ul>
<li class="chapter" data-level="3.4.1" data-path="introR.html"><a href="introR.html#variable-assignment-using---and--"><i class="fa fa-check"></i><b>3.4.1</b> Variable assignment using <code>&lt;-</code> and <code>-&gt;</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="introR.html"><a href="introR.html#doing-calculations-using-variables"><i class="fa fa-check"></i><b>3.4.2</b> Doing calculations using variables</a></li>
<li class="chapter" data-level="3.4.3" data-path="introR.html"><a href="introR.html#rules-and-conventions-for-naming-variables"><i class="fa fa-check"></i><b>3.4.3</b> Rules and conventions for naming variables</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introR.html"><a href="introR.html#usingfunctions"><i class="fa fa-check"></i><b>3.5</b> Using functions to do calculations</a><ul>
<li class="chapter" data-level="3.5.1" data-path="introR.html"><a href="introR.html#functionarguments"><i class="fa fa-check"></i><b>3.5.1</b> Function arguments, their names and their defaults</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introR.html"><a href="introR.html#RStudio1"><i class="fa fa-check"></i><b>3.6</b> Letting RStudio help you with your commands</a><ul>
<li class="chapter" data-level="3.6.1" data-path="introR.html"><a href="introR.html#autocomplete-using-tab"><i class="fa fa-check"></i><b>3.6.1</b> Autocomplete using “tab”</a></li>
<li class="chapter" data-level="3.6.2" data-path="introR.html"><a href="introR.html#browsing-your-command-history"><i class="fa fa-check"></i><b>3.6.2</b> Browsing your command history</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introR.html"><a href="introR.html#vectors"><i class="fa fa-check"></i><b>3.7</b> Storing many numbers as a vector</a><ul>
<li class="chapter" data-level="3.7.1" data-path="introR.html"><a href="introR.html#creating-a-vector"><i class="fa fa-check"></i><b>3.7.1</b> Creating a vector</a></li>
<li class="chapter" data-level="3.7.2" data-path="introR.html"><a href="introR.html#a-handy-digression"><i class="fa fa-check"></i><b>3.7.2</b> A handy digression</a></li>
<li class="chapter" data-level="3.7.3" data-path="introR.html"><a href="introR.html#vectorsubset"><i class="fa fa-check"></i><b>3.7.3</b> Getting information out of vectors</a></li>
<li class="chapter" data-level="3.7.4" data-path="introR.html"><a href="introR.html#altering-the-elements-of-a-vector"><i class="fa fa-check"></i><b>3.7.4</b> Altering the elements of a vector</a></li>
<li class="chapter" data-level="3.7.5" data-path="introR.html"><a href="introR.html#veclength"><i class="fa fa-check"></i><b>3.7.5</b> Useful things to know about vectors</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="introR.html"><a href="introR.html#text"><i class="fa fa-check"></i><b>3.8</b> Storing text data</a><ul>
<li class="chapter" data-level="3.8.1" data-path="introR.html"><a href="introR.html#simpletext"><i class="fa fa-check"></i><b>3.8.1</b> Working with text</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="introR.html"><a href="introR.html#logicals"><i class="fa fa-check"></i><b>3.9</b> Storing “true or false” data</a><ul>
<li class="chapter" data-level="3.9.1" data-path="introR.html"><a href="introR.html#assessing-mathematical-truths"><i class="fa fa-check"></i><b>3.9.1</b> Assessing mathematical truths</a></li>
<li class="chapter" data-level="3.9.2" data-path="introR.html"><a href="introR.html#logical-operations"><i class="fa fa-check"></i><b>3.9.2</b> Logical operations</a></li>
<li class="chapter" data-level="3.9.3" data-path="introR.html"><a href="introR.html#storing-and-using-logical-data"><i class="fa fa-check"></i><b>3.9.3</b> Storing and using logical data</a></li>
<li class="chapter" data-level="3.9.4" data-path="introR.html"><a href="introR.html#vectors-of-logicals"><i class="fa fa-check"></i><b>3.9.4</b> Vectors of logicals</a></li>
<li class="chapter" data-level="3.9.5" data-path="introR.html"><a href="introR.html#logictext"><i class="fa fa-check"></i><b>3.9.5</b> Applying logical operation to text</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="introR.html"><a href="introR.html#indexing"><i class="fa fa-check"></i><b>3.10</b> Indexing vectors</a><ul>
<li class="chapter" data-level="3.10.1" data-path="introR.html"><a href="introR.html#extracting-multiple-elements"><i class="fa fa-check"></i><b>3.10.1</b> Extracting multiple elements</a></li>
<li class="chapter" data-level="3.10.2" data-path="introR.html"><a href="introR.html#logical-indexing"><i class="fa fa-check"></i><b>3.10.2</b> Logical indexing</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="introR.html"><a href="introR.html#quitting-r"><i class="fa fa-check"></i><b>3.11</b> Quitting R</a></li>
<li class="chapter" data-level="3.12" data-path="introR.html"><a href="introR.html#summary-1"><i class="fa fa-check"></i><b>3.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mechanics.html"><a href="mechanics.html"><i class="fa fa-check"></i><b>4</b> Additional R concepts</a><ul>
<li class="chapter" data-level="4.1" data-path="mechanics.html"><a href="mechanics.html#comments"><i class="fa fa-check"></i><b>4.1</b> Using comments</a></li>
<li class="chapter" data-level="4.2" data-path="mechanics.html"><a href="mechanics.html#packageinstall"><i class="fa fa-check"></i><b>4.2</b> Installing and loading packages</a><ul>
<li class="chapter" data-level="4.2.1" data-path="mechanics.html"><a href="mechanics.html#the-package-panel-in-rstudio"><i class="fa fa-check"></i><b>4.2.1</b> The package panel in RStudio</a></li>
<li class="chapter" data-level="4.2.2" data-path="mechanics.html"><a href="mechanics.html#packageload"><i class="fa fa-check"></i><b>4.2.2</b> Loading a package</a></li>
<li class="chapter" data-level="4.2.3" data-path="mechanics.html"><a href="mechanics.html#packageunload"><i class="fa fa-check"></i><b>4.2.3</b> Unloading a package</a></li>
<li class="chapter" data-level="4.2.4" data-path="mechanics.html"><a href="mechanics.html#a-few-extra-comments"><i class="fa fa-check"></i><b>4.2.4</b> A few extra comments</a></li>
<li class="chapter" data-level="4.2.5" data-path="mechanics.html"><a href="mechanics.html#downloading-new-packages"><i class="fa fa-check"></i><b>4.2.5</b> Downloading new packages</a></li>
<li class="chapter" data-level="4.2.6" data-path="mechanics.html"><a href="mechanics.html#updating-r-and-r-packages"><i class="fa fa-check"></i><b>4.2.6</b> Updating R and R packages</a></li>
<li class="chapter" data-level="4.2.7" data-path="mechanics.html"><a href="mechanics.html#what-packages-does-this-book-use"><i class="fa fa-check"></i><b>4.2.7</b> What packages does this book use?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mechanics.html"><a href="mechanics.html#workspace"><i class="fa fa-check"></i><b>4.3</b> Managing the workspace</a><ul>
<li class="chapter" data-level="4.3.1" data-path="mechanics.html"><a href="mechanics.html#listing-the-contents-of-the-workspace"><i class="fa fa-check"></i><b>4.3.1</b> Listing the contents of the workspace</a></li>
<li class="chapter" data-level="4.3.2" data-path="mechanics.html"><a href="mechanics.html#removing-variables-from-the-workspace"><i class="fa fa-check"></i><b>4.3.2</b> Removing variables from the workspace</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="mechanics.html"><a href="mechanics.html#navigation"><i class="fa fa-check"></i><b>4.4</b> Navigating the file system</a><ul>
<li class="chapter" data-level="4.4.1" data-path="mechanics.html"><a href="mechanics.html#filesystem"><i class="fa fa-check"></i><b>4.4.1</b> The file system itself</a></li>
<li class="chapter" data-level="4.4.2" data-path="mechanics.html"><a href="mechanics.html#navigationR"><i class="fa fa-check"></i><b>4.4.2</b> Navigating the file system using the R console</a></li>
<li class="chapter" data-level="4.4.3" data-path="mechanics.html"><a href="mechanics.html#why-do-the-windows-paths-use-the-wrong-slash"><i class="fa fa-check"></i><b>4.4.3</b> Why do the Windows paths use the wrong slash?</a></li>
<li class="chapter" data-level="4.4.4" data-path="mechanics.html"><a href="mechanics.html#nav3"><i class="fa fa-check"></i><b>4.4.4</b> Navigating the file system using the RStudio file panel</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="mechanics.html"><a href="mechanics.html#load"><i class="fa fa-check"></i><b>4.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="4.5.1" data-path="mechanics.html"><a href="mechanics.html#loading-workspace-files-using-r"><i class="fa fa-check"></i><b>4.5.1</b> Loading workspace files using R</a></li>
<li class="chapter" data-level="4.5.2" data-path="mechanics.html"><a href="mechanics.html#loading-workspace-files-using-rstudio"><i class="fa fa-check"></i><b>4.5.2</b> Loading workspace files using RStudio</a></li>
<li class="chapter" data-level="4.5.3" data-path="mechanics.html"><a href="mechanics.html#importing-data-from-csv-files-using-loadingcsv"><i class="fa fa-check"></i><b>4.5.3</b> Importing data from CSV files using <code id="loadingcsv">loadingcsv</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="mechanics.html"><a href="mechanics.html#importing-data-from-csv-files-using-rstudio"><i class="fa fa-check"></i><b>4.5.4</b> Importing data from CSV files using RStudio</a></li>
<li class="chapter" data-level="4.5.5" data-path="mechanics.html"><a href="mechanics.html#saving-a-workspace-file-using-save"><i class="fa fa-check"></i><b>4.5.5</b> Saving a workspace file using <code>save</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="mechanics.html"><a href="mechanics.html#save1"><i class="fa fa-check"></i><b>4.5.6</b> Saving a workspace file using RStudio</a></li>
<li class="chapter" data-level="4.5.7" data-path="mechanics.html"><a href="mechanics.html#other-things-you-might-want-to-save"><i class="fa fa-check"></i><b>4.5.7</b> Other things you might want to save</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mechanics.html"><a href="mechanics.html#useful"><i class="fa fa-check"></i><b>4.6</b> Useful things to know about variables</a><ul>
<li class="chapter" data-level="4.6.1" data-path="mechanics.html"><a href="mechanics.html#specials"><i class="fa fa-check"></i><b>4.6.1</b> Special values</a></li>
<li class="chapter" data-level="4.6.2" data-path="mechanics.html"><a href="mechanics.html#names"><i class="fa fa-check"></i><b>4.6.2</b> Assigning names to vector elements</a></li>
<li class="chapter" data-level="4.6.3" data-path="mechanics.html"><a href="mechanics.html#variable-classes"><i class="fa fa-check"></i><b>4.6.3</b> Variable classes</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="mechanics.html"><a href="mechanics.html#factors"><i class="fa fa-check"></i><b>4.7</b> Factors</a><ul>
<li class="chapter" data-level="4.7.1" data-path="mechanics.html"><a href="mechanics.html#introducing-factors"><i class="fa fa-check"></i><b>4.7.1</b> Introducing factors</a></li>
<li class="chapter" data-level="4.7.2" data-path="mechanics.html"><a href="mechanics.html#labelling-the-factor-levels"><i class="fa fa-check"></i><b>4.7.2</b> Labelling the factor levels</a></li>
<li class="chapter" data-level="4.7.3" data-path="mechanics.html"><a href="mechanics.html#moving-on"><i class="fa fa-check"></i><b>4.7.3</b> Moving on…</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="mechanics.html"><a href="mechanics.html#dataframes"><i class="fa fa-check"></i><b>4.8</b> Data frames</a><ul>
<li class="chapter" data-level="4.8.1" data-path="mechanics.html"><a href="mechanics.html#introducing-data-frames"><i class="fa fa-check"></i><b>4.8.1</b> Introducing data frames</a></li>
<li class="chapter" data-level="4.8.2" data-path="mechanics.html"><a href="mechanics.html#pulling-out-the-contents-of-the-data-frame-using"><i class="fa fa-check"></i><b>4.8.2</b> Pulling out the contents of the data frame using <code>$</code></a></li>
<li class="chapter" data-level="4.8.3" data-path="mechanics.html"><a href="mechanics.html#getting-information-about-a-data-frame"><i class="fa fa-check"></i><b>4.8.3</b> Getting information about a data frame</a></li>
<li class="chapter" data-level="4.8.4" data-path="mechanics.html"><a href="mechanics.html#looking-for-more-on-data-frames"><i class="fa fa-check"></i><b>4.8.4</b> Looking for more on data frames?</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="mechanics.html"><a href="mechanics.html#lists"><i class="fa fa-check"></i><b>4.9</b> Lists</a></li>
<li class="chapter" data-level="4.10" data-path="mechanics.html"><a href="mechanics.html#formulas"><i class="fa fa-check"></i><b>4.10</b> Formulas</a></li>
<li class="chapter" data-level="4.11" data-path="mechanics.html"><a href="mechanics.html#generics"><i class="fa fa-check"></i><b>4.11</b> Generic functions</a></li>
<li class="chapter" data-level="4.12" data-path="mechanics.html"><a href="mechanics.html#help"><i class="fa fa-check"></i><b>4.12</b> Getting help</a><ul>
<li class="chapter" data-level="4.12.1" data-path="mechanics.html"><a href="mechanics.html#how-to-read-the-help-documentation"><i class="fa fa-check"></i><b>4.12.1</b> How to read the help documentation</a></li>
<li class="chapter" data-level="4.12.2" data-path="mechanics.html"><a href="mechanics.html#other-resources"><i class="fa fa-check"></i><b>4.12.2</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="mechanics.html"><a href="mechanics.html#summary-2"><i class="fa fa-check"></i><b>4.13</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-working-with-data.html"><a href="part-iii-working-with-data.html"><i class="fa fa-check"></i>Part III. Working with data</a></li>
<li class="chapter" data-level="5" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>5</b> Descriptive statistics</a><ul>
<li class="chapter" data-level="5.1" data-path="descriptives.html"><a href="descriptives.html#centraltendency"><i class="fa fa-check"></i><b>5.1</b> Measures of central tendency</a><ul>
<li class="chapter" data-level="5.1.1" data-path="descriptives.html"><a href="descriptives.html#mean"><i class="fa fa-check"></i><b>5.1.1</b> The mean</a></li>
<li class="chapter" data-level="5.1.2" data-path="descriptives.html"><a href="descriptives.html#calculating-the-mean-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Calculating the mean in R</a></li>
<li class="chapter" data-level="5.1.3" data-path="descriptives.html"><a href="descriptives.html#median"><i class="fa fa-check"></i><b>5.1.3</b> The median</a></li>
<li class="chapter" data-level="5.1.4" data-path="descriptives.html"><a href="descriptives.html#mean-or-median-whats-the-difference"><i class="fa fa-check"></i><b>5.1.4</b> Mean or median? What’s the difference?</a></li>
<li class="chapter" data-level="5.1.5" data-path="descriptives.html"><a href="descriptives.html#housingpriceexample"><i class="fa fa-check"></i><b>5.1.5</b> A real life example</a></li>
<li class="chapter" data-level="5.1.6" data-path="descriptives.html"><a href="descriptives.html#trimmedmean"><i class="fa fa-check"></i><b>5.1.6</b> Trimmed mean</a></li>
<li class="chapter" data-level="5.1.7" data-path="descriptives.html"><a href="descriptives.html#mode"><i class="fa fa-check"></i><b>5.1.7</b> Mode</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="descriptives.html"><a href="descriptives.html#var"><i class="fa fa-check"></i><b>5.2</b> Measures of variability</a><ul>
<li class="chapter" data-level="5.2.1" data-path="descriptives.html"><a href="descriptives.html#range"><i class="fa fa-check"></i><b>5.2.1</b> Range</a></li>
<li class="chapter" data-level="5.2.2" data-path="descriptives.html"><a href="descriptives.html#interquartile-range"><i class="fa fa-check"></i><b>5.2.2</b> Interquartile range</a></li>
<li class="chapter" data-level="5.2.3" data-path="descriptives.html"><a href="descriptives.html#aad"><i class="fa fa-check"></i><b>5.2.3</b> Mean absolute deviation</a></li>
<li class="chapter" data-level="5.2.4" data-path="descriptives.html"><a href="descriptives.html#variance"><i class="fa fa-check"></i><b>5.2.4</b> Variance</a></li>
<li class="chapter" data-level="5.2.5" data-path="descriptives.html"><a href="descriptives.html#sd"><i class="fa fa-check"></i><b>5.2.5</b> Standard deviation</a></li>
<li class="chapter" data-level="5.2.6" data-path="descriptives.html"><a href="descriptives.html#mad"><i class="fa fa-check"></i><b>5.2.6</b> Median absolute deviation</a></li>
<li class="chapter" data-level="5.2.7" data-path="descriptives.html"><a href="descriptives.html#which-measure-to-use"><i class="fa fa-check"></i><b>5.2.7</b> Which measure to use?</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="descriptives.html"><a href="descriptives.html#skew"><i class="fa fa-check"></i><b>5.3</b> Skew</a></li>
<li class="chapter" data-level="5.4" data-path="studydesign.html"><a href="studydesign.html#summary"><i class="fa fa-check"></i><b>5.4</b> Getting an overall summary of a variable</a><ul>
<li class="chapter" data-level="5.4.1" data-path="descriptives.html"><a href="descriptives.html#summarising-a-variable"><i class="fa fa-check"></i><b>5.4.1</b> “Summarising” a variable</a></li>
<li class="chapter" data-level="5.4.2" data-path="descriptives.html"><a href="descriptives.html#summarising-a-data-frame"><i class="fa fa-check"></i><b>5.4.2</b> “Summarising” a data frame</a></li>
<li class="chapter" data-level="5.4.3" data-path="descriptives.html"><a href="descriptives.html#describing-a-data-frame"><i class="fa fa-check"></i><b>5.4.3</b> “Describing” a data frame</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="descriptives.html"><a href="descriptives.html#groupdescriptives"><i class="fa fa-check"></i><b>5.5</b> Descriptive statistics separately for each group</a></li>
<li class="chapter" data-level="5.6" data-path="descriptives.html"><a href="descriptives.html#zscore"><i class="fa fa-check"></i><b>5.6</b> Standard scores</a></li>
<li class="chapter" data-level="5.7" data-path="descriptives.html"><a href="descriptives.html#correl"><i class="fa fa-check"></i><b>5.7</b> Correlations</a><ul>
<li class="chapter" data-level="5.7.1" data-path="descriptives.html"><a href="descriptives.html#the-data"><i class="fa fa-check"></i><b>5.7.1</b> The data</a></li>
<li class="chapter" data-level="5.7.2" data-path="descriptives.html"><a href="descriptives.html#the-strength-and-direction-of-a-relationship"><i class="fa fa-check"></i><b>5.7.2</b> The strength and direction of a relationship</a></li>
<li class="chapter" data-level="5.7.3" data-path="descriptives.html"><a href="descriptives.html#the-correlation-coefficient"><i class="fa fa-check"></i><b>5.7.3</b> The correlation coefficient</a></li>
<li class="chapter" data-level="5.7.4" data-path="descriptives.html"><a href="descriptives.html#calculating-correlations-in-r"><i class="fa fa-check"></i><b>5.7.4</b> Calculating correlations in R</a></li>
<li class="chapter" data-level="5.7.5" data-path="descriptives.html"><a href="descriptives.html#interpretingcorrelations"><i class="fa fa-check"></i><b>5.7.5</b> Interpreting a correlation</a></li>
<li class="chapter" data-level="5.7.6" data-path="descriptives.html"><a href="descriptives.html#spearmans-rank-correlations"><i class="fa fa-check"></i><b>5.7.6</b> Spearman’s rank correlations</a></li>
<li class="chapter" data-level="5.7.7" data-path="descriptives.html"><a href="descriptives.html#the-correlate-function"><i class="fa fa-check"></i><b>5.7.7</b> The <code>correlate()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="descriptives.html"><a href="descriptives.html#missing"><i class="fa fa-check"></i><b>5.8</b> Handling missing values</a><ul>
<li class="chapter" data-level="5.8.1" data-path="descriptives.html"><a href="descriptives.html#the-single-variable-case"><i class="fa fa-check"></i><b>5.8.1</b> The single variable case</a></li>
<li class="chapter" data-level="5.8.2" data-path="descriptives.html"><a href="descriptives.html#missing-values-in-pairwise-calculations"><i class="fa fa-check"></i><b>5.8.2</b> Missing values in pairwise calculations</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="descriptives.html"><a href="descriptives.html#summary-3"><i class="fa fa-check"></i><b>5.9</b> Summary</a></li>
<li class="chapter" data-level="5.10" data-path="descriptives.html"><a href="descriptives.html#epilogue-good-descriptive-statistics-are-descriptive"><i class="fa fa-check"></i><b>5.10</b> Epilogue: Good descriptive statistics are descriptive!</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>6</b> Drawing graphs</a><ul>
<li class="chapter" data-level="6.1" data-path="graphics.html"><a href="graphics.html#rgraphics"><i class="fa fa-check"></i><b>6.1</b> An overview of R graphics</a></li>
<li class="chapter" data-level="6.2" data-path="graphics.html"><a href="graphics.html#introplotting"><i class="fa fa-check"></i><b>6.2</b> An introduction to plotting</a><ul>
<li class="chapter" data-level="6.2.1" data-path="graphics.html"><a href="graphics.html#a-tedious-digression"><i class="fa fa-check"></i><b>6.2.1</b> A tedious digression</a></li>
<li class="chapter" data-level="6.2.2" data-path="graphics.html"><a href="graphics.html#figtitles"><i class="fa fa-check"></i><b>6.2.2</b> Customising the title and the axis labels</a></li>
<li class="chapter" data-level="6.2.3" data-path="graphics.html"><a href="graphics.html#changing-the-plot-type"><i class="fa fa-check"></i><b>6.2.3</b> Changing the plot type</a></li>
<li class="chapter" data-level="6.2.4" data-path="graphics.html"><a href="graphics.html#changing-other-features-of-the-plot"><i class="fa fa-check"></i><b>6.2.4</b> Changing other features of the plot</a></li>
<li class="chapter" data-level="6.2.5" data-path="graphics.html"><a href="graphics.html#changing-the-appearance-of-the-axes"><i class="fa fa-check"></i><b>6.2.5</b> Changing the appearance of the axes</a></li>
<li class="chapter" data-level="6.2.6" data-path="graphics.html"><a href="graphics.html#dont-panic"><i class="fa fa-check"></i><b>6.2.6</b> Don’t panic</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="graphics.html"><a href="graphics.html#hist"><i class="fa fa-check"></i><b>6.3</b> Histograms</a><ul>
<li class="chapter" data-level="6.3.1" data-path="graphics.html"><a href="graphics.html#visual-style-of-your-histogram"><i class="fa fa-check"></i><b>6.3.1</b> Visual style of your histogram</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="graphics.html"><a href="graphics.html#stem"><i class="fa fa-check"></i><b>6.4</b> Stem and leaf plots</a></li>
<li class="chapter" data-level="6.5" data-path="graphics.html"><a href="graphics.html#boxplots"><i class="fa fa-check"></i><b>6.5</b> Boxplots</a><ul>
<li class="chapter" data-level="6.5.1" data-path="graphics.html"><a href="graphics.html#visual-style-of-your-boxplot"><i class="fa fa-check"></i><b>6.5.1</b> Visual style of your boxplot</a></li>
<li class="chapter" data-level="6.5.2" data-path="graphics.html"><a href="graphics.html#boxplotoutliers"><i class="fa fa-check"></i><b>6.5.2</b> Using box plots to detect outliers</a></li>
<li class="chapter" data-level="6.5.3" data-path="graphics.html"><a href="graphics.html#multipleboxplots"><i class="fa fa-check"></i><b>6.5.3</b> Drawing multiple boxplots</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="graphics.html"><a href="graphics.html#scatterplots"><i class="fa fa-check"></i><b>6.6</b> Scatterplots</a><ul>
<li class="chapter" data-level="6.6.1" data-path="graphics.html"><a href="graphics.html#more-elaborate-options"><i class="fa fa-check"></i><b>6.6.1</b> More elaborate options</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="graphics.html"><a href="graphics.html#bargraph"><i class="fa fa-check"></i><b>6.7</b> Bar graphs</a><ul>
<li class="chapter" data-level="6.7.1" data-path="graphics.html"><a href="graphics.html#par"><i class="fa fa-check"></i><b>6.7.1</b> Changing global settings using par()</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="graphics.html"><a href="graphics.html#saveimage"><i class="fa fa-check"></i><b>6.8</b> Saving image files using R and Rstudio</a><ul>
<li class="chapter" data-level="6.8.1" data-path="graphics.html"><a href="graphics.html#the-ugly-details-advanced"><i class="fa fa-check"></i><b>6.8.1</b> The ugly details (advanced)</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="graphics.html"><a href="graphics.html#summary-4"><i class="fa fa-check"></i><b>6.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datahandling.html"><a href="datahandling.html"><i class="fa fa-check"></i><b>7</b> Pragmatic matters</a><ul>
<li class="chapter" data-level="7.1" data-path="datahandling.html"><a href="datahandling.html#freqtables"><i class="fa fa-check"></i><b>7.1</b> Tabulating and cross-tabulating data</a><ul>
<li class="chapter" data-level="7.1.1" data-path="datahandling.html"><a href="datahandling.html#creating-tables-from-vectors"><i class="fa fa-check"></i><b>7.1.1</b> Creating tables from vectors</a></li>
<li class="chapter" data-level="7.1.2" data-path="datahandling.html"><a href="datahandling.html#creating-tables-from-data-frames"><i class="fa fa-check"></i><b>7.1.2</b> Creating tables from data frames</a></li>
<li class="chapter" data-level="7.1.3" data-path="datahandling.html"><a href="datahandling.html#converting-a-table-of-counts-to-a-table-of-proportions"><i class="fa fa-check"></i><b>7.1.3</b> Converting a table of counts to a table of proportions</a></li>
<li class="chapter" data-level="7.1.4" data-path="datahandling.html"><a href="datahandling.html#low-level-tabulation"><i class="fa fa-check"></i><b>7.1.4</b> Low level tabulation</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="datahandling.html"><a href="datahandling.html#transform"><i class="fa fa-check"></i><b>7.2</b> Transforming and recoding a variable</a><ul>
<li class="chapter" data-level="7.2.1" data-path="datahandling.html"><a href="datahandling.html#creating-a-transformed-variable"><i class="fa fa-check"></i><b>7.2.1</b> Creating a transformed variable</a></li>
<li class="chapter" data-level="7.2.2" data-path="datahandling.html"><a href="datahandling.html#cutting-a-numeric-variable-into-categories"><i class="fa fa-check"></i><b>7.2.2</b> Cutting a numeric variable into categories</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="datahandling.html"><a href="datahandling.html#mathfunc"><i class="fa fa-check"></i><b>7.3</b> A few more mathematical functions and operations</a><ul>
<li class="chapter" data-level="7.3.1" data-path="datahandling.html"><a href="datahandling.html#rounding-a-number"><i class="fa fa-check"></i><b>7.3.1</b> Rounding a number</a></li>
<li class="chapter" data-level="7.3.2" data-path="datahandling.html"><a href="datahandling.html#modulus-and-integer-division"><i class="fa fa-check"></i><b>7.3.2</b> Modulus and integer division</a></li>
<li class="chapter" data-level="7.3.3" data-path="datahandling.html"><a href="datahandling.html#logarithms-and-exponentials"><i class="fa fa-check"></i><b>7.3.3</b> Logarithms and exponentials</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="datahandling.html"><a href="datahandling.html#subset"><i class="fa fa-check"></i><b>7.4</b> Extracting a subset of a vector</a><ul>
<li class="chapter" data-level="7.4.1" data-path="datahandling.html"><a href="datahandling.html#refresher"><i class="fa fa-check"></i><b>7.4.1</b> Refresher</a></li>
<li class="chapter" data-level="7.4.2" data-path="datahandling.html"><a href="datahandling.html#using-in-to-match-multiple-cases"><i class="fa fa-check"></i><b>7.4.2</b> Using <code>%in%</code> to match multiple cases</a></li>
<li class="chapter" data-level="7.4.3" data-path="datahandling.html"><a href="datahandling.html#using-negative-indices-to-drop-elements"><i class="fa fa-check"></i><b>7.4.3</b> Using negative indices to drop elements</a></li>
<li class="chapter" data-level="7.4.4" data-path="datahandling.html"><a href="datahandling.html#splitting-a-vector-by-group"><i class="fa fa-check"></i><b>7.4.4</b> Splitting a vector by group</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="datahandling.html"><a href="datahandling.html#subsetdataframe"><i class="fa fa-check"></i><b>7.5</b> Extracting a subset of a data frame</a><ul>
<li class="chapter" data-level="7.5.1" data-path="datahandling.html"><a href="datahandling.html#using-the-subset-function"><i class="fa fa-check"></i><b>7.5.1</b> Using the <code>subset()</code> function</a></li>
<li class="chapter" data-level="7.5.2" data-path="datahandling.html"><a href="datahandling.html#using-square-brackets-i.-rows-and-columns"><i class="fa fa-check"></i><b>7.5.2</b> Using square brackets: I. Rows and columns</a></li>
<li class="chapter" data-level="7.5.3" data-path="datahandling.html"><a href="datahandling.html#using-square-brackets-ii.-some-elaborations"><i class="fa fa-check"></i><b>7.5.3</b> Using square brackets: II. Some elaborations</a></li>
<li class="chapter" data-level="7.5.4" data-path="datahandling.html"><a href="datahandling.html#dropping"><i class="fa fa-check"></i><b>7.5.4</b> Using square brackets: III. Understanding “dropping”</a></li>
<li class="chapter" data-level="7.5.5" data-path="datahandling.html"><a href="datahandling.html#using-square-brackets-iv.-columns-only"><i class="fa fa-check"></i><b>7.5.5</b> Using square brackets: IV. Columns only</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="datahandling.html"><a href="datahandling.html#sort"><i class="fa fa-check"></i><b>7.6</b> Sorting, flipping and merging data</a><ul>
<li class="chapter" data-level="7.6.1" data-path="datahandling.html"><a href="datahandling.html#sorting-a-numeric-or-character-vector"><i class="fa fa-check"></i><b>7.6.1</b> Sorting a numeric or character vector</a></li>
<li class="chapter" data-level="7.6.2" data-path="datahandling.html"><a href="datahandling.html#sorting-a-factor"><i class="fa fa-check"></i><b>7.6.2</b> Sorting a factor</a></li>
<li class="chapter" data-level="7.6.3" data-path="datahandling.html"><a href="datahandling.html#sortframe"><i class="fa fa-check"></i><b>7.6.3</b> Sorting a data frame</a></li>
<li class="chapter" data-level="7.6.4" data-path="datahandling.html"><a href="datahandling.html#binding-vectors-together"><i class="fa fa-check"></i><b>7.6.4</b> Binding vectors together</a></li>
<li class="chapter" data-level="7.6.5" data-path="datahandling.html"><a href="datahandling.html#binding-multiple-copies-of-the-same-vector-together"><i class="fa fa-check"></i><b>7.6.5</b> Binding multiple copies of the same vector together</a></li>
<li class="chapter" data-level="7.6.6" data-path="datahandling.html"><a href="datahandling.html#transposing-a-matrix-or-data-frame"><i class="fa fa-check"></i><b>7.6.6</b> Transposing a matrix or data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="datahandling.html"><a href="datahandling.html#reshape"><i class="fa fa-check"></i><b>7.7</b> Reshaping a data frame</a><ul>
<li class="chapter" data-level="7.7.1" data-path="datahandling.html"><a href="datahandling.html#long-form-and-wide-form-data"><i class="fa fa-check"></i><b>7.7.1</b> Long form and wide form data</a></li>
<li class="chapter" data-level="7.7.2" data-path="datahandling.html"><a href="datahandling.html#reshaping-data-using-widetolong"><i class="fa fa-check"></i><b>7.7.2</b> Reshaping data using <code>wideToLong()</code></a></li>
<li class="chapter" data-level="7.7.3" data-path="datahandling.html"><a href="datahandling.html#reshaping-data-using-longtowide"><i class="fa fa-check"></i><b>7.7.3</b> Reshaping data using <code>longToWide()</code></a></li>
<li class="chapter" data-level="7.7.4" data-path="datahandling.html"><a href="datahandling.html#reshaping-with-multiple-within-subject-factors"><i class="fa fa-check"></i><b>7.7.4</b> Reshaping with multiple within-subject factors</a></li>
<li class="chapter" data-level="7.7.5" data-path="datahandling.html"><a href="datahandling.html#what-other-options-are-there"><i class="fa fa-check"></i><b>7.7.5</b> What other options are there?</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="datahandling.html"><a href="datahandling.html#textprocessing"><i class="fa fa-check"></i><b>7.8</b> Working with text</a><ul>
<li class="chapter" data-level="7.8.1" data-path="datahandling.html"><a href="datahandling.html#shortening-a-string"><i class="fa fa-check"></i><b>7.8.1</b> Shortening a string</a></li>
<li class="chapter" data-level="7.8.2" data-path="datahandling.html"><a href="datahandling.html#pasting-strings-together"><i class="fa fa-check"></i><b>7.8.2</b> Pasting strings together</a></li>
<li class="chapter" data-level="7.8.3" data-path="datahandling.html"><a href="datahandling.html#splitting-strings"><i class="fa fa-check"></i><b>7.8.3</b> Splitting strings</a></li>
<li class="chapter" data-level="7.8.4" data-path="datahandling.html"><a href="datahandling.html#making-simple-conversions"><i class="fa fa-check"></i><b>7.8.4</b> Making simple conversions</a></li>
<li class="chapter" data-level="7.8.5" data-path="datahandling.html"><a href="datahandling.html#logictext2"><i class="fa fa-check"></i><b>7.8.5</b> Applying logical operations to text</a></li>
<li class="chapter" data-level="7.8.6" data-path="datahandling.html"><a href="datahandling.html#concatenating-and-printing-with-cat"><i class="fa fa-check"></i><b>7.8.6</b> Concatenating and printing with <code>cat()</code></a></li>
<li class="chapter" data-level="7.8.7" data-path="datahandling.html"><a href="datahandling.html#escapechars"><i class="fa fa-check"></i><b>7.8.7</b> Using escape characters in text</a></li>
<li class="chapter" data-level="7.8.8" data-path="datahandling.html"><a href="datahandling.html#matching-and-substituting-text"><i class="fa fa-check"></i><b>7.8.8</b> Matching and substituting text</a></li>
<li class="chapter" data-level="7.8.9" data-path="datahandling.html"><a href="datahandling.html#regex"><i class="fa fa-check"></i><b>7.8.9</b> Regular expressions (not really)</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="datahandling.html"><a href="datahandling.html#importing"><i class="fa fa-check"></i><b>7.9</b> Reading unusual data files</a><ul>
<li class="chapter" data-level="7.9.1" data-path="datahandling.html"><a href="datahandling.html#loading-data-from-text-files"><i class="fa fa-check"></i><b>7.9.1</b> Loading data from text files</a></li>
<li class="chapter" data-level="7.9.2" data-path="datahandling.html"><a href="datahandling.html#loading-data-from-spss-and-other-statistics-packages"><i class="fa fa-check"></i><b>7.9.2</b> Loading data from SPSS (and other statistics packages)</a></li>
<li class="chapter" data-level="7.9.3" data-path="datahandling.html"><a href="datahandling.html#loading-excel-files"><i class="fa fa-check"></i><b>7.9.3</b> Loading Excel files</a></li>
<li class="chapter" data-level="7.9.4" data-path="datahandling.html"><a href="datahandling.html#loading-matlab-octave-files"><i class="fa fa-check"></i><b>7.9.4</b> Loading Matlab (&amp; Octave) files</a></li>
<li class="chapter" data-level="7.9.5" data-path="datahandling.html"><a href="datahandling.html#saving-other-kinds-of-data"><i class="fa fa-check"></i><b>7.9.5</b> Saving other kinds of data</a></li>
<li class="chapter" data-level="7.9.6" data-path="datahandling.html"><a href="datahandling.html#are-we-done-yet"><i class="fa fa-check"></i><b>7.9.6</b> Are we done yet?</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="datahandling.html"><a href="datahandling.html#coercion"><i class="fa fa-check"></i><b>7.10</b> Coercing data from one class to another</a></li>
<li class="chapter" data-level="7.11" data-path="datahandling.html"><a href="datahandling.html#datastructures"><i class="fa fa-check"></i><b>7.11</b> Other useful data structures</a><ul>
<li class="chapter" data-level="7.11.1" data-path="datahandling.html"><a href="datahandling.html#matrix"><i class="fa fa-check"></i><b>7.11.1</b> Matrices</a></li>
<li class="chapter" data-level="7.11.2" data-path="datahandling.html"><a href="datahandling.html#orderedfactors"><i class="fa fa-check"></i><b>7.11.2</b> Ordered factors</a></li>
<li class="chapter" data-level="7.11.3" data-path="datahandling.html"><a href="datahandling.html#dates"><i class="fa fa-check"></i><b>7.11.3</b> Dates and times</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="datahandling.html"><a href="datahandling.html#miscdatahandling"><i class="fa fa-check"></i><b>7.12</b> Miscellaneous topics</a><ul>
<li class="chapter" data-level="7.12.1" data-path="datahandling.html"><a href="datahandling.html#the-problems-with-floating-point-arithmetic"><i class="fa fa-check"></i><b>7.12.1</b> The problems with floating point arithmetic</a></li>
<li class="chapter" data-level="7.12.2" data-path="datahandling.html"><a href="datahandling.html#recycling"><i class="fa fa-check"></i><b>7.12.2</b> The recycling rule</a></li>
<li class="chapter" data-level="7.12.3" data-path="datahandling.html"><a href="datahandling.html#environments"><i class="fa fa-check"></i><b>7.12.3</b> An introduction to environments</a></li>
<li class="chapter" data-level="7.12.4" data-path="datahandling.html"><a href="datahandling.html#attaching-a-data-frame"><i class="fa fa-check"></i><b>7.12.4</b> Attaching a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="datahandling.html"><a href="datahandling.html#summary-5"><i class="fa fa-check"></i><b>7.13</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="scripting.html"><a href="scripting.html"><i class="fa fa-check"></i><b>8</b> Basic programming</a><ul>
<li class="chapter" data-level="8.1" data-path="scripting.html"><a href="scripting.html#scripts"><i class="fa fa-check"></i><b>8.1</b> Scripts</a><ul>
<li class="chapter" data-level="8.1.1" data-path="scripting.html"><a href="scripting.html#why-use-scripts"><i class="fa fa-check"></i><b>8.1.1</b> Why use scripts?</a></li>
<li class="chapter" data-level="8.1.2" data-path="scripting.html"><a href="scripting.html#our-first-script"><i class="fa fa-check"></i><b>8.1.2</b> Our first script</a></li>
<li class="chapter" data-level="8.1.3" data-path="scripting.html"><a href="scripting.html#using-rstudio-to-write-scripts"><i class="fa fa-check"></i><b>8.1.3</b> Using Rstudio to write scripts</a></li>
<li class="chapter" data-level="8.1.4" data-path="scripting.html"><a href="scripting.html#commenting-your-script"><i class="fa fa-check"></i><b>8.1.4</b> Commenting your script</a></li>
<li class="chapter" data-level="8.1.5" data-path="scripting.html"><a href="scripting.html#differences-between-scripts-and-the-command-line"><i class="fa fa-check"></i><b>8.1.5</b> Differences between scripts and the command line</a></li>
<li class="chapter" data-level="8.1.6" data-path="scripting.html"><a href="scripting.html#done"><i class="fa fa-check"></i><b>8.1.6</b> Done!</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="scripting.html"><a href="scripting.html#loops"><i class="fa fa-check"></i><b>8.2</b> Loops</a><ul>
<li class="chapter" data-level="8.2.1" data-path="scripting.html"><a href="scripting.html#the-while-loop"><i class="fa fa-check"></i><b>8.2.1</b> The <code>while</code> loop</a></li>
<li class="chapter" data-level="8.2.2" data-path="scripting.html"><a href="scripting.html#for"><i class="fa fa-check"></i><b>8.2.2</b> The <code>for</code> loop</a></li>
<li class="chapter" data-level="8.2.3" data-path="scripting.html"><a href="scripting.html#a-more-realistic-example-of-a-loop"><i class="fa fa-check"></i><b>8.2.3</b> A more realistic example of a loop</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="scripting.html"><a href="scripting.html#if"><i class="fa fa-check"></i><b>8.3</b> Conditional statements</a></li>
<li class="chapter" data-level="8.4" data-path="scripting.html"><a href="scripting.html#functions"><i class="fa fa-check"></i><b>8.4</b> Writing functions</a><ul>
<li class="chapter" data-level="8.4.1" data-path="scripting.html"><a href="scripting.html#dotsargument"><i class="fa fa-check"></i><b>8.4.1</b> Function arguments revisited</a></li>
<li class="chapter" data-level="8.4.2" data-path="scripting.html"><a href="scripting.html#theres-more-to-functions-than-this"><i class="fa fa-check"></i><b>8.4.2</b> There’s more to functions than this</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="scripting.html"><a href="scripting.html#vectorised"><i class="fa fa-check"></i><b>8.5</b> Implicit loops</a></li>
<li class="chapter" data-level="8.6" data-path="scripting.html"><a href="scripting.html#summary-6"><i class="fa fa-check"></i><b>8.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-statistical-theory.html"><a href="part-iv-statistical-theory.html"><i class="fa fa-check"></i>Part IV. Statistical theory</a><ul>
<li class="chapter" data-level="" data-path="part-iv-statistical-theory.html"><a href="part-iv-statistical-theory.html#on-the-limits-of-logical-reasoning"><i class="fa fa-check"></i>On the limits of logical reasoning</a></li>
<li class="chapter" data-level="" data-path="part-iv-statistical-theory.html"><a href="part-iv-statistical-theory.html#learning-without-making-assumptions-is-a-myth"><i class="fa fa-check"></i>Learning without making assumptions is a myth</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>9</b> Introduction to probability</a><ul>
<li class="chapter" data-level="9.1" data-path="probability.html"><a href="probability.html#probstats"><i class="fa fa-check"></i><b>9.1</b> How are probability and statistics different?</a></li>
<li class="chapter" data-level="9.2" data-path="probability.html"><a href="probability.html#probmeaning"><i class="fa fa-check"></i><b>9.2</b> What does probability mean?</a><ul>
<li class="chapter" data-level="9.2.1" data-path="probability.html"><a href="probability.html#the-frequentist-view"><i class="fa fa-check"></i><b>9.2.1</b> The frequentist view</a></li>
<li class="chapter" data-level="9.2.2" data-path="probability.html"><a href="probability.html#the-bayesian-view"><i class="fa fa-check"></i><b>9.2.2</b> The Bayesian view</a></li>
<li class="chapter" data-level="9.2.3" data-path="probability.html"><a href="probability.html#whats-the-difference-and-who-is-right"><i class="fa fa-check"></i><b>9.2.3</b> What’s the difference? And who is right?</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="probability.html"><a href="probability.html#basicprobability"><i class="fa fa-check"></i><b>9.3</b> Basic probability theory</a><ul>
<li class="chapter" data-level="9.3.1" data-path="probability.html"><a href="probability.html#introducing-probability-distributions"><i class="fa fa-check"></i><b>9.3.1</b> Introducing probability distributions</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="probability.html"><a href="probability.html#binomial"><i class="fa fa-check"></i><b>9.4</b> The binomial distribution</a><ul>
<li class="chapter" data-level="9.4.1" data-path="probability.html"><a href="probability.html#introducing-the-binomial"><i class="fa fa-check"></i><b>9.4.1</b> Introducing the binomial</a></li>
<li class="chapter" data-level="9.4.2" data-path="probability.html"><a href="probability.html#working-with-the-binomial-distribution-in-r"><i class="fa fa-check"></i><b>9.4.2</b> Working with the binomial distribution in R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="probability.html"><a href="probability.html#normal"><i class="fa fa-check"></i><b>9.5</b> The normal distribution</a><ul>
<li class="chapter" data-level="9.5.1" data-path="probability.html"><a href="probability.html#density"><i class="fa fa-check"></i><b>9.5.1</b> Probability density</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="probability.html"><a href="probability.html#otherdists"><i class="fa fa-check"></i><b>9.6</b> Other useful distributions</a></li>
<li class="chapter" data-level="9.7" data-path="probability.html"><a href="probability.html#summary-7"><i class="fa fa-check"></i><b>9.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>10</b> Estimating unknown quantities from a sample</a><ul>
<li class="chapter" data-level="10.1" data-path="estimation.html"><a href="estimation.html#srs"><i class="fa fa-check"></i><b>10.1</b> Samples, populations and sampling</a><ul>
<li class="chapter" data-level="10.1.1" data-path="estimation.html"><a href="estimation.html#pop"><i class="fa fa-check"></i><b>10.1.1</b> Defining a population</a></li>
<li class="chapter" data-level="10.1.2" data-path="estimation.html"><a href="estimation.html#simple-random-samples"><i class="fa fa-check"></i><b>10.1.2</b> Simple random samples</a></li>
<li class="chapter" data-level="10.1.3" data-path="estimation.html"><a href="estimation.html#most-samples-are-not-simple-random-samples"><i class="fa fa-check"></i><b>10.1.3</b> Most samples are not simple random samples</a></li>
<li class="chapter" data-level="10.1.4" data-path="estimation.html"><a href="estimation.html#how-much-does-it-matter-if-you-dont-have-a-simple-random-sample"><i class="fa fa-check"></i><b>10.1.4</b> How much does it matter if you don’t have a simple random sample?</a></li>
<li class="chapter" data-level="10.1.5" data-path="estimation.html"><a href="estimation.html#population-parameters-and-sample-statistics"><i class="fa fa-check"></i><b>10.1.5</b> Population parameters and sample statistics</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="estimation.html"><a href="estimation.html#lawlargenumbers"><i class="fa fa-check"></i><b>10.2</b> The law of large numbers</a></li>
<li class="chapter" data-level="10.3" data-path="estimation.html"><a href="estimation.html#samplesandclt"><i class="fa fa-check"></i><b>10.3</b> Sampling distributions and the central limit theorem</a><ul>
<li class="chapter" data-level="10.3.1" data-path="estimation.html"><a href="estimation.html#samplingdists"><i class="fa fa-check"></i><b>10.3.1</b> Sampling distribution of the mean</a></li>
<li class="chapter" data-level="10.3.2" data-path="estimation.html"><a href="estimation.html#sampling-distributions-exist-for-any-sample-statistic"><i class="fa fa-check"></i><b>10.3.2</b> Sampling distributions exist for any sample statistic!</a></li>
<li class="chapter" data-level="10.3.3" data-path="estimation.html"><a href="estimation.html#clt"><i class="fa fa-check"></i><b>10.3.3</b> The central limit theorem</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="estimation.html"><a href="estimation.html#pointestimates"><i class="fa fa-check"></i><b>10.4</b> Estimating population parameters</a><ul>
<li class="chapter" data-level="10.4.1" data-path="estimation.html"><a href="estimation.html#estimating-the-population-mean"><i class="fa fa-check"></i><b>10.4.1</b> Estimating the population mean</a></li>
<li class="chapter" data-level="10.4.2" data-path="estimation.html"><a href="estimation.html#estimating-the-population-standard-deviation"><i class="fa fa-check"></i><b>10.4.2</b> Estimating the population standard deviation</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="estimation.html"><a href="estimation.html#ci"><i class="fa fa-check"></i><b>10.5</b> Estimating a confidence interval</a><ul>
<li class="chapter" data-level="10.5.1" data-path="estimation.html"><a href="estimation.html#a-slight-mistake-in-the-formula"><i class="fa fa-check"></i><b>10.5.1</b> A slight mistake in the formula</a></li>
<li class="chapter" data-level="10.5.2" data-path="estimation.html"><a href="estimation.html#interpreting-a-confidence-interval"><i class="fa fa-check"></i><b>10.5.2</b> Interpreting a confidence interval</a></li>
<li class="chapter" data-level="10.5.3" data-path="estimation.html"><a href="estimation.html#calculating-confidence-intervals-in-r"><i class="fa fa-check"></i><b>10.5.3</b> Calculating confidence intervals in R</a></li>
<li class="chapter" data-level="10.5.4" data-path="estimation.html"><a href="estimation.html#ciplots"><i class="fa fa-check"></i><b>10.5.4</b> Plotting confidence intervals in R</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="estimation.html"><a href="estimation.html#summary-8"><i class="fa fa-check"></i><b>10.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hypothesistesting.html"><a href="hypothesistesting.html"><i class="fa fa-check"></i><b>11</b> Hypothesis testing</a><ul>
<li class="chapter" data-level="11.1" data-path="hypothesistesting.html"><a href="hypothesistesting.html#hypotheses"><i class="fa fa-check"></i><b>11.1</b> A menagerie of hypotheses</a><ul>
<li class="chapter" data-level="11.1.1" data-path="hypothesistesting.html"><a href="hypothesistesting.html#research-hypotheses-versus-statistical-hypotheses"><i class="fa fa-check"></i><b>11.1.1</b> Research hypotheses versus statistical hypotheses</a></li>
<li class="chapter" data-level="11.1.2" data-path="hypothesistesting.html"><a href="hypothesistesting.html#null-hypotheses-and-alternative-hypotheses"><i class="fa fa-check"></i><b>11.1.2</b> Null hypotheses and alternative hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="hypothesistesting.html"><a href="hypothesistesting.html#errortypes"><i class="fa fa-check"></i><b>11.2</b> Two types of errors</a></li>
<li class="chapter" data-level="11.3" data-path="hypothesistesting.html"><a href="hypothesistesting.html#teststatistics"><i class="fa fa-check"></i><b>11.3</b> Test statistics and sampling distributions</a></li>
<li class="chapter" data-level="11.4" data-path="hypothesistesting.html"><a href="hypothesistesting.html#decisionmaking"><i class="fa fa-check"></i><b>11.4</b> Making decisions</a><ul>
<li class="chapter" data-level="11.4.1" data-path="hypothesistesting.html"><a href="hypothesistesting.html#critical-regions-and-critical-values"><i class="fa fa-check"></i><b>11.4.1</b> Critical regions and critical values</a></li>
<li class="chapter" data-level="11.4.2" data-path="hypothesistesting.html"><a href="hypothesistesting.html#a-note-on-statistical-significance"><i class="fa fa-check"></i><b>11.4.2</b> A note on statistical “significance”</a></li>
<li class="chapter" data-level="11.4.3" data-path="hypothesistesting.html"><a href="hypothesistesting.html#onesidedtests"><i class="fa fa-check"></i><b>11.4.3</b> The difference between one sided and two sided tests</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="hypothesistesting.html"><a href="hypothesistesting.html#pvalue"><i class="fa fa-check"></i><b>11.5</b> The <span class="math inline">\(p\)</span> value of a test</a><ul>
<li class="chapter" data-level="11.5.1" data-path="hypothesistesting.html"><a href="hypothesistesting.html#a-softer-view-of-decision-making"><i class="fa fa-check"></i><b>11.5.1</b> A softer view of decision making</a></li>
<li class="chapter" data-level="11.5.2" data-path="hypothesistesting.html"><a href="hypothesistesting.html#the-probability-of-extreme-data"><i class="fa fa-check"></i><b>11.5.2</b> The probability of extreme data</a></li>
<li class="chapter" data-level="11.5.3" data-path="hypothesistesting.html"><a href="hypothesistesting.html#a-common-mistake"><i class="fa fa-check"></i><b>11.5.3</b> A common mistake</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="hypothesistesting.html"><a href="hypothesistesting.html#writeup"><i class="fa fa-check"></i><b>11.6</b> Reporting the results of a hypothesis test</a><ul>
<li class="chapter" data-level="11.6.1" data-path="hypothesistesting.html"><a href="hypothesistesting.html#the-issue"><i class="fa fa-check"></i><b>11.6.1</b> The issue</a></li>
<li class="chapter" data-level="11.6.2" data-path="hypothesistesting.html"><a href="hypothesistesting.html#two-proposed-solutions"><i class="fa fa-check"></i><b>11.6.2</b> Two proposed solutions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="hypothesistesting.html"><a href="hypothesistesting.html#running-the-hypothesis-test-in-practice"><i class="fa fa-check"></i><b>11.7</b> Running the hypothesis test in practice</a></li>
<li class="chapter" data-level="11.8" data-path="hypothesistesting.html"><a href="hypothesistesting.html#effectsize"><i class="fa fa-check"></i><b>11.8</b> Effect size, sample size and power</a><ul>
<li class="chapter" data-level="11.8.1" data-path="hypothesistesting.html"><a href="hypothesistesting.html#the-power-function"><i class="fa fa-check"></i><b>11.8.1</b> The power function</a></li>
<li class="chapter" data-level="11.8.2" data-path="hypothesistesting.html"><a href="hypothesistesting.html#effect-size"><i class="fa fa-check"></i><b>11.8.2</b> Effect size</a></li>
<li class="chapter" data-level="11.8.3" data-path="hypothesistesting.html"><a href="hypothesistesting.html#increasing-the-power-of-your-study"><i class="fa fa-check"></i><b>11.8.3</b> Increasing the power of your study</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="hypothesistesting.html"><a href="hypothesistesting.html#nhstmess"><i class="fa fa-check"></i><b>11.9</b> Some issues to consider</a><ul>
<li class="chapter" data-level="11.9.1" data-path="hypothesistesting.html"><a href="hypothesistesting.html#neyman-versus-fisher"><i class="fa fa-check"></i><b>11.9.1</b> Neyman versus Fisher</a></li>
<li class="chapter" data-level="11.9.2" data-path="hypothesistesting.html"><a href="hypothesistesting.html#bayesians-versus-frequentists"><i class="fa fa-check"></i><b>11.9.2</b> Bayesians versus frequentists</a></li>
<li class="chapter" data-level="11.9.3" data-path="hypothesistesting.html"><a href="hypothesistesting.html#traps"><i class="fa fa-check"></i><b>11.9.3</b> Traps</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="hypothesistesting.html"><a href="hypothesistesting.html#summary-9"><i class="fa fa-check"></i><b>11.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-statistical-tools.html"><a href="part-v-statistical-tools.html"><i class="fa fa-check"></i>Part V. Statistical tools</a></li>
<li class="chapter" data-level="12" data-path="chisquare.html"><a href="chisquare.html"><i class="fa fa-check"></i><b>12</b> Categorical data analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="chisquare.html"><a href="chisquare.html#goftest"><i class="fa fa-check"></i><b>12.1</b> The <span class="math inline">\(\chi^2\)</span> goodness-of-fit test</a><ul>
<li class="chapter" data-level="12.1.1" data-path="chisquare.html"><a href="chisquare.html#the-cards-data"><i class="fa fa-check"></i><b>12.1.1</b> The cards data</a></li>
<li class="chapter" data-level="12.1.2" data-path="chisquare.html"><a href="chisquare.html#the-null-hypothesis-and-the-alternative-hypothesis"><i class="fa fa-check"></i><b>12.1.2</b> The null hypothesis and the alternative hypothesis</a></li>
<li class="chapter" data-level="12.1.3" data-path="chisquare.html"><a href="chisquare.html#the-goodness-of-fit-test-statistic"><i class="fa fa-check"></i><b>12.1.3</b> The “goodness of fit” test statistic</a></li>
<li class="chapter" data-level="12.1.4" data-path="chisquare.html"><a href="chisquare.html#the-sampling-distribution-of-the-gof-statistic-advanced"><i class="fa fa-check"></i><b>12.1.4</b> The sampling distribution of the GOF statistic (advanced)</a></li>
<li class="chapter" data-level="12.1.5" data-path="chisquare.html"><a href="chisquare.html#degrees-of-freedom"><i class="fa fa-check"></i><b>12.1.5</b> Degrees of freedom</a></li>
<li class="chapter" data-level="12.1.6" data-path="chisquare.html"><a href="chisquare.html#testing-the-null-hypothesis"><i class="fa fa-check"></i><b>12.1.6</b> Testing the null hypothesis</a></li>
<li class="chapter" data-level="12.1.7" data-path="chisquare.html"><a href="chisquare.html#gofTestInR"><i class="fa fa-check"></i><b>12.1.7</b> Doing the test in R</a></li>
<li class="chapter" data-level="12.1.8" data-path="chisquare.html"><a href="chisquare.html#specifying-a-different-null-hypothesis"><i class="fa fa-check"></i><b>12.1.8</b> Specifying a different null hypothesis</a></li>
<li class="chapter" data-level="12.1.9" data-path="chisquare.html"><a href="chisquare.html#chisqreport"><i class="fa fa-check"></i><b>12.1.9</b> How to report the results of the test</a></li>
<li class="chapter" data-level="12.1.10" data-path="chisquare.html"><a href="chisquare.html#a-comment-on-statistical-notation-advanced"><i class="fa fa-check"></i><b>12.1.10</b> A comment on statistical notation (advanced)</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="chisquare.html"><a href="chisquare.html#chisqindependence"><i class="fa fa-check"></i><b>12.2</b> The <span class="math inline">\(\chi^2\)</span> test of independence (or association)</a><ul>
<li class="chapter" data-level="12.2.1" data-path="chisquare.html"><a href="chisquare.html#constructing-our-hypothesis-test"><i class="fa fa-check"></i><b>12.2.1</b> Constructing our hypothesis test</a></li>
<li class="chapter" data-level="12.2.2" data-path="chisquare.html"><a href="chisquare.html#AssocTestInR"><i class="fa fa-check"></i><b>12.2.2</b> Doing the test in R</a></li>
<li class="chapter" data-level="12.2.3" data-path="chisquare.html"><a href="chisquare.html#postscript"><i class="fa fa-check"></i><b>12.2.3</b> Postscript</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="chisquare.html"><a href="chisquare.html#yates"><i class="fa fa-check"></i><b>12.3</b> The continuity correction</a></li>
<li class="chapter" data-level="12.4" data-path="chisquare.html"><a href="chisquare.html#chisqeffectsize"><i class="fa fa-check"></i><b>12.4</b> Effect size</a></li>
<li class="chapter" data-level="12.5" data-path="chisquare.html"><a href="chisquare.html#chisqassumptions"><i class="fa fa-check"></i><b>12.5</b> Assumptions of the test(s)</a></li>
<li class="chapter" data-level="12.6" data-path="chisquare.html"><a href="chisquare.html#chisq.test"><i class="fa fa-check"></i><b>12.6</b> The most typical way to do chi-square tests in R</a></li>
<li class="chapter" data-level="12.7" data-path="chisquare.html"><a href="chisquare.html#fisherexacttest"><i class="fa fa-check"></i><b>12.7</b> The Fisher exact test</a></li>
<li class="chapter" data-level="12.8" data-path="chisquare.html"><a href="chisquare.html#mcnemar"><i class="fa fa-check"></i><b>12.8</b> The McNemar test</a><ul>
<li class="chapter" data-level="12.8.1" data-path="chisquare.html"><a href="chisquare.html#doing-the-mcnemar-test-in-r"><i class="fa fa-check"></i><b>12.8.1</b> Doing the McNemar test in R</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="chisquare.html"><a href="chisquare.html#whats-the-difference-between-mcnemar-and-independence"><i class="fa fa-check"></i><b>12.9</b> What’s the difference between McNemar and independence?</a></li>
<li class="chapter" data-level="12.10" data-path="chisquare.html"><a href="chisquare.html#summary-10"><i class="fa fa-check"></i><b>12.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>13</b> Comparing two means</a><ul>
<li class="chapter" data-level="13.1" data-path="ttest.html"><a href="ttest.html#the-one-sample-z-test"><i class="fa fa-check"></i><b>13.1</b> The one-sample <span class="math inline">\(z\)</span>-test</a><ul>
<li class="chapter" data-level="13.1.1" data-path="ttest.html"><a href="ttest.html#the-inference-problem-that-the-test-addresses"><i class="fa fa-check"></i><b>13.1.1</b> The inference problem that the test addresses</a></li>
<li class="chapter" data-level="13.1.2" data-path="ttest.html"><a href="ttest.html#constructing-the-hypothesis-test"><i class="fa fa-check"></i><b>13.1.2</b> Constructing the hypothesis test</a></li>
<li class="chapter" data-level="13.1.3" data-path="ttest.html"><a href="ttest.html#a-worked-example-using-r"><i class="fa fa-check"></i><b>13.1.3</b> A worked example using R</a></li>
<li class="chapter" data-level="13.1.4" data-path="ttest.html"><a href="ttest.html#zassumptions"><i class="fa fa-check"></i><b>13.1.4</b> Assumptions of the <span class="math inline">\(z\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ttest.html"><a href="ttest.html#onesamplettest"><i class="fa fa-check"></i><b>13.2</b> The one-sample <span class="math inline">\(t\)</span>-test</a><ul>
<li class="chapter" data-level="13.2.1" data-path="ttest.html"><a href="ttest.html#introducing-the-t-test"><i class="fa fa-check"></i><b>13.2.1</b> Introducing the <span class="math inline">\(t\)</span>-test</a></li>
<li class="chapter" data-level="13.2.2" data-path="ttest.html"><a href="ttest.html#doing-the-test-in-r"><i class="fa fa-check"></i><b>13.2.2</b> Doing the test in R</a></li>
<li class="chapter" data-level="13.2.3" data-path="ttest.html"><a href="ttest.html#ttestoneassumptions"><i class="fa fa-check"></i><b>13.2.3</b> Assumptions of the one sample <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ttest.html"><a href="ttest.html#studentttest"><i class="fa fa-check"></i><b>13.3</b> The independent samples <span class="math inline">\(t\)</span>-test (Student test)</a><ul>
<li class="chapter" data-level="13.3.1" data-path="ttest.html"><a href="ttest.html#the-data-1"><i class="fa fa-check"></i><b>13.3.1</b> The data</a></li>
<li class="chapter" data-level="13.3.2" data-path="ttest.html"><a href="ttest.html#introducing-the-test"><i class="fa fa-check"></i><b>13.3.2</b> Introducing the test</a></li>
<li class="chapter" data-level="13.3.3" data-path="ttest.html"><a href="ttest.html#a-pooled-estimate-of-the-standard-deviation"><i class="fa fa-check"></i><b>13.3.3</b> A “pooled estimate” of the standard deviation</a></li>
<li class="chapter" data-level="13.3.4" data-path="ttest.html"><a href="ttest.html#the-same-pooled-estimate-described-differently"><i class="fa fa-check"></i><b>13.3.4</b> The same pooled estimate, described differently</a></li>
<li class="chapter" data-level="13.3.5" data-path="ttest.html"><a href="ttest.html#completing-the-test"><i class="fa fa-check"></i><b>13.3.5</b> Completing the test</a></li>
<li class="chapter" data-level="13.3.6" data-path="ttest.html"><a href="ttest.html#doing-the-test-in-r-1"><i class="fa fa-check"></i><b>13.3.6</b> Doing the test in R</a></li>
<li class="chapter" data-level="13.3.7" data-path="ttest.html"><a href="ttest.html#positive-and-negative-t-values"><i class="fa fa-check"></i><b>13.3.7</b> Positive and negative <span class="math inline">\(t\)</span> values</a></li>
<li class="chapter" data-level="13.3.8" data-path="ttest.html"><a href="ttest.html#studentassumptions"><i class="fa fa-check"></i><b>13.3.8</b> Assumptions of the test</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ttest.html"><a href="ttest.html#welchttest"><i class="fa fa-check"></i><b>13.4</b> The independent samples <span class="math inline">\(t\)</span>-test (Welch test)</a><ul>
<li class="chapter" data-level="13.4.1" data-path="ttest.html"><a href="ttest.html#doing-the-test-in-r-2"><i class="fa fa-check"></i><b>13.4.1</b> Doing the test in R</a></li>
<li class="chapter" data-level="13.4.2" data-path="ttest.html"><a href="ttest.html#assumptions-of-the-test"><i class="fa fa-check"></i><b>13.4.2</b> Assumptions of the test</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ttest.html"><a href="ttest.html#pairedsamplesttest"><i class="fa fa-check"></i><b>13.5</b> The paired-samples <span class="math inline">\(t\)</span>-test</a><ul>
<li class="chapter" data-level="13.5.1" data-path="ttest.html"><a href="ttest.html#the-data-2"><i class="fa fa-check"></i><b>13.5.1</b> The data</a></li>
<li class="chapter" data-level="13.5.2" data-path="ttest.html"><a href="ttest.html#what-is-the-paired-samples-t-test"><i class="fa fa-check"></i><b>13.5.2</b> What is the paired samples <span class="math inline">\(t\)</span>-test?</a></li>
<li class="chapter" data-level="13.5.3" data-path="ttest.html"><a href="ttest.html#doing-the-test-in-r-part-1"><i class="fa fa-check"></i><b>13.5.3</b> Doing the test in R, part 1</a></li>
<li class="chapter" data-level="13.5.4" data-path="ttest.html"><a href="ttest.html#doing-the-test-in-r-part-2"><i class="fa fa-check"></i><b>13.5.4</b> Doing the test in R, part 2</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="ttest.html"><a href="ttest.html#one-sided-tests"><i class="fa fa-check"></i><b>13.6</b> One sided tests</a></li>
<li class="chapter" data-level="13.7" data-path="ttest.html"><a href="ttest.html#ttestfunction"><i class="fa fa-check"></i><b>13.7</b> Using the t.test() function</a></li>
<li class="chapter" data-level="13.8" data-path="ttest.html"><a href="ttest.html#cohensd"><i class="fa fa-check"></i><b>13.8</b> Effect size</a><ul>
<li class="chapter" data-level="13.8.1" data-path="ttest.html"><a href="ttest.html#cohens-d-from-one-sample"><i class="fa fa-check"></i><b>13.8.1</b> Cohen’s <span class="math inline">\(d\)</span> from one sample</a></li>
<li class="chapter" data-level="13.8.2" data-path="ttest.html"><a href="ttest.html#cohens-d-from-a-student-t-test"><i class="fa fa-check"></i><b>13.8.2</b> Cohen’s <span class="math inline">\(d\)</span> from a Student <span class="math inline">\(t\)</span> test</a></li>
<li class="chapter" data-level="13.8.3" data-path="ttest.html"><a href="ttest.html#cohens-d-from-a-welch-test"><i class="fa fa-check"></i><b>13.8.3</b> Cohen’s <span class="math inline">\(d\)</span> from a Welch test</a></li>
<li class="chapter" data-level="13.8.4" data-path="ttest.html"><a href="ttest.html#cohens-d-from-a-paired-samples-test"><i class="fa fa-check"></i><b>13.8.4</b> Cohen’s <span class="math inline">\(d\)</span> from a paired-samples test</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="ttest.html"><a href="ttest.html#shapiro"><i class="fa fa-check"></i><b>13.9</b> Checking the normality of a sample</a><ul>
<li class="chapter" data-level="13.9.1" data-path="ttest.html"><a href="ttest.html#qq-plots"><i class="fa fa-check"></i><b>13.9.1</b> QQ plots</a></li>
<li class="chapter" data-level="13.9.2" data-path="ttest.html"><a href="ttest.html#shapiro-wilk-tests"><i class="fa fa-check"></i><b>13.9.2</b> Shapiro-Wilk tests</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="ttest.html"><a href="ttest.html#wilcox"><i class="fa fa-check"></i><b>13.10</b> Testing non-normal data with Wilcoxon tests</a><ul>
<li class="chapter" data-level="13.10.1" data-path="ttest.html"><a href="ttest.html#two-sample-wilcoxon-test"><i class="fa fa-check"></i><b>13.10.1</b> Two sample Wilcoxon test</a></li>
<li class="chapter" data-level="13.10.2" data-path="ttest.html"><a href="ttest.html#one-sample-wilcoxon-test"><i class="fa fa-check"></i><b>13.10.2</b> One sample Wilcoxon test</a></li>
</ul></li>
<li class="chapter" data-level="13.11" data-path="ttest.html"><a href="ttest.html#summary-11"><i class="fa fa-check"></i><b>13.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>14</b> Comparing several means (one-way ANOVA)</a><ul>
<li class="chapter" data-level="14.1" data-path="anova.html"><a href="anova.html#anxifree"><i class="fa fa-check"></i><b>14.1</b> An illustrative data set</a></li>
<li class="chapter" data-level="14.2" data-path="anova.html"><a href="anova.html#anovaintro"><i class="fa fa-check"></i><b>14.2</b> How ANOVA works</a><ul>
<li class="chapter" data-level="14.2.1" data-path="anova.html"><a href="anova.html#two-formulas-for-the-variance-of-y"><i class="fa fa-check"></i><b>14.2.1</b> Two formulas for the variance of <span class="math inline">\(Y\)</span></a></li>
<li class="chapter" data-level="14.2.2" data-path="anova.html"><a href="anova.html#from-variances-to-sums-of-squares"><i class="fa fa-check"></i><b>14.2.2</b> From variances to sums of squares</a></li>
<li class="chapter" data-level="14.2.3" data-path="anova.html"><a href="anova.html#from-sums-of-squares-to-the-f-test"><i class="fa fa-check"></i><b>14.2.3</b> From sums of squares to the <span class="math inline">\(F\)</span>-test</a></li>
<li class="chapter" data-level="14.2.4" data-path="anova.html"><a href="anova.html#anovamodel"><i class="fa fa-check"></i><b>14.2.4</b> The model for the data and the meaning of <span class="math inline">\(F\)</span> (advanced)</a></li>
<li class="chapter" data-level="14.2.5" data-path="anova.html"><a href="anova.html#anovacalc"><i class="fa fa-check"></i><b>14.2.5</b> A worked example</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="anova.html"><a href="anova.html#introduceaov"><i class="fa fa-check"></i><b>14.3</b> Running an ANOVA in R</a><ul>
<li class="chapter" data-level="14.3.1" data-path="anova.html"><a href="anova.html#using-the-aov-function-to-specify-your-anova"><i class="fa fa-check"></i><b>14.3.1</b> Using the <code>aov()</code> function to specify your ANOVA</a></li>
<li class="chapter" data-level="14.3.2" data-path="anova.html"><a href="anova.html#aovobjects"><i class="fa fa-check"></i><b>14.3.2</b> Understanding what the <code>aov()</code> function produces</a></li>
<li class="chapter" data-level="14.3.3" data-path="anova.html"><a href="anova.html#running-the-hypothesis-tests-for-the-anova"><i class="fa fa-check"></i><b>14.3.3</b> Running the hypothesis tests for the ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="anova.html"><a href="anova.html#etasquared"><i class="fa fa-check"></i><b>14.4</b> Effect size</a></li>
<li class="chapter" data-level="14.5" data-path="anova.html"><a href="anova.html#posthoc"><i class="fa fa-check"></i><b>14.5</b> Multiple comparisons and post hoc tests</a><ul>
<li class="chapter" data-level="14.5.1" data-path="anova.html"><a href="anova.html#running-pairwise-t-tests"><i class="fa fa-check"></i><b>14.5.1</b> Running “pairwise” <span class="math inline">\(t\)</span>-tests</a></li>
<li class="chapter" data-level="14.5.2" data-path="anova.html"><a href="anova.html#corrections-for-multiple-testing"><i class="fa fa-check"></i><b>14.5.2</b> Corrections for multiple testing</a></li>
<li class="chapter" data-level="14.5.3" data-path="anova.html"><a href="anova.html#bonferroni-corrections"><i class="fa fa-check"></i><b>14.5.3</b> Bonferroni corrections</a></li>
<li class="chapter" data-level="14.5.4" data-path="anova.html"><a href="anova.html#holm-corrections"><i class="fa fa-check"></i><b>14.5.4</b> Holm corrections</a></li>
<li class="chapter" data-level="14.5.5" data-path="anova.html"><a href="anova.html#writing-up-the-post-hoc-test"><i class="fa fa-check"></i><b>14.5.5</b> Writing up the post hoc test</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="anova.html"><a href="anova.html#anovaassumptions"><i class="fa fa-check"></i><b>14.6</b> Assumptions of one-way ANOVA</a><ul>
<li class="chapter" data-level="14.6.1" data-path="anova.html"><a href="anova.html#how-robust-is-anova"><i class="fa fa-check"></i><b>14.6.1</b> How robust is ANOVA?</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="anova.html"><a href="anova.html#levene"><i class="fa fa-check"></i><b>14.7</b> Checking the homogeneity of variance assumption</a><ul>
<li class="chapter" data-level="14.7.1" data-path="anova.html"><a href="anova.html#running-the-levenes-test-in-r"><i class="fa fa-check"></i><b>14.7.1</b> Running the Levene’s test in R</a></li>
<li class="chapter" data-level="14.7.2" data-path="anova.html"><a href="anova.html#additional-comments"><i class="fa fa-check"></i><b>14.7.2</b> Additional comments</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="anova.html"><a href="anova.html#welchoneway"><i class="fa fa-check"></i><b>14.8</b> Removing the homogeneity of variance assumption</a></li>
<li class="chapter" data-level="14.9" data-path="anova.html"><a href="anova.html#anovanormality"><i class="fa fa-check"></i><b>14.9</b> Checking the normality assumption</a></li>
<li class="chapter" data-level="14.10" data-path="anova.html"><a href="anova.html#kruskalwallis"><i class="fa fa-check"></i><b>14.10</b> Removing the normality assumption</a><ul>
<li class="chapter" data-level="14.10.1" data-path="anova.html"><a href="anova.html#the-logic-behind-the-kruskal-wallis-test"><i class="fa fa-check"></i><b>14.10.1</b> The logic behind the Kruskal-Wallis test</a></li>
<li class="chapter" data-level="14.10.2" data-path="anova.html"><a href="anova.html#additional-details"><i class="fa fa-check"></i><b>14.10.2</b> Additional details</a></li>
<li class="chapter" data-level="14.10.3" data-path="anova.html"><a href="anova.html#how-to-run-the-kruskal-wallis-test-in-r"><i class="fa fa-check"></i><b>14.10.3</b> How to run the Kruskal-Wallis test in R</a></li>
</ul></li>
<li class="chapter" data-level="14.11" data-path="anova.html"><a href="anova.html#anovaandt"><i class="fa fa-check"></i><b>14.11</b> On the relationship between ANOVA and the Student <span class="math inline">\(t\)</span> test</a></li>
<li class="chapter" data-level="14.12" data-path="anova.html"><a href="anova.html#summary-12"><i class="fa fa-check"></i><b>14.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>15</b> Linear regression</a><ul>
<li class="chapter" data-level="15.1" data-path="regression.html"><a href="regression.html#introregression"><i class="fa fa-check"></i><b>15.1</b> What is a linear regression model?</a></li>
<li class="chapter" data-level="15.2" data-path="regression.html"><a href="regression.html#regressionestimation"><i class="fa fa-check"></i><b>15.2</b> Estimating a linear regression model</a><ul>
<li class="chapter" data-level="15.2.1" data-path="regression.html"><a href="regression.html#lm"><i class="fa fa-check"></i><b>15.2.1</b> Using the <code>lm()</code> function</a></li>
<li class="chapter" data-level="15.2.2" data-path="regression.html"><a href="regression.html#interpreting-the-estimated-model"><i class="fa fa-check"></i><b>15.2.2</b> Interpreting the estimated model</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="regression.html"><a href="regression.html#multipleregression"><i class="fa fa-check"></i><b>15.3</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="15.3.1" data-path="regression.html"><a href="regression.html#doing-it-in-r"><i class="fa fa-check"></i><b>15.3.1</b> Doing it in R</a></li>
<li class="chapter" data-level="15.3.2" data-path="regression.html"><a href="regression.html#formula-for-the-general-case"><i class="fa fa-check"></i><b>15.3.2</b> Formula for the general case</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="regression.html"><a href="regression.html#r2"><i class="fa fa-check"></i><b>15.4</b> Quantifying the fit of the regression model</a><ul>
<li class="chapter" data-level="15.4.1" data-path="regression.html"><a href="regression.html#the-r2-value"><i class="fa fa-check"></i><b>15.4.1</b> The <span class="math inline">\(R^2\)</span> value</a></li>
<li class="chapter" data-level="15.4.2" data-path="regression.html"><a href="regression.html#the-relationship-between-regression-and-correlation"><i class="fa fa-check"></i><b>15.4.2</b> The relationship between regression and correlation</a></li>
<li class="chapter" data-level="15.4.3" data-path="regression.html"><a href="regression.html#the-adjusted-r2-value"><i class="fa fa-check"></i><b>15.4.3</b> The adjusted <span class="math inline">\(R^2\)</span> value</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="regression.html"><a href="regression.html#regressiontests"><i class="fa fa-check"></i><b>15.5</b> Hypothesis tests for regression models</a><ul>
<li class="chapter" data-level="15.5.1" data-path="regression.html"><a href="regression.html#testing-the-model-as-a-whole"><i class="fa fa-check"></i><b>15.5.1</b> Testing the model as a whole</a></li>
<li class="chapter" data-level="15.5.2" data-path="regression.html"><a href="regression.html#tests-for-individual-coefficients"><i class="fa fa-check"></i><b>15.5.2</b> Tests for individual coefficients</a></li>
<li class="chapter" data-level="15.5.3" data-path="regression.html"><a href="regression.html#regressionsummary"><i class="fa fa-check"></i><b>15.5.3</b> Running the hypothesis tests in R</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="regression.html"><a href="regression.html#corrhyp"><i class="fa fa-check"></i><b>15.6</b> Testing the significance of a correlation</a><ul>
<li class="chapter" data-level="15.6.1" data-path="regression.html"><a href="regression.html#hypothesis-tests-for-a-single-correlation"><i class="fa fa-check"></i><b>15.6.1</b> Hypothesis tests for a single correlation</a></li>
<li class="chapter" data-level="15.6.2" data-path="regression.html"><a href="regression.html#corrhyp2"><i class="fa fa-check"></i><b>15.6.2</b> Hypothesis tests for all pairwise correlations</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="regression.html"><a href="regression.html#regressioncoefs"><i class="fa fa-check"></i><b>15.7</b> Regarding regression coefficients</a><ul>
<li class="chapter" data-level="15.7.1" data-path="regression.html"><a href="regression.html#confidence-intervals-for-the-coefficients"><i class="fa fa-check"></i><b>15.7.1</b> Confidence intervals for the coefficients</a></li>
<li class="chapter" data-level="15.7.2" data-path="regression.html"><a href="regression.html#calculating-standardised-regression-coefficients"><i class="fa fa-check"></i><b>15.7.2</b> Calculating standardised regression coefficients</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="regression.html"><a href="regression.html#regressionassumptions"><i class="fa fa-check"></i><b>15.8</b> Assumptions of regression</a></li>
<li class="chapter" data-level="15.9" data-path="regression.html"><a href="regression.html#regressiondiagnostics"><i class="fa fa-check"></i><b>15.9</b> Model checking</a><ul>
<li class="chapter" data-level="15.9.1" data-path="regression.html"><a href="regression.html#three-kinds-of-residuals"><i class="fa fa-check"></i><b>15.9.1</b> Three kinds of residuals</a></li>
<li class="chapter" data-level="15.9.2" data-path="regression.html"><a href="regression.html#regressionoutliers"><i class="fa fa-check"></i><b>15.9.2</b> Three kinds of anomalous data</a></li>
<li class="chapter" data-level="15.9.3" data-path="regression.html"><a href="regression.html#regressionnormality"><i class="fa fa-check"></i><b>15.9.3</b> Checking the normality of the residuals</a></li>
<li class="chapter" data-level="15.9.4" data-path="regression.html"><a href="regression.html#regressionlinearity"><i class="fa fa-check"></i><b>15.9.4</b> Checking the linearity of the relationship</a></li>
<li class="chapter" data-level="15.9.5" data-path="regression.html"><a href="regression.html#regressionhomogeneity"><i class="fa fa-check"></i><b>15.9.5</b> Checking the homogeneity of variance</a></li>
<li class="chapter" data-level="15.9.6" data-path="regression.html"><a href="regression.html#regressioncollinearity"><i class="fa fa-check"></i><b>15.9.6</b> Checking for collinearity</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="regression.html"><a href="regression.html#modelselreg"><i class="fa fa-check"></i><b>15.10</b> Model selection</a><ul>
<li class="chapter" data-level="15.10.1" data-path="regression.html"><a href="regression.html#backward-elimination"><i class="fa fa-check"></i><b>15.10.1</b> Backward elimination</a></li>
<li class="chapter" data-level="15.10.2" data-path="regression.html"><a href="regression.html#forward-selection"><i class="fa fa-check"></i><b>15.10.2</b> Forward selection</a></li>
<li class="chapter" data-level="15.10.3" data-path="regression.html"><a href="regression.html#a-caveat"><i class="fa fa-check"></i><b>15.10.3</b> A caveat</a></li>
<li class="chapter" data-level="15.10.4" data-path="regression.html"><a href="regression.html#comparing-two-regression-models"><i class="fa fa-check"></i><b>15.10.4</b> Comparing two regression models</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="regression.html"><a href="regression.html#summary-13"><i class="fa fa-check"></i><b>15.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="anova2.html"><a href="anova2.html"><i class="fa fa-check"></i><b>16</b> Factorial ANOVA</a><ul>
<li class="chapter" data-level="16.1" data-path="anova2.html"><a href="anova2.html#factorialanovasimple"><i class="fa fa-check"></i><b>16.1</b> Factorial ANOVA 1: balanced designs, no interactions</a><ul>
<li class="chapter" data-level="16.1.1" data-path="anova2.html"><a href="anova2.html#factanovahyp"><i class="fa fa-check"></i><b>16.1.1</b> What hypotheses are we testing?</a></li>
<li class="chapter" data-level="16.1.2" data-path="anova2.html"><a href="anova2.html#running-the-analysis-in-r"><i class="fa fa-check"></i><b>16.1.2</b> Running the analysis in R</a></li>
<li class="chapter" data-level="16.1.3" data-path="anova2.html"><a href="anova2.html#how-are-the-sum-of-squares-calculated"><i class="fa fa-check"></i><b>16.1.3</b> How are the sum of squares calculated?</a></li>
<li class="chapter" data-level="16.1.4" data-path="anova2.html"><a href="anova2.html#what-are-our-degrees-of-freedom"><i class="fa fa-check"></i><b>16.1.4</b> What are our degrees of freedom?</a></li>
<li class="chapter" data-level="16.1.5" data-path="anova2.html"><a href="anova2.html#factorial-anova-versus-one-way-anovas"><i class="fa fa-check"></i><b>16.1.5</b> Factorial ANOVA versus one-way ANOVAs</a></li>
<li class="chapter" data-level="16.1.6" data-path="anova2.html"><a href="anova2.html#what-kinds-of-outcomes-does-this-analysis-capture"><i class="fa fa-check"></i><b>16.1.6</b> What kinds of outcomes does this analysis capture?</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="anova2.html"><a href="anova2.html#interactions"><i class="fa fa-check"></i><b>16.2</b> Factorial ANOVA 2: balanced designs, interactions allowed</a><ul>
<li class="chapter" data-level="16.2.1" data-path="anova2.html"><a href="anova2.html#what-exactly-is-an-interaction-effect"><i class="fa fa-check"></i><b>16.2.1</b> What exactly <em>is an interaction effect?</em></a></li>
<li class="chapter" data-level="16.2.2" data-path="anova2.html"><a href="anova2.html#calculating-sums-of-squares-for-the-interaction"><i class="fa fa-check"></i><b>16.2.2</b> Calculating sums of squares for the interaction</a></li>
<li class="chapter" data-level="16.2.3" data-path="anova2.html"><a href="anova2.html#degrees-of-freedom-for-the-interaction"><i class="fa fa-check"></i><b>16.2.3</b> Degrees of freedom for the interaction</a></li>
<li class="chapter" data-level="16.2.4" data-path="anova2.html"><a href="anova2.html#running-the-anova-in-r"><i class="fa fa-check"></i><b>16.2.4</b> Running the ANOVA in R</a></li>
<li class="chapter" data-level="16.2.5" data-path="anova2.html"><a href="anova2.html#interpreting-the-results"><i class="fa fa-check"></i><b>16.2.5</b> Interpreting the results</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="anova2.html"><a href="anova2.html#effectsizefactorialanova"><i class="fa fa-check"></i><b>16.3</b> Effect size, estimated means, and confidence intervals</a><ul>
<li class="chapter" data-level="16.3.1" data-path="anova2.html"><a href="anova2.html#effect-sizes"><i class="fa fa-check"></i><b>16.3.1</b> Effect sizes</a></li>
<li class="chapter" data-level="16.3.2" data-path="anova2.html"><a href="anova2.html#estimated-group-means"><i class="fa fa-check"></i><b>16.3.2</b> Estimated group means</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="anova2.html"><a href="anova2.html#factorialanovaassumptions"><i class="fa fa-check"></i><b>16.4</b> Assumption checking</a><ul>
<li class="chapter" data-level="16.4.1" data-path="anova2.html"><a href="anova2.html#levene-test-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>16.4.1</b> Levene test for homogeneity of variance</a></li>
<li class="chapter" data-level="16.4.2" data-path="anova2.html"><a href="anova2.html#normality-of-residuals"><i class="fa fa-check"></i><b>16.4.2</b> Normality of residuals</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="anova2.html"><a href="anova2.html#omnibusF"><i class="fa fa-check"></i><b>16.5</b> The <span class="math inline">\(F\)</span> test as a model comparison</a><ul>
<li class="chapter" data-level="16.5.1" data-path="anova2.html"><a href="anova2.html#the-f-test-comparing-two-models"><i class="fa fa-check"></i><b>16.5.1</b> The <span class="math inline">\(F\)</span> test comparing two models</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="anova2.html"><a href="anova2.html#anovalm"><i class="fa fa-check"></i><b>16.6</b> ANOVA as a linear model</a><ul>
<li class="chapter" data-level="16.6.1" data-path="anova2.html"><a href="anova2.html#some-data"><i class="fa fa-check"></i><b>16.6.1</b> Some data</a></li>
<li class="chapter" data-level="16.6.2" data-path="anova2.html"><a href="anova2.html#anova-with-binary-factors-as-a-regression-model"><i class="fa fa-check"></i><b>16.6.2</b> ANOVA with binary factors as a regression model</a></li>
<li class="chapter" data-level="16.6.3" data-path="anova2.html"><a href="anova2.html#changingbaseline"><i class="fa fa-check"></i><b>16.6.3</b> Changing the baseline category</a></li>
<li class="chapter" data-level="16.6.4" data-path="anova2.html"><a href="anova2.html#how-to-encode-non-binary-factors-as-contrasts"><i class="fa fa-check"></i><b>16.6.4</b> How to encode non binary factors as contrasts</a></li>
<li class="chapter" data-level="16.6.5" data-path="anova2.html"><a href="anova2.html#the-equivalence-between-anova-and-regression-for-non-binary-factors"><i class="fa fa-check"></i><b>16.6.5</b> The equivalence between ANOVA and regression for non-binary factors</a></li>
<li class="chapter" data-level="16.6.6" data-path="anova2.html"><a href="anova2.html#degrees-of-freedom-as-parameter-counting"><i class="fa fa-check"></i><b>16.6.6</b> Degrees of freedom as parameter counting!</a></li>
<li class="chapter" data-level="16.6.7" data-path="anova2.html"><a href="anova2.html#a-postscript"><i class="fa fa-check"></i><b>16.6.7</b> A postscript</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="anova2.html"><a href="anova2.html#contrasts"><i class="fa fa-check"></i><b>16.7</b> Different ways to specify contrasts</a><ul>
<li class="chapter" data-level="16.7.1" data-path="anova2.html"><a href="anova2.html#treatment-contrasts"><i class="fa fa-check"></i><b>16.7.1</b> Treatment contrasts</a></li>
<li class="chapter" data-level="16.7.2" data-path="anova2.html"><a href="anova2.html#helmert-contrasts"><i class="fa fa-check"></i><b>16.7.2</b> Helmert contrasts</a></li>
<li class="chapter" data-level="16.7.3" data-path="anova2.html"><a href="anova2.html#sum-to-zero-contrasts"><i class="fa fa-check"></i><b>16.7.3</b> Sum to zero contrasts</a></li>
<li class="chapter" data-level="16.7.4" data-path="anova2.html"><a href="anova2.html#viewing-and-setting-the-default-contrasts-in-r"><i class="fa fa-check"></i><b>16.7.4</b> Viewing and setting the default contrasts in R</a></li>
<li class="chapter" data-level="16.7.5" data-path="anova2.html"><a href="anova2.html#setting-the-contrasts-for-a-single-factor"><i class="fa fa-check"></i><b>16.7.5</b> Setting the contrasts for a single factor</a></li>
<li class="chapter" data-level="16.7.6" data-path="anova2.html"><a href="anova2.html#setting-the-contrasts-for-a-single-analysis"><i class="fa fa-check"></i><b>16.7.6</b> Setting the contrasts for a single analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="anova2.html"><a href="anova2.html#posthoc2"><i class="fa fa-check"></i><b>16.8</b> Post hoc tests</a></li>
<li class="chapter" data-level="16.9" data-path="anova2.html"><a href="anova2.html#plannedcomparisons"><i class="fa fa-check"></i><b>16.9</b> The method of planned comparisons</a></li>
<li class="chapter" data-level="16.10" data-path="anova2.html"><a href="anova2.html#unbalancedanova"><i class="fa fa-check"></i><b>16.10</b> Factorial ANOVA 3: unbalanced designs</a><ul>
<li class="chapter" data-level="16.10.1" data-path="anova2.html"><a href="anova2.html#the-coffee-data"><i class="fa fa-check"></i><b>16.10.1</b> The coffee data</a></li>
<li class="chapter" data-level="16.10.2" data-path="anova2.html"><a href="anova2.html#standard-anova-does-not-exist-for-unbalanced-designs"><i class="fa fa-check"></i><b>16.10.2</b> “Standard ANOVA” does not exist for unbalanced designs</a></li>
<li class="chapter" data-level="16.10.3" data-path="anova2.html"><a href="anova2.html#type-i-sum-of-squares"><i class="fa fa-check"></i><b>16.10.3</b> Type I sum of squares</a></li>
<li class="chapter" data-level="16.10.4" data-path="anova2.html"><a href="anova2.html#type-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.10.4</b> Type III sum of squares</a></li>
<li class="chapter" data-level="16.10.5" data-path="anova2.html"><a href="anova2.html#type-ii-sum-of-squares"><i class="fa fa-check"></i><b>16.10.5</b> Type II sum of squares</a></li>
<li class="chapter" data-level="16.10.6" data-path="anova2.html"><a href="anova2.html#effect-sizes-and-non-additive-sums-of-squares"><i class="fa fa-check"></i><b>16.10.6</b> Effect sizes (and non-additive sums of squares)</a></li>
</ul></li>
<li class="chapter" data-level="16.11" data-path="anova2.html"><a href="anova2.html#summary-14"><i class="fa fa-check"></i><b>16.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vi-endings-alternatives-and-prospects.html"><a href="part-vi-endings-alternatives-and-prospects.html"><i class="fa fa-check"></i>Part VI. Endings, alternatives and prospects</a></li>
<li class="chapter" data-level="17" data-path="bayes.html"><a href="bayes.html"><i class="fa fa-check"></i><b>17</b> Bayesian statistics</a><ul>
<li class="chapter" data-level="17.1" data-path="bayes.html"><a href="bayes.html#basicbayes"><i class="fa fa-check"></i><b>17.1</b> Probabilistic reasoning by rational agents</a><ul>
<li class="chapter" data-level="17.1.1" data-path="bayes.html"><a href="bayes.html#priors-what-you-believed-before"><i class="fa fa-check"></i><b>17.1.1</b> Priors: what you believed before</a></li>
<li class="chapter" data-level="17.1.2" data-path="bayes.html"><a href="bayes.html#likelihoods-theories-about-the-data"><i class="fa fa-check"></i><b>17.1.2</b> Likelihoods: theories about the data</a></li>
<li class="chapter" data-level="17.1.3" data-path="bayes.html"><a href="bayes.html#the-joint-probability-of-data-and-hypothesis"><i class="fa fa-check"></i><b>17.1.3</b> The joint probability of data and hypothesis</a></li>
<li class="chapter" data-level="17.1.4" data-path="bayes.html"><a href="bayes.html#updating-beliefs-using-bayes-rule"><i class="fa fa-check"></i><b>17.1.4</b> Updating beliefs using Bayes’ rule</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="bayes.html"><a href="bayes.html#bayesianhypothesistests"><i class="fa fa-check"></i><b>17.2</b> Bayesian hypothesis tests</a><ul>
<li class="chapter" data-level="17.2.1" data-path="bayes.html"><a href="bayes.html#the-bayes-factor"><i class="fa fa-check"></i><b>17.2.1</b> The Bayes factor</a></li>
<li class="chapter" data-level="17.2.2" data-path="bayes.html"><a href="bayes.html#interpreting-bayes-factors"><i class="fa fa-check"></i><b>17.2.2</b> Interpreting Bayes factors</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="bayes.html"><a href="bayes.html#whybayes"><i class="fa fa-check"></i><b>17.3</b> Why be a Bayesian?</a><ul>
<li class="chapter" data-level="17.3.1" data-path="bayes.html"><a href="bayes.html#statistics-that-mean-what-you-think-they-mean"><i class="fa fa-check"></i><b>17.3.1</b> Statistics that mean what you think they mean</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="bayes.html"><a href="bayes.html#evidentiary-standards-you-can-believe"><i class="fa fa-check"></i><b>17.4</b> Evidentiary standards you can believe</a></li>
<li class="chapter" data-level="17.5" data-path="bayes.html"><a href="bayes.html#the-p-value-is-a-lie."><i class="fa fa-check"></i><b>17.5</b> The <span class="math inline">\(p\)</span>-value is a lie.</a><ul>
<li class="chapter" data-level="17.5.1" data-path="bayes.html"><a href="bayes.html#is-it-really-this-bad"><i class="fa fa-check"></i><b>17.5.1</b> Is it really this bad?</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="bayes.html"><a href="bayes.html#bayescontingency"><i class="fa fa-check"></i><b>17.6</b> Bayesian analysis of contingency tables</a><ul>
<li class="chapter" data-level="17.6.1" data-path="bayes.html"><a href="bayes.html#the-orthodox-text"><i class="fa fa-check"></i><b>17.6.1</b> The orthodox text</a></li>
<li class="chapter" data-level="17.6.2" data-path="bayes.html"><a href="bayes.html#the-bayesian-test"><i class="fa fa-check"></i><b>17.6.2</b> The Bayesian test</a></li>
<li class="chapter" data-level="17.6.3" data-path="bayes.html"><a href="bayes.html#writing-up-the-results"><i class="fa fa-check"></i><b>17.6.3</b> Writing up the results</a></li>
<li class="chapter" data-level="17.6.4" data-path="bayes.html"><a href="bayes.html#other-sampling-plans"><i class="fa fa-check"></i><b>17.6.4</b> Other sampling plans</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="bayes.html"><a href="bayes.html#ttestbf"><i class="fa fa-check"></i><b>17.7</b> Bayesian <span class="math inline">\(t\)</span>-tests</a><ul>
<li class="chapter" data-level="17.7.1" data-path="bayes.html"><a href="bayes.html#independent-samples-t-test"><i class="fa fa-check"></i><b>17.7.1</b> Independent samples <span class="math inline">\(t\)</span>-test</a></li>
<li class="chapter" data-level="17.7.2" data-path="bayes.html"><a href="bayes.html#paired-samples-t-test"><i class="fa fa-check"></i><b>17.7.2</b> Paired samples <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="17.8" data-path="bayes.html"><a href="bayes.html#bayesregression"><i class="fa fa-check"></i><b>17.8</b> Bayesian regression</a><ul>
<li class="chapter" data-level="17.8.1" data-path="bayes.html"><a href="bayes.html#a-quick-refresher"><i class="fa fa-check"></i><b>17.8.1</b> A quick refresher</a></li>
<li class="chapter" data-level="17.8.2" data-path="bayes.html"><a href="bayes.html#the-bayesian-version"><i class="fa fa-check"></i><b>17.8.2</b> The Bayesian version</a></li>
<li class="chapter" data-level="17.8.3" data-path="bayes.html"><a href="bayes.html#finding-the-best-model"><i class="fa fa-check"></i><b>17.8.3</b> Finding the best model</a></li>
<li class="chapter" data-level="17.8.4" data-path="bayes.html"><a href="bayes.html#extracting-bayes-factors-for-all-included-terms"><i class="fa fa-check"></i><b>17.8.4</b> Extracting Bayes factors for all included terms</a></li>
</ul></li>
<li class="chapter" data-level="17.9" data-path="bayes.html"><a href="bayes.html#bayesanova"><i class="fa fa-check"></i><b>17.9</b> Bayesian ANOVA</a><ul>
<li class="chapter" data-level="17.9.1" data-path="bayes.html"><a href="bayes.html#a-quick-refresher-1"><i class="fa fa-check"></i><b>17.9.1</b> A quick refresher</a></li>
<li class="chapter" data-level="17.9.2" data-path="bayes.html"><a href="bayes.html#the-bayesian-version-1"><i class="fa fa-check"></i><b>17.9.2</b> The Bayesian version</a></li>
<li class="chapter" data-level="17.9.3" data-path="bayes.html"><a href="bayes.html#constructing-bayesian-type-ii-tests"><i class="fa fa-check"></i><b>17.9.3</b> Constructing Bayesian Type II tests</a></li>
</ul></li>
<li class="chapter" data-level="17.10" data-path="bayes.html"><a href="bayes.html#summary-15"><i class="fa fa-check"></i><b>17.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="epilogue.html"><a href="epilogue.html"><i class="fa fa-check"></i>Epilogue</a><ul>
<li class="chapter" data-level="" data-path="epilogue.html"><a href="epilogue.html#the-undiscovered-statistics"><i class="fa fa-check"></i>The undiscovered statistics</a><ul>
<li class="chapter" data-level="" data-path="epilogue.html"><a href="epilogue.html#omissions-within-the-topics-covered"><i class="fa fa-check"></i>Omissions within the topics covered</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="epilogue.html"><a href="epilogue.html#statistical-models-missing-from-the-book"><i class="fa fa-check"></i>Statistical models missing from the book</a></li>
<li class="chapter" data-level="" data-path="epilogue.html"><a href="epilogue.html#other-ways-of-doing-inference"><i class="fa fa-check"></i>Other ways of doing inference</a><ul>
<li class="chapter" data-level="" data-path="epilogue.html"><a href="epilogue.html#miscellaneous-topics"><i class="fa fa-check"></i>Miscellaneous topics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="epilogue.html"><a href="epilogue.html#learning-the-basics-and-learning-them-in-r"><i class="fa fa-check"></i>Learning the basics, and learning them in R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://learningstatisticswithr.com/book/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning statistics with R: A tutorial for psychology students and other beginners. (Version 0.6.1)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ttest" class="section level1">
<h1><span class="header-section-number">Chapter 13</span> Comparing two means</h1>
<p>In the previous chapter we covered the situation when your outcome variable is nominal scale and your predictor variable<a href="#fn185" class="footnoteRef" id="fnref185"><sup>185</sup></a> is also nominal scale. Lots of real world situations have that character, and so you’ll find that chi-square tests in particular are quite widely used. However, you’re much more likely to find yourself in a situation where your outcome variable is interval scale or higher, and what you’re interested in is whether the average value of the outcome variable is higher in one group or another. For instance, a psychologist might want to know if anxiety levels are higher among parents than non-parents, or if working memory capacity is reduced by listening to music (relative to not listening to music). In a medical context, we might want to know if a new drug increases or decreases blood pressure. An agricultural scientist might want to know whether adding phosphorus to Australian native plants will kill them.<a href="#fn186" class="footnoteRef" id="fnref186"><sup>186</sup></a> In all these situations, our outcome variable is a fairly continuous, interval or ratio scale variable; and our predictor is a binary “grouping” variable. In other words, we want to compare the means of the two groups.</p>
<p>The standard answer to the problem of comparing means is to use a <span class="math inline">\(t\)</span>-test, of which there are several varieties depending on exactly what question you want to solve. As a consequence, the majority of this chapter focuses on different types of <span class="math inline">\(t\)</span>-test: one sample <span class="math inline">\(t\)</span>-tests are discussed in Section <a href="ttest.html#onesamplettest">13.2</a>, independent samples <span class="math inline">\(t\)</span>-tests are discussed in Sections <a href="ttest.html#studentttest">13.3</a> and <a href="ttest.html#welchttest">13.4</a>, and paired samples <span class="math inline">\(t\)</span>-tests are discussed in Section <a href="ttest.html#pairedsamplesttest">13.5</a>. After that, we’ll talk a bit about Cohen’s <span class="math inline">\(d\)</span>, which is the standard measure of effect size for a <span class="math inline">\(t\)</span>-test (Section <a href="ttest.html#cohensd">13.8</a>). The later sections of the chapter focus on the assumptions of the <span class="math inline">\(t\)</span>-tests, and possible remedies if they are violated. However, before discussing any of these useful things, we’ll start with a discussion of the <span class="math inline">\(z\)</span>-test.</p>
<div id="the-one-sample-z-test" class="section level2">
<h2><span class="header-section-number">13.1</span> The one-sample <span class="math inline">\(z\)</span>-test</h2>
<p>In this section I’ll describe one of the most useless tests in all of statistics: the <strong><em><span class="math inline">\(z\)</span>-test</em></strong>. Seriously – this test is almost never used in real life. Its only real purpose is that, when teaching statistics, it’s a very convenient stepping stone along the way towards the <span class="math inline">\(t\)</span>-test, which is probably the most (over)used tool in all statistics.</p>
<div id="the-inference-problem-that-the-test-addresses" class="section level3">
<h3><span class="header-section-number">13.1.1</span> The inference problem that the test addresses</h3>
<p>To introduce the idea behind the <span class="math inline">\(z\)</span>-test, let’s use a simple example. A friend of mine, Dr Zeppo, grades his introductory statistics class on a curve. Let’s suppose that the average grade in his class is 67.5, and the standard deviation is 9.5. Of his many hundreds of students, it turns out that 20 of them also take psychology classes. Out of curiosity, I find myself wondering: do the psychology students tend to get the same grades as everyone else (i.e., mean 67.5) or do they tend to score higher or lower? He emails me the <code>zeppo.Rdata</code> file, which I use to pull up the <code>grades</code> of those students,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>( <span class="kw">file.path</span>(projecthome, <span class="st">&quot;data/zeppo.Rdata&quot;</span> )) 
<span class="kw">print</span>( grades )</code></pre></div>
<pre><code>##  [1] 50 60 60 64 66 66 67 69 70 74 76 76 77 79 79 79 81 82 82 89</code></pre>
<p>and calculate the mean:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>( grades )</code></pre></div>
<pre><code>## [1] 72.3</code></pre>
<p>Hm. It <em>might</em> be that the psychology students are scoring a bit higher than normal: that sample mean of <span class="math inline">\(\bar{X} = 72.3\)</span> is a fair bit higher than the hypothesised population mean of <span class="math inline">\(\mu = 67.5\)</span>, but on the other hand, a sample size of <span class="math inline">\(N = 20\)</span> isn’t all that big. Maybe it’s pure chance.</p>
<p>To answer the question, it helps to be able to write down what it is that I think I know. Firstly, I know that the sample mean is <span class="math inline">\(\bar{X} = 72.3\)</span>. If I’m willing to assume that the psychology students have the same standard deviation as the rest of the class then I can say that the population standard deviation is <span class="math inline">\(\sigma = 9.5\)</span>. I’ll also assume that since Dr Zeppo is grading to a curve, the psychology student grades are normally distributed.</p>
<p>Next, it helps to be clear about what I want to learn from the data. In this case, my research hypothesis relates to the <em>population</em> mean <span class="math inline">\(\mu\)</span> for the psychology student grades, which is unknown. Specifically, I want to know if <span class="math inline">\(\mu = 67.5\)</span> or not. Given that this is what I know, can we devise a hypothesis test to solve our problem? The data, along with the hypothesised distribution from which they are thought to arise, are shown in Figure <a href="ttest.html#fig:zeppo">13.1</a>. Not entirely obvious what the right answer is, is it? For this, we are going to need some statistics.</p>
<div class="figure"><span id="fig:zeppo"></span>
<img src="lsr_files/figure-html/zeppo-1.png" alt="The theoretical distribution (solid line) from which the psychology student grades (grey bars) are supposed to have been generated." width="672" />
<p class="caption">
Figure 13.1: The theoretical distribution (solid line) from which the psychology student grades (grey bars) are supposed to have been generated.
</p>
</div>
</div>
<div id="constructing-the-hypothesis-test" class="section level3">
<h3><span class="header-section-number">13.1.2</span> Constructing the hypothesis test</h3>
<p>The first step in constructing a hypothesis test is to be clear about what the null and alternative hypotheses are. This isn’t too hard to do. Our null hypothesis, <span class="math inline">\(H_0\)</span>, is that the true population mean <span class="math inline">\(\mu\)</span> for psychology student grades is 67.5%; and our alternative hypothesis is that the population mean <em>isn’t</em> 67.5%. If we write this in mathematical notation, these hypotheses become, <span class="math display">\[
\begin{array}{ll}
H_0: &amp; \mu = 67.5 \\
H_1: &amp; \mu \neq 67.5
\end{array}
\]</span> though to be honest this notation doesn’t add much to our understanding of the problem, it’s just a compact way of writing down what we’re trying to learn from the data. The null hypotheses <span class="math inline">\(H_0\)</span> and the alternative hypothesis <span class="math inline">\(H_1\)</span> for our test are both illustrated in Figure <a href="ttest.html#fig:ztesthyp">13.2</a>. In addition to providing us with these hypotheses, the scenario outlined above provides us with a fair amount of background knowledge that might be useful. Specifically, there are two special pieces of information that we can add:</p>
<p>1 The psychology grades are normally distributed. 1 The true standard deviation of these scores <span class="math inline">\(\sigma\)</span> is known to be 9.5.</p>
<p>For the moment, we’ll act as if these are absolutely trustworthy facts. In real life, this kind of absolutely trustworthy background knowledge doesn’t exist, and so if we want to rely on these facts we’ll just have make the <em>assumption</em> that these things are true. However, since these assumptions may or may not be warranted, we might need to check them. For now though, we’ll keep things simple.</p>
<div class="figure"><span id="fig:ztesthyp"></span>
<img src="lsr_files/figure-html/ztesthyp-1.png" alt="Graphical illustration of the null and alternative hypotheses assumed by the one sample $z$-test (the two sided version, that is). The null and alternative hypotheses both assume that the population distribution is normal, and additionally assumes that the population standard deviation is known (fixed at some value $\sigma_0$). The null hypothesis (left) is that the population mean $\mu$ is equal to some specified value $\mu_0$. The alternative hypothesis is that the population mean differs from this value, $\mu \neq \mu_0$." width="672" />
<p class="caption">
Figure 13.2: Graphical illustration of the null and alternative hypotheses assumed by the one sample <span class="math inline">\(z\)</span>-test (the two sided version, that is). The null and alternative hypotheses both assume that the population distribution is normal, and additionally assumes that the population standard deviation is known (fixed at some value <span class="math inline">\(\sigma_0\)</span>). The null hypothesis (left) is that the population mean <span class="math inline">\(\mu\)</span> is equal to some specified value <span class="math inline">\(\mu_0\)</span>. The alternative hypothesis is that the population mean differs from this value, <span class="math inline">\(\mu \neq \mu_0\)</span>.
</p>
</div>
<p>The next step is to figure out what we would be a good choice for a diagnostic test statistic; something that would help us discriminate between <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>. Given that the hypotheses all refer to the population mean <span class="math inline">\(\mu\)</span>, you’d feel pretty confident that the sample mean <span class="math inline">\(\bar{X}\)</span> would be a pretty useful place to start. What we could do, is look at the difference between the sample mean <span class="math inline">\(\bar{X}\)</span> and the value that the null hypothesis predicts for the population mean. In our example, that would mean we calculate <span class="math inline">\(\bar{X} - 67.5\)</span>. More generally, if we let <span class="math inline">\(\mu_0\)</span> refer to the value that the null hypothesis claims is our population mean, then we’d want to calculate <span class="math display">\[
\bar{X} - \mu_0
\]</span> If this quantity equals or is very close to 0, things are looking good for the null hypothesis. If this quantity is a long way away from 0, then it’s looking less likely that the null hypothesis is worth retaining. But how far away from zero should it be for us to reject <span class="math inline">\(H_0\)</span>?</p>
<p>To figure that out, we need to be a bit more sneaky, and we’ll need to rely on those two pieces of background knowledge that I wrote down previously, namely that the raw data are normally distributed, and we know the value of the population standard deviation <span class="math inline">\(\sigma\)</span>. If the null hypothesis is actually true, and the true mean is <span class="math inline">\(\mu_0\)</span>, then these facts together mean that we know the complete population distribution of the data: a normal distribution with mean <span class="math inline">\(\mu_0\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. Adopting the notation from Section <a href="probability.html#normal">9.5</a>, a statistician might write this as: <span class="math display">\[
X \sim \mbox{Normal}(\mu_0,\sigma^2)
\]</span></p>
<p>Okay, if that’s true, then what can we say about the distribution of <span class="math inline">\(\bar{X}\)</span>? Well, as we discussed earlier (see Section <a href="estimation.html#clt">10.3.3</a>), the sampling distribution of the mean <span class="math inline">\(\bar{X}\)</span> is also normal, and has mean <span class="math inline">\(\mu\)</span>. But the standard deviation of this sampling distribution <span class="math inline">\(\mbox{SE}({\bar{X}})\)</span>, which is called the <em>standard error of the mean</em>, is <span class="math display">\[
\mbox{SE}({\bar{X}}) = \frac{\sigma}{\sqrt{N}}
\]</span> In other words, if the null hypothesis is true then the sampling distribution of the mean can be written as follows: <span class="math display">\[
\bar{X} \sim \mbox{Normal}(\mu_0,\mbox{SE}({\bar{X}}))
\]</span> Now comes the trick. What we can do is convert the sample mean <span class="math inline">\(\bar{X}\)</span> into a standard score (Section <a href="descriptives.html#zscore">5.6</a>). This is conventionally written as <span class="math inline">\(z\)</span>, but for now I’m going to refer to it as <span class="math inline">\(z_{\bar{X}}\)</span>. (The reason for using this expanded notation is to help you remember that we’re calculating standardised version of a sample mean, <em>not</em> a standardised version of a single observation, which is what a <span class="math inline">\(z\)</span>-score usually refers to). When we do so, the <span class="math inline">\(z\)</span>-score for our sample mean is <span class="math display">\[
z_{\bar{X}} = \frac{\bar{X} - \mu_0}{\mbox{SE}({\bar{X}})}
\]</span> or, equivalently <span class="math display">\[
z_{\bar{X}} =  \frac{\bar{X} - \mu_0}{\sigma / \sqrt{N}}
\]</span> This <span class="math inline">\(z\)</span>-score is our test statistic. The nice thing about using this as our test statistic is that like all <span class="math inline">\(z\)</span>-scores, it has a standard normal distribution: <span class="math display">\[
z_{\bar{X}} \sim \mbox{Normal}(0,1)
\]</span> (again, see Section <a href="descriptives.html#zscore">5.6</a> if you’ve forgotten why this is true). In other words, regardless of what scale the original data are on, the <span class="math inline">\(z\)</span>-statistic iteself always has the same interpretation: it’s equal to the number of standard errors that separate the observed sample mean <span class="math inline">\(\bar{X}\)</span> from the population mean <span class="math inline">\(\mu_0\)</span> predicted by the null hypothesis. Better yet, regardless of what the population parameters for the raw scores actually are, the 5% critical regions for <span class="math inline">\(z\)</span>-test are always the same, as illustrated in Figures <a href="ttest.html#fig:ztest1">13.4</a> and <a href="ttest.html#fig:ztest2">13.3</a>. And what this meant, way back in the days where people did all their statistics by hand, is that someone could publish a table like this:</p>
<table>
<thead>
<tr class="header">
<th align="center">desired <span class="math inline">\(\alpha\)</span> level</th>
<th align="center">two-sided test</th>
<th align="center">one-sided test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">.1</td>
<td align="center">1.644854</td>
<td align="center">1.281552</td>
</tr>
<tr class="even">
<td align="center">.05</td>
<td align="center">1.959964</td>
<td align="center">1.644854</td>
</tr>
<tr class="odd">
<td align="center">.01</td>
<td align="center">2.575829</td>
<td align="center">2.326348</td>
</tr>
<tr class="even">
<td align="center">.001</td>
<td align="center">3.290527</td>
<td align="center">3.090232</td>
</tr>
</tbody>
</table>
<p>which in turn meant that researchers could calculate their <span class="math inline">\(z\)</span>-statistic by hand, and then look up the critical value in a text book. That was an incredibly handy thing to be able to do back then, but it’s kind of unnecessary these days, since it’s trivially easy to do it with software like R.</p>
<div class="figure"><span id="fig:ztest2"></span>
<img src="lsr_files/figure-html/ztest2-1.png" alt="Rejection regions for the two-sided $z$-test" width="672" />
<p class="caption">
Figure 13.3: Rejection regions for the two-sided <span class="math inline">\(z\)</span>-test
</p>
</div>
<div class="figure"><span id="fig:ztest1"></span>
<img src="lsr_files/figure-html/ztest1-1.png" alt="Rejection regions for the one-sided $z$-test" width="672" />
<p class="caption">
Figure 13.4: Rejection regions for the one-sided <span class="math inline">\(z\)</span>-test
</p>
</div>
</div>
<div id="a-worked-example-using-r" class="section level3">
<h3><span class="header-section-number">13.1.3</span> A worked example using R</h3>
<p>Now, as I mentioned earlier, the <span class="math inline">\(z\)</span>-test is almost never used in practice. It’s so rarely used in real life that the basic installation of R doesn’t have a built in function for it. However, the test is so incredibly simple that it’s really easy to do one manually. Let’s go back to the data from Dr Zeppo’s class. Having loaded the <code>grades</code> data, the first thing I need to do is calculate the sample mean:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample.mean &lt;-<span class="st"> </span><span class="kw">mean</span>( grades )
<span class="kw">print</span>( sample.mean )</code></pre></div>
<pre><code>## [1] 72.3</code></pre>
<p>Then, I create variables corresponding to known population standard deviation (<span class="math inline">\(\sigma = 9.5\)</span>), and the value of the population mean that the null hypothesis specifies (<span class="math inline">\(\mu_0 = 67.5\)</span>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu.null &lt;-<span class="st"> </span><span class="fl">67.5</span>
sd.true &lt;-<span class="st"> </span><span class="fl">9.5</span></code></pre></div>
<p>Let’s also create a variable for the sample size. We could count up the number of observations ourselves, and type <code>N &lt;- 20</code> at the command prompt, but counting is tedious and repetitive. Let’s get R to do the tedious repetitive bit by using the <code>length()</code> function, which tells us how many elements there are in a vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="kw">length</span>( grades )
<span class="kw">print</span>( N )</code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>Next, let’s calculate the (true) standard error of the mean:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sem.true &lt;-<span class="st"> </span>sd.true <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(N)
<span class="kw">print</span>(sem.true)</code></pre></div>
<pre><code>## [1] 2.124265</code></pre>
<p>And finally, we calculate our <span class="math inline">\(z\)</span>-score:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.score &lt;-<span class="st"> </span>(sample.mean <span class="op">-</span><span class="st"> </span>mu.null) <span class="op">/</span><span class="st"> </span>sem.true
<span class="kw">print</span>( z.score )</code></pre></div>
<pre><code>## [1] 2.259606</code></pre>
<p>At this point, we would traditionally look up the value 2.26 in our table of critical values. Our original hypothesis was two-sided (we didn’t really have any theory about whether psych students would be better or worse at statistics than other students) so our hypothesis test is two-sided (or two-tailed) also. Looking at the little table that I showed earlier, we can see that 2.26 is bigger than the critical value of 1.96 that would be required to be significant at <span class="math inline">\(\alpha = .05\)</span>, but smaller than the value of 2.58 that would be required to be significant at a level of <span class="math inline">\(\alpha = .01\)</span>. Therefore, we can conclude that we have a significant effect, which we might write up by saying something like this:</p>
<blockquote>
<p>With a mean grade of 73.2 in the sample of psychology students, and assuming a true population standard deviation of 9.5, we can conclude that the psychology students have significantly different statistics scores to the class average (<span class="math inline">\(z = 2.26\)</span>, <span class="math inline">\(N=20\)</span>, <span class="math inline">\(p&lt;.05\)</span>).</p>
</blockquote>
<p>However, what if want an exact <span class="math inline">\(p\)</span>-value? Well, back in the day, the tables of critical values were huge, and so you could look up your actual <span class="math inline">\(z\)</span>-value, and find the smallest value of <span class="math inline">\(\alpha\)</span> for which your data would be significant (which, as discussed earlier, is the very definition of a <span class="math inline">\(p\)</span>-value). However, looking things up in books is tedious, and typing things into computers is awesome. So let’s do it using R instead. Now, notice that the <span class="math inline">\(\alpha\)</span> level of a <span class="math inline">\(z\)</span>-test (or any other test, for that matter) defines the total area “under the curve” for the critical region, right? That is, if we set <span class="math inline">\(\alpha = .05\)</span> for a two-sided test, then the critical region is set up such that the area under the curve for the critical region is <span class="math inline">\(.05\)</span>. And, for the <span class="math inline">\(z\)</span>-test, the critical value of 1.96 is chosen that way because the area in the lower tail (i.e., below <span class="math inline">\(-1.96\)</span>) is exactly <span class="math inline">\(.025\)</span> and the area under the upper tail (i.e., above <span class="math inline">\(1.96\)</span>) is exactly <span class="math inline">\(.025\)</span>. So, since our observed <span class="math inline">\(z\)</span>-statistic is <span class="math inline">\(2.26\)</span>, why not calculate the area under the curve below <span class="math inline">\(-2.26\)</span> or above <span class="math inline">\(2.26\)</span>? In R we can calculate this using the <code>pnorm()</code> function. For the upper tail:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">upper.area &lt;-<span class="st"> </span><span class="kw">pnorm</span>( <span class="dt">q =</span> z.score, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span> )
<span class="kw">print</span>( upper.area )</code></pre></div>
<pre><code>## [1] 0.01192287</code></pre>
<p>The <code>lower.tail = FALSE</code> is me telling R to calculate the area under the curve from 2.26 <em>and upwards</em>. If I’d told it that <code>lower.tail = TRUE</code>, then R would calculate the area from 2.26 <em>and below</em>, and it would give me an answer 0.9880771. Alternatively, to calculate the area from <span class="math inline">\(-2.26\)</span> and below, we get</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lower.area &lt;-<span class="st"> </span><span class="kw">pnorm</span>( <span class="dt">q =</span> <span class="op">-</span>z.score, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span> )
<span class="kw">print</span>( lower.area )</code></pre></div>
<pre><code>## [1] 0.01192287</code></pre>
<p>Thus we get our <span class="math inline">\(p\)</span>-value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p.value &lt;-<span class="st"> </span>lower.area <span class="op">+</span><span class="st"> </span>upper.area
<span class="kw">print</span>( p.value )</code></pre></div>
<pre><code>## [1] 0.02384574</code></pre>
</div>
<div id="zassumptions" class="section level3">
<h3><span class="header-section-number">13.1.4</span> Assumptions of the <span class="math inline">\(z\)</span>-test</h3>
<p>As I’ve said before, all statistical tests make assumptions. Some tests make reasonable assumptions, while other tests do not. The test I’ve just described – the one sample <span class="math inline">\(z\)</span>-test – makes three basic assumptions. These are:</p>
<ul>
<li><em>Normality</em>. As usually described, the <span class="math inline">\(z\)</span>-test assumes that the true population distribution is normal.<a href="#fn187" class="footnoteRef" id="fnref187"><sup>187</sup></a> is often pretty reasonable, and not only that, it’s an assumption that we can check if we feel worried about it (see Section <a href="ttest.html#shapiro">13.9</a>).</li>
<li><em>Independence</em>. The second assumption of the test is that the observations in your data set are not correlated with each other, or related to each other in some funny way. This isn’t as easy to check statistically: it relies a bit on good experimetal design. An obvious (and stupid) example of something that violates this assumption is a data set where you “copy” the same observation over and over again in your data file: so you end up with a massive “sample size”, consisting of only one genuine observation. More realistically, you have to ask yourself if it’s really plausible to imagine that each observation is a completely random sample from the population that you’re interested in. In practice, this assumption is never met; but we try our best to design studies that minimise the problems of correlated data.</li>
<li><em>Known standard deviation</em>. The third assumption of the <span class="math inline">\(z\)</span>-test is that the true standard deviation of the population is known to the researcher. This is just stupid. In no real world data analysis problem do you know the standard deviation <span class="math inline">\(\sigma\)</span> of some population, but are completely ignorant about the mean <span class="math inline">\(\mu\)</span>. In other words, this assumption is <em>always</em> wrong.</li>
</ul>
<p>In view of the stupidity of assuming that <span class="math inline">\(\sigma\)</span> is known, let’s see if we can live without it. This takes us out of the dreary domain of the <span class="math inline">\(z\)</span>-test, and into the magical kingdom of the <span class="math inline">\(t\)</span>-test, with unicorns and fairies and leprechauns, and um…</p>
</div>
</div>
<div id="onesamplettest" class="section level2">
<h2><span class="header-section-number">13.2</span> The one-sample <span class="math inline">\(t\)</span>-test</h2>
<p>After some thought, I decided that it might not be safe to assume that the psychology student grades necessarily have the same standard deviation as the other students in Dr Zeppo’s class. After all, if I’m entertaining the hypothesis that they don’t have the same mean, then why should I believe that they absolutely have the same standard deviation? In view of this, I should really stop assuming that I know the true value of <span class="math inline">\(\sigma\)</span>. This violates the assumptions of my <span class="math inline">\(z\)</span>-test, so in one sense I’m back to square one. However, it’s not like I’m completely bereft of options. After all, I’ve still got my raw data, and those raw data give me an <em>estimate</em> of the population standard deviation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>( grades )</code></pre></div>
<pre><code>## [1] 9.520615</code></pre>
<p>In other words, while I can’t say that I know that <span class="math inline">\(\sigma = 9.5\)</span>, I <em>can</em> say that <span class="math inline">\(\hat\sigma = 9.52\)</span>.</p>
<p>Okay, cool. The obvious thing that you might think to do is run a <span class="math inline">\(z\)</span>-test, but using the estimated standard deviation of 9.52 instead of relying on my assumption that the true standard deviation is 9.5. So, we could just type this new number into R and out would come the answer. And you probably wouldn’t be surprised to hear that this would still give us a significant result. This approach is close, but it’s not <em>quite</em> correct. Because we are now relying on an <em>estimate</em> of the population standard deviation, we need to make some adjustment for the fact that we have some uncertainty about what the true population standard deviation actually is. Maybe our data are just a fluke … maybe the true population standard deviation is 11, for instance. But if that were actually true, and we ran the <span class="math inline">\(z\)</span>-test assuming <span class="math inline">\(\sigma=11\)</span>, then the result would end up being <em>non-significant</em>. That’s a problem, and it’s one we’re going to have to address.</p>
<div class="figure">
<img src="lsr_files/figure-html/ttesthyp_onesample-1.png" alt="Graphical illustration of the null and alternative hypotheses assumed by the (two sided) one sample $t$-test. Note the similarity to the $z$-test. The null hypothesis is that the population mean $\mu$ is equal to some specified value $\mu_0$, and the alternative hypothesis is that it is not. Like the $z$-test, we assume that the data are normally distributed; but we do not assume that the population standard deviation $\sigma$ is known in advance." width="672" />
<p class="caption">
(#fig:ttesthyp_onesample)Graphical illustration of the null and alternative hypotheses assumed by the (two sided) one sample <span class="math inline">\(t\)</span>-test. Note the similarity to the <span class="math inline">\(z\)</span>-test. The null hypothesis is that the population mean <span class="math inline">\(\mu\)</span> is equal to some specified value <span class="math inline">\(\mu_0\)</span>, and the alternative hypothesis is that it is not. Like the <span class="math inline">\(z\)</span>-test, we assume that the data are normally distributed; but we do not assume that the population standard deviation <span class="math inline">\(\sigma\)</span> is known in advance.
</p>
</div>
<div id="introducing-the-t-test" class="section level3">
<h3><span class="header-section-number">13.2.1</span> Introducing the <span class="math inline">\(t\)</span>-test</h3>
<p>This ambiguity is annoying, and it was resolved in 1908 by a guy called William Sealy Gosset <span class="citation">(Student <a href="#ref-Student1908">1908</a>)</span>, who was working as a chemist for the Guinness brewery at the time <span class="citation">(see Box <a href="#ref-Box1987">1987</a>)</span>. Because Guinness took a dim view of its employees publishing statistical analysis (apparently they felt it was a trade secret), he published the work under the pseudonym “A Student”, and to this day, the full name of the <span class="math inline">\(t\)</span>-test is actually <strong><em>Student’s <span class="math inline">\(t\)</span>-test</em></strong>. The key thing that Gosset figured out is how we should accommodate the fact that we aren’t completely sure what the true standard deviation is.<a href="#fn188" class="footnoteRef" id="fnref188"><sup>188</sup></a> The answer is that it subtly changes the sampling distribution. In the <span class="math inline">\(t\)</span>-test, our test statistic (now called a <span class="math inline">\(t\)</span>-statistic) is calculated in exactly the same way I mentioned above. If our null hypothesis is that the true mean is <span class="math inline">\(\mu\)</span>, but our sample has mean <span class="math inline">\(\bar{X}\)</span> and our estimate of the population standard deviation is <span class="math inline">\(\hat{\sigma}\)</span>, then our <span class="math inline">\(t\)</span> statistic is: <span class="math display">\[
t = \frac{\bar{X} - \mu}{\hat{\sigma}/\sqrt{N} }
\]</span> The only thing that has changed in the equation is that instead of using the known true value <span class="math inline">\(\sigma\)</span>, we use the estimate <span class="math inline">\(\hat{\sigma}\)</span>. And if this estimate has been constructed from <span class="math inline">\(N\)</span> observations, then the sampling distribution turns into a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(N-1\)</span> <strong><em>degrees of freedom</em></strong> (df). The <span class="math inline">\(t\)</span> distribution is very similar to the normal distribution, but has “heavier” tails, as discussed earlier in Section <a href="probability.html#otherdists">9.6</a> and illustrated in Figure <a href="ttest.html#fig:ttestdist">13.5</a>. Notice, though, that as df gets larger, the <span class="math inline">\(t\)</span>-distribution starts to look identical to the standard normal distribution. This is as it should be: if you have a sample size of <span class="math inline">\(N = 70,000,000\)</span> then your “estimate” of the standard deviation would be pretty much perfect, right? So, you should expect that for large <span class="math inline">\(N\)</span>, the <span class="math inline">\(t\)</span>-test would behave exactly the same way as a <span class="math inline">\(z\)</span>-test. And that’s exactly what happens!</p>
<div class="figure"><span id="fig:ttestdist"></span>
<img src="C:/Users/pcmis/Documents/rbook/bookdown/img/ttest2/tdist_3.png" alt="The $t$ distribution with 2 degrees of freedom (left) and 10 degrees of freedom (right), with a standard normal distribution (i.e., mean 0 and std dev 1) plotted as dotted lines for comparison purposes. Notice that the $t$ distribution has heavier tails (higher kurtosis) than the normal distribution; this effect is quite exaggerated when the degrees of freedom are very small, but negligible for larger values. In other words, for large $df$ the $t$ distribution is essentially identical to a normal distribution."  />
<p class="caption">
Figure 13.5: The <span class="math inline">\(t\)</span> distribution with 2 degrees of freedom (left) and 10 degrees of freedom (right), with a standard normal distribution (i.e., mean 0 and std dev 1) plotted as dotted lines for comparison purposes. Notice that the <span class="math inline">\(t\)</span> distribution has heavier tails (higher kurtosis) than the normal distribution; this effect is quite exaggerated when the degrees of freedom are very small, but negligible for larger values. In other words, for large <span class="math inline">\(df\)</span> the <span class="math inline">\(t\)</span> distribution is essentially identical to a normal distribution.
</p>
</div>
</div>
<div id="doing-the-test-in-r" class="section level3">
<h3><span class="header-section-number">13.2.2</span> Doing the test in R</h3>
<p>As you might expect, the mechanics of the <span class="math inline">\(t\)</span>-test are almost identical to the mechanics of the <span class="math inline">\(z\)</span>-test. So there’s not much point in going through the tedious exercise of showing you how to do the calculations using low level commands: it’s pretty much identical to the calculations that we did earlier, except that we use the estimated standard deviation (i.e., something like <code>se.est &lt;- sd(grades)</code>), and then we test our hypothesis using the <span class="math inline">\(t\)</span> distribution rather than the normal distribution (i.e. we use <code>pt()</code> rather than <code>pnorm()</code>. And so instead of going through the calculations in tedious detail for a second time, I’ll jump straight to showing you how <span class="math inline">\(t\)</span>-tests are actually done in practice.</p>
<p>The situation with <span class="math inline">\(t\)</span>-tests is very similar to the one we encountered with chi-squared tests in Chapter <a href="chisquare.html#chisquare">12</a>. R comes with one function called <code>t.test()</code> that is very flexible (it can run lots of different kinds of <span class="math inline">\(t\)</span>-tests) and is somewhat terse (the output is quite compressed). Later on in the chapter I’ll show you how to use the <code>t.test()</code> function (Section <a href="ttest.html#ttestfunction">13.7</a>), but to start out with I’m going to rely on some simpler functions in the <code>lsr</code> package. Just like last time, what I’ve done is written a few simpler functions, each of which does only one thing. So, if you want to run a one-sample <span class="math inline">\(t\)</span>-test, use the <code>oneSampleTTest()</code> function! It’s pretty straightforward to use: all you need to do is specify <code>x</code>, the variable containing the data, and <code>mu</code>, the true population mean according to the null hypothesis. All you need to type is this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lsr)

<span class="kw">oneSampleTTest</span>( <span class="dt">x=</span>grades, <span class="dt">mu=</span><span class="fl">67.5</span> )</code></pre></div>
<pre><code>## 
##    One sample t-test 
## 
## Data variable:   grades 
## 
## Descriptive statistics: 
##             grades
##    mean     72.300
##    std dev.  9.521
## 
## Hypotheses: 
##    null:        population mean equals 67.5 
##    alternative: population mean not equal to 67.5 
## 
## Test results: 
##    t-statistic:  2.255 
##    degrees of freedom:  19 
##    p-value:  0.036 
## 
## Other information: 
##    two-sided 95% confidence interval:  [67.844, 76.756] 
##    estimated effect size (Cohen&#39;s d):  0.504</code></pre>
<p>Easy enough. Now lets go through the output. Just like we saw in the last chapter, I’ve written the functions so that the output is pretty verbose. It tries to describe in a lot of detail what its actually done:</p>
<pre><code>   One sample t-test 

Data variable:   grades 

Descriptive statistics: 
            grades
   mean     72.300
   std dev.  9.521

Hypotheses: 
   null:        population mean equals 67.5 
   alternative: population mean not equal to 67.5 

Test results: 
   t-statistic:  2.255 
   degrees of freedom:  19 
   p-value:  0.036 

Other information: 
   two-sided 95% confidence interval:  [67.844, 76.756] 
   estimated effect size (Cohen&#39;s d):  0.504 </code></pre>
<p>Reading this output from top to bottom, you can see it’s trying to lead you through the data analysis process. The first two lines tell you what kind of test was run and what data were used. It then gives you some basic information about the sample: specifically, the sample mean and standard deviation of the data. It then moves towards the inferential statistics part. It starts by telling you what the null and alternative hypotheses were, and then it reports the results of the test: the <span class="math inline">\(t\)</span>-statistic, the degrees of freedom, and the <span class="math inline">\(p\)</span>-value. Finally, it reports two other things you might care about: the confidence interval for the mean, and a measure of effect size (we’ll talk more about effect sizes later).</p>
<p>So that seems straightforward enough. Now what do we <em>do</em> with this output? Well, since we’re pretending that we actually care about my toy example, we’re overjoyed to discover that the result is statistically significant (i.e. <span class="math inline">\(p\)</span> value below .05). We could report the result by saying something like this:</p>
<blockquote>
<p>With a mean grade of 72.3, the psychology students scored slightly higher than the average grade of 67.5 (<span class="math inline">\(t(19) = 2.25\)</span>, <span class="math inline">\(p&lt;.05\)</span>); the 95% confidence interval is [67.8, 76.8].</p>
</blockquote>
<p>where <span class="math inline">\(t(19)\)</span> is shorthand notation for a <span class="math inline">\(t\)</span>-statistic that has 19 degrees of freedom. That said, it’s often the case that people don’t report the confidence interval, or do so using a much more compressed form than I’ve done here. For instance, it’s not uncommon to see the confidence interval included as part of the stat block, like this:</p>
<blockquote>
<p><span class="math inline">\(t(19) = 2.25\)</span>, <span class="math inline">\(p&lt;.05\)</span>, CI<span class="math inline">\(_{95} = [67.8, 76.8]\)</span></p>
</blockquote>
<p>With that much jargon crammed into half a line, you know it must be really smart.<a href="#fn189" class="footnoteRef" id="fnref189"><sup>189</sup></a></p>
</div>
<div id="ttestoneassumptions" class="section level3">
<h3><span class="header-section-number">13.2.3</span> Assumptions of the one sample <span class="math inline">\(t\)</span>-test</h3>
<p>Okay, so what assumptions does the one-sample <span class="math inline">\(t\)</span>-test make? Well, since the <span class="math inline">\(t\)</span>-test is basically a <span class="math inline">\(z\)</span>-test with the assumption of known standard deviation removed, you shouldn’t be surprised to see that it makes the same assumptions as the <span class="math inline">\(z\)</span>-test, minus the one about the known standard deviation. That is</p>
<ul>
<li><em>Normality</em>. We’re still assuming that the the population distribution is normal^[A technical comment… in the same way that we can weaken the assumptions of the <span class="math inline">\(z\)</span>-test so that we’re only talking about the sampling distribution, we <em>can</em> weaken the <span class="math inline">\(t\)</span> test assumptions so that we don’t have to assume normality of the population. However, for the <span class="math inline">\(t\)</span>-test, it’s trickier to do this. As before, we can replace the assumption of population normality with an assumption that the sampling distribution of <span class="math inline">\(\bar{X}\)</span> is normal. However, remember that we’re also relying on a sample estimate of the standard deviation; and so we also require the sampling distribution of <span class="math inline">\(\hat{\sigma}\)</span> to be chi-square. That makes things nastier, and this version is rarely used in practice: fortunately, if the population is normal, then both of these two assumptions are met., and as noted earlier, there are standard tools that you can use to check to see if this assumption is met (Section <a href="ttest.html#shapiro">13.9</a>), and other tests you can do in it’s place if this assumption is violated (Section <a href="ttest.html#wilcox">13.10</a>).</li>
<li><em>Independence</em>. Once again, we have to assume that the observations in our sample are generated independently of one another. See the earlier discussion about the <span class="math inline">\(z\)</span>-test for specifics (Section <a href="ttest.html#zassumptions">13.1.4</a>).</li>
</ul>
<p>Overall, these two assumptions aren’t terribly unreasonable, and as a consequence the one-sample <span class="math inline">\(t\)</span>-test is pretty widely used in practice as a way of comparing a sample mean against a hypothesised population mean.</p>
</div>
</div>
<div id="studentttest" class="section level2">
<h2><span class="header-section-number">13.3</span> The independent samples <span class="math inline">\(t\)</span>-test (Student test)</h2>
<p>Although the one sample <span class="math inline">\(t\)</span>-test has its uses, it’s not the most typical example of a <span class="math inline">\(t\)</span>-test<a href="#fn190" class="footnoteRef" id="fnref190"><sup>190</sup></a>. A much more common situation arises when you’ve got two different groups of observations. In psychology, this tends to correspond to two different groups of participants, where each group corresponds to a different condition in your study. For each person in the study, you measure some outcome variable of interest, and the research question that you’re asking is whether or not the two groups have the same population mean. This is the situation that the independent samples <span class="math inline">\(t\)</span>-test is designed for.</p>
<div id="the-data-1" class="section level3">
<h3><span class="header-section-number">13.3.1</span> The data</h3>
<p>Suppose we have 33 students taking Dr Harpo’s statistics lectures, and Dr Harpo doesn’t grade to a curve. Actually, Dr Harpo’s grading is a bit of a mystery, so we don’t really know anything about what the average grade is for the class as a whole. There are two tutors for the class, Anastasia and Bernadette. There are <span class="math inline">\(N_1 = 15\)</span> students in Anastasia’s tutorials, and <span class="math inline">\(N_2 = 18\)</span> in Bernadette’s tutorials. The research question I’m interested in is whether Anastasia or Bernadette is a better tutor, or if it doesn’t make much of a difference. Dr Harpo emails me the course grades, in the <code>harpo.Rdata</code> file. As usual, I’ll load the file and have a look at what variables it contains:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span> (<span class="kw">file.path</span>(projecthome, <span class="st">&quot;data/harpo.Rdata&quot;</span> ))
<span class="kw">str</span>(harpo)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    33 obs. of  2 variables:
##  $ grade: num  65 72 66 74 73 71 66 76 69 79 ...
##  $ tutor: Factor w/ 2 levels &quot;Anastasia&quot;,&quot;Bernadette&quot;: 1 2 2 1 1 2 2 2 2 2 ...</code></pre>
<p>As we can see, there’s a single data frame with two variables, <code>grade</code> and <code>tutor</code>. The <code>grade</code> variable is a numeric vector, containing the grades for all <span class="math inline">\(N = 33\)</span> students taking Dr Harpo’s class; the <code>tutor</code> variable is a factor that indicates who each student’s tutor was. The first six observations in this data set are shown below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>( harpo )</code></pre></div>
<pre><code>##   grade      tutor
## 1    65  Anastasia
## 2    72 Bernadette
## 3    66 Bernadette
## 4    74  Anastasia
## 5    73  Anastasia
## 6    71 Bernadette</code></pre>
<p>We can calculate means and standard deviations, using the <code>mean()</code> and <code>sd()</code> functions. Rather than show the R output, here’s a nice little summary table:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">mean</th>
<th align="center">std dev</th>
<th align="center">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Anastasia’s students</td>
<td align="center">74.53</td>
<td align="center">9.00</td>
<td align="center">15</td>
</tr>
<tr class="even">
<td>Bernadette’s students</td>
<td align="center">69.06</td>
<td align="center">5.77</td>
<td align="center">18</td>
</tr>
</tbody>
</table>
<p>To give you a more detailed sense of what’s going on here, I’ve plotted histograms showing the distribution of grades for both tutors (Figure <a href="ttest.html#fig:harpohistanastasia">13.6</a> and <a href="ttest.html#fig:harpohistbernadette">13.7</a>). Inspection of these histograms suggests that the students in Anastasia’s class may be getting slightly better grades on average, though they also seem a little more variable.</p>
<div class="figure"><span id="fig:harpohistanastasia"></span>
<img src="lsr_files/figure-html/harpohistanastasia-1.png" alt="Histogram showing the overall distribution of grades for students in Anastasia's class" width="672" />
<p class="caption">
Figure 13.6: Histogram showing the overall distribution of grades for students in Anastasia’s class
</p>
</div>
<div class="figure"><span id="fig:harpohistbernadette"></span>
<img src="lsr_files/figure-html/harpohistbernadette-1.png" alt="Histogram showing the overall distribution of grades for students in Bernadette's class" width="672" />
<p class="caption">
Figure 13.7: Histogram showing the overall distribution of grades for students in Bernadette’s class
</p>
</div>
<p>Here is a simpler plot showing the means and corresponding confidence intervals for both groups of students (Figure <a href="ttest.html#fig:ttestci">13.8</a>).</p>
<div class="figure"><span id="fig:ttestci"></span>
<img src="C:/Users/pcmis/Documents/rbook/bookdown/img/ttest2/ttestci.png" alt="Plots showing the mean grade for the students in Anastasia's and Bernadette's tutorials. Error bars depict 95% confidence intervals around the mean. On the basis of visual inspection, it does look like there's a real difference between the groups, though it's hard to say for sure."  />
<p class="caption">
Figure 13.8: Plots showing the mean grade for the students in Anastasia’s and Bernadette’s tutorials. Error bars depict 95% confidence intervals around the mean. On the basis of visual inspection, it does look like there’s a real difference between the groups, though it’s hard to say for sure.
</p>
</div>
</div>
<div id="introducing-the-test" class="section level3">
<h3><span class="header-section-number">13.3.2</span> Introducing the test</h3>
<p>The <strong><em>independent samples <span class="math inline">\(t\)</span>-test</em></strong> comes in two different forms, Student’s and Welch’s. The original Student <span class="math inline">\(t\)</span>-test – which is the one I’ll describe in this section – is the simpler of the two, but relies on much more restrictive assumptions than the Welch <span class="math inline">\(t\)</span>-test. Assuming for the moment that you want to run a two-sided test, the goal is to determine whether two “independent samples” of data are drawn from populations with the same mean (the null hypothesis) or different means (the alternative hypothesis). When we say “independent” samples, what we really mean here is that there’s no special relationship between observations in the two samples. This probably doesn’t make a lot of sense right now, but it will be clearer when we come to talk about the paired samples <span class="math inline">\(t\)</span>-test later on. For now, let’s just point out that if we have an experimental design where participants are randomly allocated to one of two groups, and we want to compare the two groups’ mean performance on some outcome measure, then an independent samples <span class="math inline">\(t\)</span>-test (rather than a paired samples <span class="math inline">\(t\)</span>-test) is what we’re after.</p>
<p>Okay, so let’s let <span class="math inline">\(\mu_1\)</span> denote the true population mean for group 1 (e.g., Anastasia’s students), and <span class="math inline">\(\mu_2\)</span> will be the true population mean for group 2 (e.g., Bernadette’s students),<a href="#fn191" class="footnoteRef" id="fnref191"><sup>191</sup></a> and as usual we’ll let <span class="math inline">\(\bar{X}_1\)</span> and <span class="math inline">\(\bar{X}_2\)</span> denote the observed sample means for both of these groups. Our null hypothesis states that the two population means are identical (<span class="math inline">\(\mu_1 = \mu_2\)</span>) and the alternative to this is that they are not (<span class="math inline">\(\mu_1 \neq \mu_2\)</span>). Written in mathematical-ese, this is… <span class="math display">\[
\begin{array}{ll}
H_0: &amp; \mu_1 = \mu_2  \\
H_1: &amp; \mu_1 \neq \mu_2
\end{array}
\]</span></p>
<div class="figure"><span id="fig:ttesthyp"></span>
<img src="lsr_files/figure-html/ttesthyp-1.png" alt="Graphical illustration of the null and alternative hypotheses assumed by the Student $t$-test. The null hypothesis assumes that both groups have the same mean $\mu$, whereas the alternative assumes that they have different means $\mu_1$ and $\mu_2$. Notice that it is assumed that the population distributions are normal, and that, although the alternative hypothesis allows the group to have different means, it assumes they have the same standard deviation" width="672" />
<p class="caption">
Figure 13.9: Graphical illustration of the null and alternative hypotheses assumed by the Student <span class="math inline">\(t\)</span>-test. The null hypothesis assumes that both groups have the same mean <span class="math inline">\(\mu\)</span>, whereas the alternative assumes that they have different means <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span>. Notice that it is assumed that the population distributions are normal, and that, although the alternative hypothesis allows the group to have different means, it assumes they have the same standard deviation
</p>
</div>
<p>To construct a hypothesis test that handles this scenario, we start by noting that if the null hypothesis is true, then the difference between the population means is <em>exactly</em> zero, <span class="math inline">\(\mu_1 - \mu_2 = 0\)</span> As a consequence, a diagnostic test statistic will be based on the difference between the two sample means. Because if the null hypothesis is true, then we’d expect <span class="math display">\[
\bar{X}_1 - \bar{X}_2
\]</span> to be <em>pretty close</em> to zero. However, just like we saw with our one-sample tests (i.e., the one-sample <span class="math inline">\(z\)</span>-test and the one-sample <span class="math inline">\(t\)</span>-test) we have to be precise about exactly <em>how close</em> to zero this difference should be. And the solution to the problem is more or less the same one: we calculate a standard error estimate (SE), just like last time, and then divide the difference between means by this estimate. So our <strong><em><span class="math inline">\(t\)</span>-statistic</em></strong> will be of the form <span class="math display">\[
t = \frac{\bar{X}_1 - \bar{X}_2}{\mbox{SE}}
\]</span> We just need to figure out what this standard error estimate actually is. This is a bit trickier than was the case for either of the two tests we’ve looked at so far, so we need to go through it a lot more carefully to understand how it works.</p>
</div>
<div id="a-pooled-estimate-of-the-standard-deviation" class="section level3">
<h3><span class="header-section-number">13.3.3</span> A “pooled estimate” of the standard deviation</h3>
<p>In the original “Student <span class="math inline">\(t\)</span>-test”, we make the assumption that the two groups have the same population standard deviation: that is, regardless of whether the population means are the same, we assume that the population standard deviations are identical, <span class="math inline">\(\sigma_1 = \sigma_2\)</span>. Since we’re assuming that the two standard deviations are the same, we drop the subscripts and refer to both of them as <span class="math inline">\(\sigma\)</span>. How should we estimate this? How should we construct a single estimate of a standard deviation when we have two samples? The answer is, basically, we average them. Well, sort of. Actually, what we do is take a <em>weighed</em> average of the <em>variance</em> estimates, which we use as our <strong><em>pooled estimate of the variance</em></strong>. The weight assigned to each sample is equal to the number of observations in that sample, minus 1. Mathematically, we can write this as <span class="math display">\[
\begin{array}{rcl}
w_1 &amp;=&amp; N_1 - 1\\
w_2 &amp;=&amp; N_2 - 1
\end{array}
\]</span> Now that we’ve assigned weights to each sample, we calculate the pooled estimate of the variance by taking the weighted average of the two variance estimates, <span class="math inline">\({\hat\sigma_1}^2\)</span> and <span class="math inline">\({\hat\sigma_2}^2\)</span> <span class="math display">\[
\hat\sigma^2_p = \frac{w_1 {\hat\sigma_1}^2 + w_2 {\hat\sigma_2}^2}{w_1 + w_2}
\]</span> Finally, we convert the pooled variance estimate to a pooled standard deviation estimate, by taking the square root. This gives us the following formula for <span class="math inline">\(\hat\sigma_p\)</span>, <span class="math display">\[
\hat\sigma_p = \sqrt{\frac{w_1 {\hat\sigma_1}^2 + w_2 {\hat\sigma_2}^2}{w_1 + w_2}}
\]</span> And if you mentally substitute <span class="math inline">\(w_1 = N_1 -1\)</span> and <span class="math inline">\(w_2 = N_2 -1\)</span> into this equation you get a very ugly looking formula; a very ugly formula that actually seems to be the “standard” way of describing the pooled standard deviation estimate. It’s not my favourite way of thinking about pooled standard deviations, however.<a href="#fn192" class="footnoteRef" id="fnref192"><sup>192</sup></a></p>
</div>
<div id="the-same-pooled-estimate-described-differently" class="section level3">
<h3><span class="header-section-number">13.3.4</span> The same pooled estimate, described differently</h3>
<p>I prefer to think about it like this. Our data set actually corresponds to a set of <span class="math inline">\(N\)</span> observations, which are sorted into two groups. So let’s use the notation <span class="math inline">\(X_{ik}\)</span> to refer to the grade received by the <span class="math inline">\(i\)</span>-th student in the <span class="math inline">\(k\)</span>-th tutorial group: that is, <span class="math inline">\(X_{11}\)</span> is the grade received by the first student in Anastasia’s class, <span class="math inline">\(X_{21}\)</span> is her second student, and so on. And we have two separate group means <span class="math inline">\(\bar{X}_1\)</span> and <span class="math inline">\(\bar{X}_2\)</span>, which we could “generically” refer to using the notation <span class="math inline">\(\bar{X}_k\)</span>, i.e., the mean grade for the <span class="math inline">\(k\)</span>-th tutorial group. So far, so good. Now, since every single student falls into one of the two tutorials, and so we can describe their deviation from the group mean as the difference <span class="math display">\[
X_{ik} - \bar{X}_k
\]</span> So why not just use these deviations (i.e., the extent to which each student’s grade differs from the mean grade in their tutorial?) Remember, a variance is just the average of a bunch of squared deviations, so let’s do that. Mathematically, we could write it like this: <span class="math display">\[
\frac{\sum_{ik} \left( X_{ik} - \bar{X}_k \right)^2}{N}
\]</span> where the notation “<span class="math inline">\(\sum_{ik}\)</span>” is a lazy way of saying “calculate a sum by looking at all students in all tutorials”, since each “<span class="math inline">\(ik\)</span>” corresponds to one student.<a href="#fn193" class="footnoteRef" id="fnref193"><sup>193</sup></a> But, as we saw in Chapter <a href="estimation.html#estimation">10</a>, calculating the variance by dividing by <span class="math inline">\(N\)</span> produces a biased estimate of the population variance. And previously, we needed to divide by <span class="math inline">\(N-1\)</span> to fix this. However, as I mentioned at the time, the reason why this bias exists is because the variance estimate relies on the sample mean; and to the extent that the sample mean isn’t equal to the population mean, it can systematically bias our estimate of the variance. But this time we’re relying on <em>two</em> sample means! Does this mean that we’ve got more bias? Yes, yes it does. And does this mean we now need to divide by <span class="math inline">\(N-2\)</span> instead of <span class="math inline">\(N-1\)</span>, in order to calculate our pooled variance estimate? Why, yes… <span class="math display">\[
\hat\sigma^2_p = \frac{\sum_{ik} \left( X_{ik} - \bar{X}_k \right)^2}{N -2}
\]</span> Oh, and if you take the square root of this then you get <span class="math inline">\(\hat{\sigma}_p\)</span>, the pooled standard deviation estimate. In other words, the pooled standard deviation calculation is nothing special: it’s not terribly different to the regular standard deviation calculation.</p>
</div>
<div id="completing-the-test" class="section level3">
<h3><span class="header-section-number">13.3.5</span> Completing the test</h3>
<p>Regardless of which way you want to think about it, we now have our pooled estimate of the standard deviation. From now on, I’ll drop the silly <span class="math inline">\(p\)</span> subscript, and just refer to this estimate as <span class="math inline">\(\hat\sigma\)</span>. Great. Let’s now go back to thinking about the bloody hypothesis test, shall we? Our whole reason for calculating this pooled estimate was that we knew it would be helpful when calculating our <em>standard error</em> estimate. But, standard error of <em>what</em>? In the one-sample <span class="math inline">\(t\)</span>-test, it was the standard error of the sample mean, <span class="math inline">\(\mbox{SE}({\bar{X}})\)</span>, and since <span class="math inline">\(\mbox{SE}({\bar{X}}) = \sigma / \sqrt{N}\)</span> that’s what the denominator of our <span class="math inline">\(t\)</span>-statistic looked like. This time around, however, we have <em>two</em> sample means. And what we’re interested in, specifically, is the the difference between the two <span class="math inline">\(\bar{X}_1 - \bar{X}_2\)</span>. As a consequence, the standard error that we need to divide by is in fact the <strong><em>standard error of the difference</em></strong> between means. As long as the two variables really do have the same standard deviation, then our estimate for the standard error is <span class="math display">\[
\mbox{SE}({\bar{X}_1 - \bar{X}_2}) = \hat\sigma \sqrt{\frac{1}{N_1} + \frac{1}{N_2}}
\]</span> and our <span class="math inline">\(t\)</span>-statistic is therefore <span class="math display">\[
t = \frac{\bar{X}_1 - \bar{X}_2}{\mbox{SE}({\bar{X}_1 - \bar{X}_2})}
\]</span> Just as we saw with our one-sample test, the sampling distribution of this <span class="math inline">\(t\)</span>-statistic is a <span class="math inline">\(t\)</span>-distribution (shocking, isn’t it?) as long as the null hypothesis is true, and all of the assumptions of the test are met. The degrees of freedom, however, is slightly different. As usual, we can think of the degrees of freedom to be equal to the number of data points minus the number of constraints. In this case, we have <span class="math inline">\(N\)</span> observations (<span class="math inline">\(N_1\)</span> in sample 1, and <span class="math inline">\(N_2\)</span> in sample 2), and 2 constraints (the sample means). So the total degrees of freedom for this test are <span class="math inline">\(N-2\)</span>.</p>
</div>
<div id="doing-the-test-in-r-1" class="section level3">
<h3><span class="header-section-number">13.3.6</span> Doing the test in R</h3>
<p>Not surprisingly, you can run an independent samples <span class="math inline">\(t\)</span>-test using the <code>t.test()</code> function (Section <a href="ttest.html#ttestfunction">13.7</a>), but once again I’m going to start with a somewhat simpler function in the <code>lsr</code> package. That function is unimaginatively called <code>independentSamplesTTest()</code>. First, recall that our data look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>( harpo )</code></pre></div>
<pre><code>##   grade      tutor
## 1    65  Anastasia
## 2    72 Bernadette
## 3    66 Bernadette
## 4    74  Anastasia
## 5    73  Anastasia
## 6    71 Bernadette</code></pre>
<p>The outcome variable for our test is the student <code>grade</code>, and the groups are defined in terms of the <code>tutor</code> for each class. So you probably won’t be too surprised to see that we’re going to describe the test that we want in terms of an R formula that reads like this <code>grade ~ tutor</code>. The specific command that we need is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">independentSamplesTTest</span>( 
      <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>tutor,  <span class="co"># formula specifying outcome and group variables</span>
      <span class="dt">data =</span> harpo,             <span class="co"># data frame that contains the variables</span>
      <span class="dt">var.equal =</span> <span class="ot">TRUE</span>          <span class="co"># assume that the two groups have the same variance</span>
  )</code></pre></div>
<pre><code>## 
##    Student&#39;s independent samples t-test 
## 
## Outcome variable:   grade 
## Grouping variable:  tutor 
## 
## Descriptive statistics: 
##             Anastasia Bernadette
##    mean        74.533     69.056
##    std dev.     8.999      5.775
## 
## Hypotheses: 
##    null:        population means equal for both groups
##    alternative: different population means in each group
## 
## Test results: 
##    t-statistic:  2.115 
##    degrees of freedom:  31 
##    p-value:  0.043 
## 
## Other information: 
##    two-sided 95% confidence interval:  [0.197, 10.759] 
##    estimated effect size (Cohen&#39;s d):  0.74</code></pre>
<p>The first two arguments should be familiar to you. The first one is the formula that tells R what variables to use and the second one tells R the name of the data frame that stores those variables. The third argument is not so obvious. By saying <code>var.equal = TRUE</code>, what we’re really doing is telling R to use the <em>Student</em> independent samples <span class="math inline">\(t\)</span>-test. More on this later. For now, lets ignore that bit and look at the output:</p>
<p>The output has a very familiar form. First, it tells you what test was run, and it tells you the names of the variables that you used. The second part of the output reports the sample means and standard deviations for both groups (i.e., both tutorial groups). The third section of the output states the null hypothesis and the alternative hypothesis in a fairly explicit form. It then reports the test results: just like last time, the test results consist of a <span class="math inline">\(t\)</span>-statistic, the degrees of freedom, and the <span class="math inline">\(p\)</span>-value. The final section reports two things: it gives you a confidence interval, and an effect size. I’ll talk about effect sizes later. The confidence interval, however, I should talk about now.</p>
<p>It’s pretty important to be clear on what this confidence interval actually refers to: it is a confidence interval for the <em>difference</em> between the group means. In our example, Anastasia’s students had an average grade of 74.5, and Bernadette’s students had an average grade of 69.1, so the difference between the two sample means is 5.4. But of course the difference between population means might be bigger or smaller than this. The confidence interval reported by the <code>independentSamplesTTest()</code> function tells you that there’s a 95% chance that the true difference between means lies between 0.2 and 10.8.</p>
<p>In any case, the difference between the two groups is significant (just barely), so we might write up the result using text like this:</p>
<blockquote>
<p>The mean grade in Anastasia’s class was 74.5% (std dev = 9.0), whereas the mean in Bernadette’s class was 69.1% (std dev = 5.8). A Student’s independent samples <span class="math inline">\(t\)</span>-test showed that this 5.4% difference was significant (<span class="math inline">\(t(31) = 2.1\)</span>, <span class="math inline">\(p&lt;.05\)</span>, <span class="math inline">\(CI_{95} = [0.2, 10.8]\)</span>, <span class="math inline">\(d = .74\)</span>), suggesting that a genuine difference in learning outcomes has occurred.</p>
</blockquote>
<p>Notice that I’ve included the confidence interval and the effect size in the stat block. People don’t always do this. At a bare minimum, you’d expect to see the <span class="math inline">\(t\)</span>-statistic, the degrees of freedom and the <span class="math inline">\(p\)</span> value. So you should include something like this at a minimum: <span class="math inline">\(t(31) = 2.1\)</span>, <span class="math inline">\(p&lt;.05\)</span>. If statisticians had their way, everyone would also report the confidence interval and probably the effect size measure too, because they are useful things to know. But real life doesn’t always work the way statisticians want it to: you should make a judgment based on whether you think it will help your readers, and (if you’re writing a scientific paper) the editorial standard for the journal in question. Some journals expect you to report effect sizes, others don’t. Within some scientific communities it is standard practice to report confidence intervals, in other it is not. You’ll need to figure out what your audience expects. But, just for the sake of clarity, if you’re taking my class: my default position is that it’s usually worth includng the effect size, but don’t worry about the confidence interval unless the assignment asks you to or implies that you should.</p>
</div>
<div id="positive-and-negative-t-values" class="section level3">
<h3><span class="header-section-number">13.3.7</span> Positive and negative <span class="math inline">\(t\)</span> values</h3>
<p>Before moving on to talk about the assumptions of the <span class="math inline">\(t\)</span>-test, there’s one additional point I want to make about the use of <span class="math inline">\(t\)</span>-tests in practice. The first one relates to the sign of the <span class="math inline">\(t\)</span>-statistic (that is, whether it is a positive number or a negative one). One very common worry that students have when they start running their first <span class="math inline">\(t\)</span>-test is that they often end up with negative values for the <span class="math inline">\(t\)</span>-statistic, and don’t know how to interpret it. In fact, it’s not at all uncommon for two people working independently to end up with R outputs that are almost identical, except that one person has a negative <span class="math inline">\(t\)</span> values and the other one has a positive <span class="math inline">\(t\)</span> value. Assuming that you’re running a two-sided test, then the <span class="math inline">\(p\)</span>-values will be identical. On closer inspection, the students will notice that the confidence intervals also have the opposite signs. This is perfectly okay: whenever this happens, what you’ll find is that the two versions of the R output arise from slightly different ways of running the <span class="math inline">\(t\)</span>-test. What’s happening here is very simple. The <span class="math inline">\(t\)</span>-statistic that R is calculating here is always of the form <span class="math display">\[
t = \frac{\mbox{(mean 1)} -\mbox{(mean 2)}}{ \mbox{(SE)}}
\]</span> If “mean 1” is larger than “mean 2” the <span class="math inline">\(t\)</span> statistic will be positive, whereas if “mean 2” is larger then the <span class="math inline">\(t\)</span> statistic will be negative. Similarly, the confidence interval that R reports is the confidence interval for the difference “(mean 1) minus (mean 2)”, which will be the reverse of what you’d get if you were calculating the confidence interval for the difference “(mean 2) minus (mean 1)”.</p>
<p>Okay, that’s pretty straightforward when you think about it, but now consider our <span class="math inline">\(t\)</span>-test comparing Anastasia’s class to Bernadette’s class. Which one should we call “mean 1” and which one should we call “mean 2”. It’s arbitrary. However, you really do need to designate one of them as “mean 1” and the other one as “mean 2”. Not surprisingly, the way that R handles this is also pretty arbitrary. In earlier versions of the book I used to try to explain it, but after a while I gave up, because it’s not really all that important, and to be honest I can never remember myself. Whenever I get a significant <span class="math inline">\(t\)</span>-test result, and I want to figure out which mean is the larger one, I don’t try to figure it out by looking at the <span class="math inline">\(t\)</span>-statistic. Why would I bother doing that? It’s foolish. It’s easier just look at the actual group means, since the R output actually shows them!</p>
<p>Here’s the important thing. Because it really doesn’t matter what R printed out, I usually try to <em>report</em> the <span class="math inline">\(t\)</span>-statistic in such a way that the numbers match up with the text. Here’s what I mean… suppose that what I want to write in my report is “Anastasia’s class had higher grades than Bernadette’s class”. The phrasing here implies that Anastasia’s group comes first, so it makes sense to report the <span class="math inline">\(t\)</span>-statistic as if Anastasia’s class corresponded to group 1. If so, I would write</p>
<blockquote>
<p>Anastasia’s class had <em>higher</em> grades than Bernadette’s class (<span class="math inline">\(t(31)= 2.1, p=.04\)</span>).</p>
</blockquote>
<p>(I wouldn’t actually emphasise the word “higher” in real life, I’m just doing it to emphasise the point that “higher” corresponds to positive <span class="math inline">\(t\)</span> values). On the other hand, suppose the phrasing I wanted to use has Bernadette’s class listed first. If so, it makes more sense to treat her class as group 1, and if so, the write up looks like this:</p>
<blockquote>
<p>Bernadette’s class had <em>lower</em> grades than Anastasia’s class (<span class="math inline">\(t(31)= -2.1, p=.04\)</span>).</p>
</blockquote>
<p>Because I’m talking about one group having “lower” scores this time around, it is more sensible to use the negative form of the <span class="math inline">\(t\)</span>-statistic. It just makes it read more cleanly.</p>
<p>One last thing: please note that you <em>can’t</em> do this for other types of test statistics. It works for <span class="math inline">\(t\)</span>-tests, but it wouldn’t be meaningful for chi-square testsm <span class="math inline">\(F\)</span>-tests or indeed for most of the tests I talk about in this book. So don’t overgeneralise this advice! I’m really just talking about <span class="math inline">\(t\)</span>-tests here and nothing else!</p>
</div>
<div id="studentassumptions" class="section level3">
<h3><span class="header-section-number">13.3.8</span> Assumptions of the test</h3>
<p>As always, our hypothesis test relies on some assumptions. So what are they? For the Student t-test there are three assumptions, some of which we saw previously in the context of the one sample <span class="math inline">\(t\)</span>-test (see Section <a href="ttest.html#ttestoneassumptions">13.2.3</a>):</p>
<ul>
<li><em>Normality</em>. Like the one-sample <span class="math inline">\(t\)</span>-test, it is assumed that the data are normally distributed. Specifically, we assume that both groups are normally distributed. In Section <a href="ttest.html#shapiro">13.9</a> we’ll discuss how to test for normality, and in Section <a href="ttest.html#wilcox">13.10</a> we’ll discuss possible solutions.</li>
<li><em>Independence</em>. Once again, it is assumed that the observations are independently sampled. In the context of the Student test this has two aspects to it. Firstly, we assume that the observations within each sample are independent of one another (exactly the same as for the one-sample test). However, we also assume that there are no cross-sample dependencies. If, for instance, it turns out that you included some participants in both experimental conditions of your study (e.g., by accidentally allowing the same person to sign up to different conditions), then there are some cross sample dependencies that you’d need to take into account.</li>
<li><em>Homogeneity of variance</em> (also called “homoscedasticity”). The third assumption is that the population standard deviation is the same in both groups. You can test this assumption using the Levene test, which I’ll talk about later on in the book (Section <a href="anova.html#levene">14.7</a>). However, there’s a very simple remedy for this assumption, which I’ll talk about in the next section.</li>
</ul>
</div>
</div>
<div id="welchttest" class="section level2">
<h2><span class="header-section-number">13.4</span> The independent samples <span class="math inline">\(t\)</span>-test (Welch test)</h2>
<p>The biggest problem with using the Student test in practice is the third assumption listed in the previous section: it assumes that both groups have the same standard deviation. This is rarely true in real life: if two samples don’t have the same means, why should we expect them to have the same standard deviation? There’s really no reason to expect this assumption to be true. We’ll talk a little bit about how you can check this assumption later on because it does crop up in a few different places, not just the <span class="math inline">\(t\)</span>-test. But right now I’ll talk about a different form of the <span class="math inline">\(t\)</span>-test <span class="citation">(Welch <a href="#ref-Welch1947">1947</a>)</span> that does not rely on this assumption. A graphical illustration of what the <strong><em>Welch <span class="math inline">\(t\)</span> test</em></strong> assumes about the data is shown in Figure <a href="ttest.html#fig:ttesthyp2">13.10</a>, to provide a contrast with the Student test version in Figure <a href="ttest.html#fig:ttesthyp">13.9</a>. I’ll admit it’s a bit odd to talk about the cure before talking about the diagnosis, but as it happens the Welch test is the default <span class="math inline">\(t\)</span>-test in R, so this is probably the best place to discuss it.</p>
<p>The Welch test is very similar to the Student test. For example, the <span class="math inline">\(t\)</span>-statistic that we use in the Welch test is calculated in much the same way as it is for the Student test. That is, we take the difference between the sample means, and then divide it by some estimate of the standard error of that difference: <span class="math display">\[
t = \frac{\bar{X}_1 - \bar{X}_2}{\mbox{SE}({\bar{X}_1 - \bar{X}_2})}
\]</span> The main difference is that the standard error calculations are different. If the two populations have different standard deviations, then it’s a complete nonsense to try to calculate a pooled standard deviation estimate, because you’re averaging apples and oranges.<a href="#fn194" class="footnoteRef" id="fnref194"><sup>194</sup></a> But you can still estimate the standard error of the difference between sample means; it just ends up looking different: <span class="math display">\[
\mbox{SE}({\bar{X}_1 - \bar{X}_2}) = \sqrt{ \frac{{\hat{\sigma}_1}^2}{N_1} + \frac{{\hat{\sigma}_2}^2}{N_2} }
\]</span> The reason why it’s calculated this way is beyond the scope of this book. What matters for our purposes is that the <span class="math inline">\(t\)</span>-statistic that comes out of the Welch test is actually somewhat different to the one that comes from the Student test.</p>
<p>The second difference between Welch and Student is that the degrees of freedom are calculated in a very different way. In the Welch test, the “degrees of freedom” doesn’t have to be a whole number any more, and it doesn’t correspond all that closely to the “number of data points minus the number of constraints” heuristic that I’ve been using up to this point. The degrees of freedom are, in fact… <span class="math display">\[
\mbox{df} = \frac{ ({\hat{\sigma}_1}^2 / N_1 + {\hat{\sigma}_2}^2 / N_2)^2 }{  ({\hat{\sigma}_1}^2 / N_1)^2 / (N_1 -1 )  + ({\hat{\sigma}_2}^2 / N_2)^2 / (N_2 -1 ) } 
\]</span> … which is all pretty straightforward and obvious, right? Well, perhaps not. It doesn’t really matter for out purposes. What matters is that you’ll see that the “df” value that pops out of a Welch test tends to be a little bit smaller than the one used for the Student test, and it doesn’t have to be a whole number.</p>
<div class="figure"><span id="fig:ttesthyp2"></span>
<img src="lsr_files/figure-html/ttesthyp2-1.png" alt="Graphical illustration of the null and alternative hypotheses assumed by the Welch $t$-test. Like the Student test we assume that both samples are drawn from a normal population; but the alternative hypothesis no longer requires the two populations to have equal variance." width="672" />
<p class="caption">
Figure 13.10: Graphical illustration of the null and alternative hypotheses assumed by the Welch <span class="math inline">\(t\)</span>-test. Like the Student test we assume that both samples are drawn from a normal population; but the alternative hypothesis no longer requires the two populations to have equal variance.
</p>
</div>
<div id="doing-the-test-in-r-2" class="section level3">
<h3><span class="header-section-number">13.4.1</span> Doing the test in R</h3>
<p>To run a Welch test in R is pretty easy. All you have to do is not bother telling R to assume equal variances. That is, you take the command we used to run a Student’s <span class="math inline">\(t\)</span>-test and drop the <code>var.equal = TRUE</code> bit. So the command for a Welch test becomes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">independentSamplesTTest</span>( 
      <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>tutor,  <span class="co"># formula specifying outcome and group variables</span>
      <span class="dt">data =</span> harpo              <span class="co"># data frame that contains the variables</span>
  )</code></pre></div>
<pre><code>## 
##    Welch&#39;s independent samples t-test 
## 
## Outcome variable:   grade 
## Grouping variable:  tutor 
## 
## Descriptive statistics: 
##             Anastasia Bernadette
##    mean        74.533     69.056
##    std dev.     8.999      5.775
## 
## Hypotheses: 
##    null:        population means equal for both groups
##    alternative: different population means in each group
## 
## Test results: 
##    t-statistic:  2.034 
##    degrees of freedom:  23.025 
##    p-value:  0.054 
## 
## Other information: 
##    two-sided 95% confidence interval:  [-0.092, 11.048] 
##    estimated effect size (Cohen&#39;s d):  0.724</code></pre>
<p>Not too difficult, right? Not surprisingly, the output has exactly the same format as it did last time too:</p>
<p>The very first line is different, because it’s telling you that its run a Welch test rather than a Student test, and of course all the numbers are a bit different. But I hope that the interpretation of this output should be fairly obvious. You read the output in the same way that you would for the Student test. You’ve got your descriptive statistics, the hypotheses, the test results and some other information. So that’s all pretty easy.</p>
<p>Except, except… our result isn’t significant anymore. When we ran the Student test, we did get a significant effect; but the Welch test on the same data set is not (<span class="math inline">\(t(23.03) = 2.03\)</span>, <span class="math inline">\(p = .054\)</span>). What does this mean? Should we panic? Is the sky burning? Probably not. The fact that one test is significant and the other isn’t doesn’t itself mean very much, especially since I kind of rigged the data so that this would happen. As a general rule, it’s not a good idea to go out of your way to try to interpret or explain the difference between a <span class="math inline">\(p\)</span>-value of .049 and a <span class="math inline">\(p\)</span>-value of .051. If this sort of thing happens in real life, the <em>difference</em> in these <span class="math inline">\(p\)</span>-values is almost certainly due to chance. What does matter is that you take a little bit of care in thinking about what test you use. The Student test and the Welch test have different strengths and weaknesses. If the two populations really do have equal variances, then the Student test is slightly more powerful (lower Type II error rate) than the Welch test. However, if they <em>don’t</em> have the same variances, then the assumptions of the Student test are violated and you may not be able to trust it: you might end up with a higher Type I error rate. So it’s a trade off. However, in real life, I tend to prefer the Welch test; because almost no-one <em>actually</em> believes that the population variances are identical.</p>
</div>
<div id="assumptions-of-the-test" class="section level3">
<h3><span class="header-section-number">13.4.2</span> Assumptions of the test</h3>
<p>The assumptions of the Welch test are very similar to those made by the Student <span class="math inline">\(t\)</span>-test (see Section <a href="ttest.html#studentassumptions">13.3.8</a>), except that the Welch test does not assume homogeneity of variance. This leaves only the assumption of normality, and the assumption of independence. The specifics of these assumptions are the same for the Welch test as for the Student test.</p>
</div>
</div>
<div id="pairedsamplesttest" class="section level2">
<h2><span class="header-section-number">13.5</span> The paired-samples <span class="math inline">\(t\)</span>-test</h2>
<p>Regardless of whether we’re talking about the Student test or the Welch test, an independent samples <span class="math inline">\(t\)</span>-test is intended to be used in a situation where you have two samples that are, well, independent of one another. This situation arises naturally when participants are assigned randomly to one of two experimental conditions, but it provides a very poor approximation to other sorts of research designs. In particular, a repeated measures design – in which each participant is measured (with respect to the same outcome variable) in both experimental conditions – is not suited for analysis using independent samples <span class="math inline">\(t\)</span>-tests. For example, we might be interested in whether listening to music reduces people’s working memory capacity. To that end, we could measure each person’s working memory capacity in two conditions: with music, and without music. In an experimental design such as this one,<a href="#fn195" class="footnoteRef" id="fnref195"><sup>195</sup></a> each participant appears in <em>both</em> groups. This requires us to approach the problem in a different way; by using the <strong><em>paired samples <span class="math inline">\(t\)</span>-test</em></strong>.</p>
<div id="the-data-2" class="section level3">
<h3><span class="header-section-number">13.5.1</span> The data</h3>
<p>The data set that we’ll use this time comes from Dr Chico’s class.<a href="#fn196" class="footnoteRef" id="fnref196"><sup>196</sup></a> In her class, students take two major tests, one early in the semester and one later in the semester. To hear her tell it, she runs a very hard class, one that most students find very challenging; but she argues that by setting hard assessments, students are encouraged to work harder. Her theory is that the first test is a bit of a “wake up call” for students: when they realise how hard her class really is, they’ll work harder for the second test and get a better mark. Is she right? To test this, let’s have a look at the <code>chico.Rdata</code> file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>( <span class="kw">file.path</span>(projecthome, <span class="st">&quot;data/chico.Rdata&quot;</span> ))
<span class="kw">str</span>(chico)     </code></pre></div>
<pre><code>## &#39;data.frame&#39;:    20 obs. of  3 variables:
##  $ id         : Factor w/ 20 levels &quot;student1&quot;,&quot;student10&quot;,..: 1 12 14 15 16 17 18 19 20 2 ...
##  $ grade_test1: num  42.9 51.8 71.7 51.6 63.5 58 59.8 50.8 62.5 61.9 ...
##  $ grade_test2: num  44.6 54 72.3 53.4 63.8 59.3 60.8 51.6 64.3 63.2 ...</code></pre>
<p>The data frame <code>chico</code> contains three variables: an <code>id</code> variable that identifies each student in the class, the <code>grade_test1</code> variable that records the student grade for the first test, and the <code>grade_test2</code> variable that has the grades for the second test. Here’s the first six students:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>( chico )</code></pre></div>
<pre><code>##         id grade_test1 grade_test2
## 1 student1        42.9        44.6
## 2 student2        51.8        54.0
## 3 student3        71.7        72.3
## 4 student4        51.6        53.4
## 5 student5        63.5        63.8
## 6 student6        58.0        59.3</code></pre>
<p>At a glance, it does seem like the class is a hard one (most grades are between 50% and 60%), but it does look like there’s an improvement from the first test to the second one. If we take a quick look at the descriptive statistics</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>( psych )
<span class="kw">describe</span>( chico )</code></pre></div>
<pre><code>##             vars  n  mean   sd median trimmed  mad  min  max range  skew
## id*            1 20 10.50 5.92   10.5   10.50 7.41  1.0 20.0  19.0  0.00
## grade_test1    2 20 56.98 6.62   57.7   56.92 7.71 42.9 71.7  28.8  0.05
## grade_test2    3 20 58.38 6.41   59.7   58.35 6.45 44.6 72.3  27.7 -0.05
##             kurtosis   se
## id*            -1.38 1.32
## grade_test1    -0.35 1.48
## grade_test2    -0.39 1.43</code></pre>
<p>we see that this impression seems to be supported. Across all 20 students<a href="#fn197" class="footnoteRef" id="fnref197"><sup>197</sup></a> the mean grade for the first test is 57%, but this rises to 58% for the second test. Although, given that the standard deviations are 6.6% and 6.4% respectively, it’s starting to feel like maybe the improvement is just illusory; maybe just random variation. This impression is reinforced when you see the means and confidence intervals plotted in Figure <a href="ttest.html#fig:pairedta">13.11</a>. If we were to rely on this plot alone, we’d come to the same conclusion that we got from looking at the descriptive statistics that the <code>describe()</code> function produced. Looking at how wide those confidence intervals are, we’d be tempted to think that the apparent improvement in student performance is pure chance.</p>
<div class="figure"><span id="fig:pairedta"></span>
<img src="lsr_files/figure-html/pairedta-1.png" alt="Mean grade for test 1 and test 2, with associated 95% confidence intervals" width="672" />
<p class="caption">
Figure 13.11: Mean grade for test 1 and test 2, with associated 95% confidence intervals
</p>
</div>
<p>Nevertheless, this impression is wrong. To see why, take a look at the scatterplot of the grades for test 1 against the grades for test 2. shown in Figure <a href="ttest.html#fig:pairedtb">13.12</a>.</p>
<div class="figure"><span id="fig:pairedtb"></span>
<img src="lsr_files/figure-html/pairedtb-1.png" alt="Scatterplot showing the individual grades for test 1 and test 2" width="672" />
<p class="caption">
Figure 13.12: Scatterplot showing the individual grades for test 1 and test 2
</p>
</div>
<p>In this plot, each dot corresponds to the two grades for a given student: if their grade for test 1 (<span class="math inline">\(x\)</span> co-ordinate) equals their grade for test 2 (<span class="math inline">\(y\)</span> co-ordinate), then the dot falls on the line. Points falling above the line are the students that performed better on the second test. Critically, almost all of the data points fall above the diagonal line: almost all of the students <em>do</em> seem to have improved their grade, if only by a small amount. This suggests that we should be looking at the <em>improvement</em> made by each student from one test to the next, and treating that as our raw data. To do this, we’ll need to create a new variable for the <code>improvement</code> that each student makes, and add it to the <code>chico</code> data frame. The easiest way to do this is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chico<span class="op">$</span>improvement &lt;-<span class="st"> </span>chico<span class="op">$</span>grade_test2 <span class="op">-</span><span class="st"> </span>chico<span class="op">$</span>grade_test1 </code></pre></div>
<p>Notice that I assigned the output to a variable called <code>chico$improvement</code>. That has the effect of creating a new variable called <code>improvement</code> inside the <code>chico</code> data frame. So now when I look at the <code>chico</code> data frame, I get an output that looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>( chico )</code></pre></div>
<pre><code>##         id grade_test1 grade_test2 improvement
## 1 student1        42.9        44.6         1.7
## 2 student2        51.8        54.0         2.2
## 3 student3        71.7        72.3         0.6
## 4 student4        51.6        53.4         1.8
## 5 student5        63.5        63.8         0.3
## 6 student6        58.0        59.3         1.3</code></pre>
<p>Now that we’ve created and stored this <code>improvement</code> variable, we can draw a histogram showing the distribution of these improvement scores (using the <code>hist()</code> function), shown in Figure <a href="ttest.html#fig:pairedtc">13.13</a>.</p>
<div class="figure"><span id="fig:pairedtc"></span>
<img src="lsr_files/figure-html/pairedtc-1.png" alt="Histogram showing the improvement made by each student in Dr Chico's class. Notice that almost the entire distribution is above zero: the vast majority of students did improve their performance from the first test to the second one" width="672" />
<p class="caption">
Figure 13.13: Histogram showing the improvement made by each student in Dr Chico’s class. Notice that almost the entire distribution is above zero: the vast majority of students did improve their performance from the first test to the second one
</p>
</div>
<p>When we look at histogram, it’s very clear that there <em>is</em> a real improvement here. The vast majority of the students scored higher on the test 2 than on test 1, reflected in the fact that almost the entire histogram is above zero. In fact, if we use <code>ciMean()</code> to compute a confidence interval for the population mean of this new variable,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ciMean</span>( <span class="dt">x =</span> chico<span class="op">$</span>improvement )</code></pre></div>
<pre><code>##           2.5%    97.5%
## [1,] 0.9508686 1.859131</code></pre>
<p>we see that it is 95% certain that the true (population-wide) average improvement would lie between 0.95% and 1.86%. So you can see, qualitatively, what’s going on: there is a real “within student” improvement (everyone improves by about 1%), but it is very small when set against the quite large “between student” differences (student grades vary by about 20% or so).</p>
</div>
<div id="what-is-the-paired-samples-t-test" class="section level3">
<h3><span class="header-section-number">13.5.2</span> What is the paired samples <span class="math inline">\(t\)</span>-test?</h3>
<p>In light of the previous exploration, let’s think about how to construct an appropriate <span class="math inline">\(t\)</span> test. One possibility would be to try to run an independent samples <span class="math inline">\(t\)</span>-test using <code>grade_test1</code> and <code>grade_test2</code> as the variables of interest. However, this is clearly the wrong thing to do: the independent samples <span class="math inline">\(t\)</span>-test assumes that there is no particular relationship between the two samples. Yet clearly that’s not true in this case, because of the repeated measures structure to the data. To use the language that I introduced in the last section, if we were to try to do an independent samples <span class="math inline">\(t\)</span>-test, we would be conflating the <strong><em>within subject</em></strong> differences (which is what we’re interested in testing) with the <strong><em>between subject</em></strong> variability (which we are not).</p>
<p>The solution to the problem is obvious, I hope, since we already did all the hard work in the previous section. Instead of running an independent samples <span class="math inline">\(t\)</span>-test on <code>grade_test1</code> and <code>grade_test2</code>, we run a <em>one-sample</em> <span class="math inline">\(t\)</span>-test on the within-subject difference variable, <code>improvement</code>. To formalise this slightly, if <span class="math inline">\(X_{i1}\)</span> is the score that the <span class="math inline">\(i\)</span>-th participant obtained on the first variable, and <span class="math inline">\(X_{i2}\)</span> is the score that the same person obtained on the second one, then the difference score is: <span class="math display">\[
D_{i} = X_{i1} - X_{i2} 
\]</span> Notice that the difference scores is <em>variable 1 minus variable 2</em> and not the other way around, so if we want improvement to correspond to a positive valued difference, we actually want “test 2” to be our “variable 1”. Equally, we would say that <span class="math inline">\(\mu_D = \mu_1 - \mu_2\)</span> is the population mean for this difference variable. So, to convert this to a hypothesis test, our null hypothesis is that this mean difference is zero; the alternative hypothesis is that it is not: <span class="math display">\[
\begin{array}{ll}
H_0: &amp; \mu_D = 0  \\
H_1: &amp; \mu_D \neq 0
\end{array}
\]</span> (this is assuming we’re talking about a two-sided test here). This is more or less identical to the way we described the hypotheses for the one-sample <span class="math inline">\(t\)</span>-test: the only difference is that the specific value that the null hypothesis predicts is 0. And so our <span class="math inline">\(t\)</span>-statistic is defined in more or less the same way too. If we let <span class="math inline">\(\bar{D}\)</span> denote the mean of the difference scores, then <span class="math display">\[
t = \frac{\bar{D}}{\mbox{SE}({\bar{D}})}
\]</span> which is <span class="math display">\[
t = \frac{\bar{D}}{\hat\sigma_D / \sqrt{N}}
\]</span> where <span class="math inline">\(\hat\sigma_D\)</span> is the standard deviation of the difference scores. Since this is just an ordinary, one-sample <span class="math inline">\(t\)</span>-test, with nothing special about it, the degrees of freedom are still <span class="math inline">\(N-1\)</span>. And that’s it: the paired samples <span class="math inline">\(t\)</span>-test really isn’t a new test at all: it’s a one-sample <span class="math inline">\(t\)</span>-test, but applied to the difference between two variables. It’s actually very simple; the only reason it merits a discussion as long as the one we’ve just gone through is that you need to be able to recognise <em>when</em> a paired samples test is appropriate, and to understand <em>why</em> it’s better than an independent samples <span class="math inline">\(t\)</span> test.</p>
</div>
<div id="doing-the-test-in-r-part-1" class="section level3">
<h3><span class="header-section-number">13.5.3</span> Doing the test in R, part 1</h3>
<p>How do you do a paired samples <span class="math inline">\(t\)</span>-test in R. One possibility is to follow the process I outlined above: create a “difference” variable and then run a one sample <span class="math inline">\(t\)</span>-test on that. Since we’ve already created a variable called <code>chico$improvement</code>, let’s do that:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">oneSampleTTest</span>( chico<span class="op">$</span>improvement, <span class="dt">mu=</span><span class="dv">0</span> )</code></pre></div>
<pre><code>## 
##    One sample t-test 
## 
## Data variable:   chico$improvement 
## 
## Descriptive statistics: 
##             improvement
##    mean           1.405
##    std dev.       0.970
## 
## Hypotheses: 
##    null:        population mean equals 0 
##    alternative: population mean not equal to 0 
## 
## Test results: 
##    t-statistic:  6.475 
##    degrees of freedom:  19 
##    p-value:  &lt;.001 
## 
## Other information: 
##    two-sided 95% confidence interval:  [0.951, 1.859] 
##    estimated effect size (Cohen&#39;s d):  1.448</code></pre>
<p>The output here is (obviously) formatted exactly the same was as it was the last time we used the <code>oneSampleTTest()</code> function (Section <a href="ttest.html#onesamplettest">13.2</a>), and it confirms our intuition. There’s an average improvement of 1.4% from test 1 to test 2, and this is significantly different from 0 (<span class="math inline">\(t(19)=6.48, p&lt;.001\)</span>).</p>
<p>However, suppose you’re lazy and you don’t want to go to all the effort of creating a new variable. Or perhaps you just want to keep the difference between one-sample and paired-samples tests clear in your head. If so, you can use the <code>pairedSamplesTTest()</code> function, also in the <code>lsr</code> package. Let’s assume that your data organised like they are in the <code>chico</code> data frame, where there are two separate variables, one for each measurement. The way to run the test is to input a <em>one-sided</em> formula, just like you did when running a test of association using the <code>associationTest()</code> function in Chapter <a href="chisquare.html#chisquare">12</a>. For the <code>chico</code> data frame, the formula that you need would be <code>~ grade_time2 + grade_time1</code>. As usual, you’ll also need to input the name of the data frame too. So the command just looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairedSamplesTTest</span>( 
     <span class="dt">formula =</span> <span class="op">~</span><span class="st"> </span>grade_test2 <span class="op">+</span><span class="st"> </span>grade_test1, <span class="co"># one-sided formula listing the two variables</span>
     <span class="dt">data =</span> chico                           <span class="co"># data frame containing the two variables </span>
  )</code></pre></div>
<pre><code>## 
##    Paired samples t-test 
## 
## Variables:  grade_test2 , grade_test1 
## 
## Descriptive statistics: 
##             grade_test2 grade_test1 difference
##    mean          58.385      56.980      1.405
##    std dev.       6.406       6.616      0.970
## 
## Hypotheses: 
##    null:        population means equal for both measurements
##    alternative: different population means for each measurement
## 
## Test results: 
##    t-statistic:  6.475 
##    degrees of freedom:  19 
##    p-value:  &lt;.001 
## 
## Other information: 
##    two-sided 95% confidence interval:  [0.951, 1.859] 
##    estimated effect size (Cohen&#39;s d):  1.448</code></pre>
<p>The numbers are identical to those that come from the one sample test, which of course they have to be given that the paired samples <span class="math inline">\(t\)</span>-test is just a one sample test under the hood. However, the output is a bit more detailed:</p>
<p>This time around the descriptive statistics block shows you the means and standard deviations for the original variables, as well as for the difference variable (notice that it always defines the difference as the first listed variable mines the second listed one). The null hypothesis and the alternative hypothesis are now framed in terms of the original variables rather than the difference score, but you should keep in mind that in a paired samples test it’s still the difference score being tested. The statistical information at the bottom about the test result is of course the same as before.</p>
</div>
<div id="doing-the-test-in-r-part-2" class="section level3">
<h3><span class="header-section-number">13.5.4</span> Doing the test in R, part 2</h3>
<p>The paired samples <span class="math inline">\(t\)</span>-test is a little different from the other <span class="math inline">\(t\)</span>-tests, because it is used in repeated measures designs. For the <code>chico</code> data, every student is “measured” twice, once for the first test, and again for the second test. Back in Section <a href="datahandling.html#reshape">7.7</a> I talked about the fact that repeated measures data can be expressed in two standard ways, known as <em>wide form</em> and <em>long form</em>. The <code>chico</code> data frame is in wide form: every row corresponds to a unique <em>person</em>. I’ve shown you the data in that form first because that’s the form that you’re most used to seeing, and it’s also the format that you’re most likely to receive data in. However, the majority of tools in R for dealing with repeated measures data expect to receive data in long form. The paired samples <span class="math inline">\(t\)</span>-test is a bit of an exception that way.</p>
<p>As you make the transition from a novice user to an advanced one, you’re going to have to get comfortable with long form data, and switching between the two forms. To that end, I want to show you how to apply the <code>pairedSamplesTTest()</code> function to long form data. First, let’s use the <code>wideToLong()</code> function to create a long form version of the <code>chico</code> data frame. If you’ve forgotten how the <code>wideToLong()</code> function works, it might be worth your while quickly re-reading Section <a href="datahandling.html#reshape">7.7</a>. Assuming that you’ve done so, or that you’re already comfortable with data reshaping, I’ll use it to create a new data frame called <code>chico2</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chico2 &lt;-<span class="st"> </span><span class="kw">wideToLong</span>( chico, <span class="dt">within=</span><span class="st">&quot;time&quot;</span> )
<span class="kw">head</span>( chico2 )</code></pre></div>
<pre><code>##         id improvement  time grade
## 1 student1         1.7 test1  42.9
## 2 student2         2.2 test1  51.8
## 3 student3         0.6 test1  71.7
## 4 student4         1.8 test1  51.6
## 5 student5         0.3 test1  63.5
## 6 student6         1.3 test1  58.0</code></pre>
<p>As you can see, this has created a new data frame containing three variables: an <code>id</code> variable indicating which person provided the data, a <code>time</code> variable indicating which test the data refers to (i.e., test 1 or test 2), and a <code>grade</code> variable that records what score the person got on that test. Notice that this data frame is in long form: every row corresponds to a unique <em>measurement</em>. Because every person provides two observations (test 1 and test 2), there are two rows for every person. To see this a little more clearly, I’ll use the <code>sortFrame()</code> function to sort the rows of <code>chico2</code> by <code>id</code> variable (see Section <a href="datahandling.html#sortframe">7.6.3</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chico2 &lt;-<span class="st"> </span><span class="kw">sortFrame</span>( chico2, id )
<span class="kw">head</span>( chico2 )</code></pre></div>
<pre><code>##           id improvement  time grade
## 1   student1         1.7 test1  42.9
## 21  student1         1.7 test2  44.6
## 10 student10         1.3 test1  61.9
## 30 student10         1.3 test2  63.2
## 11 student11         1.4 test1  50.4
## 31 student11         1.4 test2  51.8</code></pre>
<p>As you can see, there are two rows for “student1”: one showing their grade on the first test, the other showing their grade on the second test.<a href="#fn198" class="footnoteRef" id="fnref198"><sup>198</sup></a></p>
<p>Okay, suppose that we were given the <code>chico2</code> data frame to analyse. How would we run our paired samples <span class="math inline">\(t\)</span>-test now? One possibility would be to use the <code>longToWide()</code> function (Section <a href="datahandling.html#reshape">7.7</a>) to force the data back into wide form, and do the same thing that we did previously. But that’s sort of defeating the point, and besides, there’s an easier way. Let’s think about what how the <code>chico2</code> data frame is structured: there are three variables here, and they all matter. The outcome measure is stored as the <code>grade</code>, and we effectively have two “groups” of measurements (test 1 and test 2) that are defined by the <code>time</code> points at which a test is given. Finally, because we want to keep track of which measurements should be paired together, we need to know which student obtained each grade, which is what the <code>id</code> variable gives us. So, when your data are presented to you in long form, we would want specify a <em>two-sided</em> formula and a data frame, in the same way that we do for an independent samples <span class="math inline">\(t\)</span>-test: the formula specifies the outcome variable and the groups, so in this case it would be <code>grade ~ time</code>, and the data frame is <code>chico2</code>. However, we also need to tell it the id variable, which in this case is boringly called <code>id</code>. So our command is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairedSamplesTTest</span>( 
     <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>time,  <span class="co"># two sided formula: outcome ~ group</span>
     <span class="dt">data =</span> chico2,           <span class="co"># data frame</span>
     <span class="dt">id =</span> <span class="st">&quot;id&quot;</span>                <span class="co"># name of the id variable</span>
  )</code></pre></div>
<pre><code>## 
##    Paired samples t-test 
## 
## Outcome variable:   grade 
## Grouping variable:  time 
## ID variable:        id 
## 
## Descriptive statistics: 
##              test1  test2 difference
##    mean     56.980 58.385     -1.405
##    std dev.  6.616  6.406      0.970
## 
## Hypotheses: 
##    null:        population means equal for both measurements
##    alternative: different population means for each measurement
## 
## Test results: 
##    t-statistic:  -6.475 
##    degrees of freedom:  19 
##    p-value:  &lt;.001 
## 
## Other information: 
##    two-sided 95% confidence interval:  [-1.859, -0.951] 
##    estimated effect size (Cohen&#39;s d):  1.448</code></pre>
<p>Note that the name of the id variable is <code>&quot;id&quot;</code> and not <code>id</code>. Note that the <code>id</code> variable must be a factor. As of the current writing, you do need to include the quote marks, because the <code>pairedSamplesTTest()</code> function is expecting a <em>character string</em> that specifies the name of a variable. If I ever find the time I’ll try to relax this constraint.</p>
<p>As you can see, it’s a bit more detailed than the output from <code>oneSampleTTest()</code>. It gives you the descriptive statistics for the original variables, states the null hypothesis in a fashion that is a bit more appropriate for a repeated measures design, and then reports all the nuts and bolts from the hypothesis test itself. Not surprisingly the numbers the same as the ones that we saw last time.</p>
<p>One final comment about the <code>pairedSamplesTTest()</code> function. One of the reasons I designed it to be able handle long form and wide form data is that I want you to be get comfortable thinking about repeated measures data in both formats, and also to become familiar with the different ways in which R functions tend to specify models and tests for repeated measures data. With that last point in mind, I want to highlight a slightly different way of thinking about what the paired samples <span class="math inline">\(t\)</span>-test is doing. There’s a sense in which what you’re really trying to do is look at how the outcome variable (<code>grade</code>) is related to the grouping variable (<code>time</code>), after taking account of the fact that there are individual differences between people (<code>id</code>). So there’s a sense in which <code>id</code> is actually a <em>second</em> predictor: you’re trying to predict the <code>grade</code> on the basis of the <code>time</code> and the <code>id</code>. With that in mind, the <code>pairedSamplesTTest()</code> function lets you specify a formula like this one</p>
<pre><code>grade ~ time + (id)</code></pre>
<p>This formula tells R everything it needs to know: the variable on the left (<code>grade</code>) is the outcome variable, the bracketed term on the right (<code>id</code>) is the id variable, and the other term on the right is the grouping variable (<code>time</code>). If you specify your formula that way, then you only need to specify the <code>formula</code> and the <code>data</code> frame, and so you can get away with using a command as simple as this one:</p>
<pre><code>pairedSamplesTTest( 
     formula = grade ~ time + (id),
     data = chico2
  )</code></pre>
<p>or you can drop the argument names and just do this:</p>
<pre><code>&gt; pairedSamplesTTest( grade ~ time + (id), chico2 )</code></pre>
<p>These commands will produce the same output as the last one, I personally find this format a lot more elegant. That being said, the main reason for allowing you to write your formulas that way is that they’re quite similar to the way that mixed models (fancy pants repeated measures analyses) are specified in the <code>lme4</code> package. This book doesn’t talk about mixed models (yet!), but if you go on to learn more statistics you’ll find them pretty hard to avoid, so I’ve tried to lay a little bit of the groundwork here.</p>
</div>
</div>
<div id="one-sided-tests" class="section level2">
<h2><span class="header-section-number">13.6</span> One sided tests</h2>
<p>When introducing the theory of null hypothesis tests, I mentioned that there are some situations when it’s appropriate to specify a <em>one-sided</em> test (see Section <a href="hypothesistesting.html#onesidedtests">11.4.3</a>). So far, all of the <span class="math inline">\(t\)</span>-tests have been two-sided tests. For instance, when we specified a one sample <span class="math inline">\(t\)</span>-test for the grades in Dr Zeppo’s class, the null hypothesis was that the true mean was 67.5%. The alternative hypothesis was that the true mean was greater than <em>or</em> less than 67.5%. Suppose we were only interested in finding out if the true mean is greater than 67.5%, and have no interest whatsoever in testing to find out if the true mean is lower than 67.5%. If so, our null hypothesis would be that the true mean is 67.5% or less, and the alternative hypothesis would be that the true mean is greater than 67.5%. The <code>oneSampleTTest()</code> function lets you do this, by specifying the <code>one.sided</code> argument. If you set <code>one.sided=&quot;greater&quot;</code>, it means that you’re testing to see if the true mean is larger than <code>mu</code>. If you set <code>one.sided=&quot;less&quot;</code>, then you’re testing to see if the true mean is smaller than <code>mu</code>. Here’s how it would work for Dr Zeppo’s class:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">oneSampleTTest</span>( <span class="dt">x=</span>grades, <span class="dt">mu=</span><span class="fl">67.5</span>, <span class="dt">one.sided=</span><span class="st">&quot;greater&quot;</span> )</code></pre></div>
<pre><code>## 
##    One sample t-test 
## 
## Data variable:   grades 
## 
## Descriptive statistics: 
##             grades
##    mean     72.300
##    std dev.  9.521
## 
## Hypotheses: 
##    null:        population mean less than or equal to 67.5 
##    alternative: population mean greater than 67.5 
## 
## Test results: 
##    t-statistic:  2.255 
##    degrees of freedom:  19 
##    p-value:  0.018 
## 
## Other information: 
##    one-sided 95% confidence interval:  [68.619, Inf] 
##    estimated effect size (Cohen&#39;s d):  0.504</code></pre>
<p>Notice that there are a few changes from the output that we saw last time. Most important is the fact that the null and alternative hypotheses have changed, to reflect the different test. The second thing to note is that, although the <span class="math inline">\(t\)</span>-statistic and degrees of freedom have not changed, the <span class="math inline">\(p\)</span>-value has. This is because the one-sided test has a different rejection region from the two-sided test. If you’ve forgotten why this is and what it means, you may find it helpful to read back over Chapter <a href="hypothesistesting.html#hypothesistesting">11</a>, and Section <a href="hypothesistesting.html#onesidedtests">11.4.3</a> in particular. The third thing to note is that the confidence interval is different too: it now reports a “one-sided” confidence interval rather than a two-sided one. In a two-sided confidence interval, we’re trying to find numbers <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> such that we’re 95% confident that the true mean lies <em>between</em> <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. In a one-sided confidence interval, we’re trying to find a single number <span class="math inline">\(a\)</span> such that we’re 95% confident that the true mean is <em>greater than</em> <span class="math inline">\(a\)</span> (or less than <span class="math inline">\(a\)</span> if you set <code>one.sided=&quot;less&quot;</code>).</p>
<p>So that’s how to do a one-sided one sample <span class="math inline">\(t\)</span>-test. However, all versions of the <span class="math inline">\(t\)</span>-test can be one-sided. For an independent samples <span class="math inline">\(t\)</span> test, you could have a one-sided test if you’re only interestd in testing to see if group A has <em>higher</em> scores than group B, but have no interest in finding out if group B has higher scores than group A. Let’s suppose that, for Dr Harpo’s class, you wanted to see if Anastasia’s students had higher grades than Bernadette’s. The <code>independentSamplesTTest()</code> function lets you do this, again by specifying the <code>one.sided</code> argument. However, this time around you need to specify the name of the group that you’re expecting to have the higher score. In our case, we’d write <code>one.sided = &quot;Anastasia&quot;</code>. So the command would be:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">independentSamplesTTest</span>( 
    <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>tutor, 
    <span class="dt">data =</span> harpo, 
    <span class="dt">one.sided =</span> <span class="st">&quot;Anastasia&quot;</span>
  )</code></pre></div>
<pre><code>## 
##    Welch&#39;s independent samples t-test 
## 
## Outcome variable:   grade 
## Grouping variable:  tutor 
## 
## Descriptive statistics: 
##             Anastasia Bernadette
##    mean        74.533     69.056
##    std dev.     8.999      5.775
## 
## Hypotheses: 
##    null:        population means are equal, or smaller for group &#39;Anastasia&#39; 
##    alternative: population mean is larger for group &#39;Anastasia&#39; 
## 
## Test results: 
##    t-statistic:  2.034 
##    degrees of freedom:  23.025 
##    p-value:  0.027 
## 
## Other information: 
##    one-sided 95% confidence interval:  [0.863, Inf] 
##    estimated effect size (Cohen&#39;s d):  0.724</code></pre>
<p>Again, the output changes in a predictable way. The definition of the null and alternative hypotheses has changed, the <span class="math inline">\(p\)</span>-value has changed, and it now reports a one-sided confidence interval rather than a two-sided one.</p>
<p>What about the paired samples <span class="math inline">\(t\)</span>-test? Suppose we wanted to test the hypothesis that grades go <em>up</em> from test 1 to test 2 in Dr Zeppo’s class, and are not prepared to consider the idea that the grades go down. Again, we can use the <code>one.sided</code> argument to specify the one-sided test, and it works the same way it does for the independent samples <span class="math inline">\(t\)</span>-test. You need to specify the name of the group whose scores are expected to be larger under the alternative hypothesis. If your data are in wide form, as they are in the <code>chico</code> data frame, you’d use this command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairedSamplesTTest</span>( 
     <span class="dt">formula =</span> <span class="op">~</span><span class="st"> </span>grade_test2 <span class="op">+</span><span class="st"> </span>grade_test1, 
     <span class="dt">data =</span> chico, 
     <span class="dt">one.sided =</span> <span class="st">&quot;grade_test2&quot;</span> 
  )</code></pre></div>
<pre><code>## 
##    Paired samples t-test 
## 
## Variables:  grade_test2 , grade_test1 
## 
## Descriptive statistics: 
##             grade_test2 grade_test1 difference
##    mean          58.385      56.980      1.405
##    std dev.       6.406       6.616      0.970
## 
## Hypotheses: 
##    null:        population means are equal, or smaller for measurement &#39;grade_test2&#39; 
##    alternative: population mean is larger for measurement &#39;grade_test2&#39; 
## 
## Test results: 
##    t-statistic:  6.475 
##    degrees of freedom:  19 
##    p-value:  &lt;.001 
## 
## Other information: 
##    one-sided 95% confidence interval:  [1.03, Inf] 
##    estimated effect size (Cohen&#39;s d):  1.448</code></pre>
<p>Yet again, the output changes in a predictable way. The hypotheses have changed, the <span class="math inline">\(p\)</span>-value has changed, and the confidence interval is now one-sided. If your data are in long form, as they are in the <code>chico2</code> data frame, it still works the same way. Either of the following commands would work,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pairedSamplesTTest</span>( 
    <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>time, 
    <span class="dt">data =</span> chico2, 
    <span class="dt">id =</span> <span class="st">&quot;id&quot;</span>, 
    <span class="dt">one.sided =</span> <span class="st">&quot;test2&quot;</span> 
  )

<span class="op">&gt;</span><span class="st"> </span><span class="kw">pairedSamplesTTest</span>( 
    <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>(id), 
    <span class="dt">data =</span> chico2, 
    <span class="dt">one.sided =</span> <span class="st">&quot;test2&quot;</span> 
  )</code></pre></div>
<p>and would produce the same answer as the output shown above.</p>
</div>
<div id="ttestfunction" class="section level2">
<h2><span class="header-section-number">13.7</span> Using the t.test() function</h2>
<p>In this chapter, we’ve talked about three different kinds of <span class="math inline">\(t\)</span>-test: the one sample test, the independent samples test (Student’s and Welch’s), and the paired samples test. In order to run these different tests, I’ve shown you three different functions: <code>oneSampleTTest()</code>, <code>independentSamplesTTest()</code> and <code>pairedSamplesTTest()</code>. I wrote these as three different functions for two reasons. Firstly, I thought it made sense to have separate functions for each test, in order to help make it clear to beginners that there <em>are</em> different tests. Secondly, I wanted to show you some functions that produced “verbose” output, to help you see what hypotheses are being tested and so on.</p>
<p>However, once you’ve started to become familiar with <span class="math inline">\(t\)</span>-tests and with using R, you might find it easier to use the <code>t.test()</code> function. It’s one function, but it can run all four of the different <span class="math inline">\(t\)</span>-tests that we’ve talked about. Here’s how it works. Firstly, suppose you want to run a one sample <span class="math inline">\(t\)</span>-test. To run the test on the <code>grades</code> data from Dr Zeppo’s class (Section <a href="ttest.html#onesamplettest">13.2</a>), we’d use a command like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>( <span class="dt">x =</span> grades, <span class="dt">mu =</span> <span class="fl">67.5</span> )</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  grades
## t = 2.2547, df = 19, p-value = 0.03615
## alternative hypothesis: true mean is not equal to 67.5
## 95 percent confidence interval:
##  67.84422 76.75578
## sample estimates:
## mean of x 
##      72.3</code></pre>
<p>The input is the same as for the <code>oneSampleTTest()</code>: we specify the sample data using the argument <code>x</code>, and the value against which it is to be tested using the argument <code>mu</code>. The output is a lot more compressed.</p>
<p>As you can see, it still has all the information you need. It tells you what type of test it ran and the data it tested it on. It gives you the <span class="math inline">\(t\)</span>-statistic, the degrees of freedom and the <span class="math inline">\(p\)</span>-value. And so on. There’s nothing wrong with this output, but in my experience it can be a little confusing when you’re just starting to learn statistics, because it’s a little disorganised. Once you know what you’re looking at though, it’s pretty easy to read off the relevant information.</p>
<p>What about independent samples <span class="math inline">\(t\)</span>-tests? As it happens, the <code>t.test()</code> function can be used in much the same way as the <code>independentSamplesTTest()</code> function, by specifying a formula, a data frame, and using <code>var.equal</code> to indicate whether you want a Student test or a Welch test. If you want to run the Welch test from Section <a href="ttest.html#welchttest">13.4</a>, then you’d use this command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>( <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>tutor, <span class="dt">data =</span> harpo )</code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  grade by tutor
## t = 2.0342, df = 23.025, p-value = 0.05361
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.09249349 11.04804904
## sample estimates:
##  mean in group Anastasia mean in group Bernadette 
##                 74.53333                 69.05556</code></pre>
<p>If you want to do the Student test, it’s exactly the same except that you need to add an additional argument indicating that <code>var.equal = TRUE</code>. This is no different to how it worked in the <code>independentSamplesTTest()</code> function.</p>
<p>Finally, we come to the paired samples <span class="math inline">\(t\)</span>-test. Somewhat surprisingly, given that most R functions for dealing with repeated measures data require data to be in long form, the <code>t.test()</code> function isn’t really set up to handle data in long form. Instead it expects to be given two separate variables, <code>x</code> and <code>y</code>, and you need to specify <code>paired=TRUE</code>. And on top of that, you’d better make sure that the first element of <code>x</code> and the first element of <code>y</code> actually correspond to the same person! Because it doesn’t ask for an “id” variable. I don’t know why. So, in order to run the paired samples <span class="math inline">\(t\)</span> test on the data from Dr Chico’s class, we’d use this command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>( <span class="dt">x =</span> chico<span class="op">$</span>grade_test2,   <span class="co"># variable 1 is the &quot;test2&quot; scores</span>
         <span class="dt">y =</span> chico<span class="op">$</span>grade_test1,   <span class="co"># variable 2 is the &quot;test1&quot; scores</span>
         <span class="dt">paired =</span> <span class="ot">TRUE</span>           <span class="co"># paired test</span>
 )</code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  chico$grade_test2 and chico$grade_test1
## t = 6.4754, df = 19, p-value = 3.321e-06
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.9508686 1.8591314
## sample estimates:
## mean of the differences 
##                   1.405</code></pre>
<p>Yet again, these are the same numbers that we saw in Section <a href="ttest.html#pairedsamplesttest">13.5</a>. Feel free to check.</p>
</div>
<div id="cohensd" class="section level2">
<h2><span class="header-section-number">13.8</span> Effect size</h2>
<p>The most commonly used measure of effect size for a <span class="math inline">\(t\)</span>-test is <strong><em>Cohen’s <span class="math inline">\(d\)</span></em></strong> <span class="citation">(Cohen <a href="#ref-Cohen1988">1988</a>)</span>. It’s a very simple measure in principle, with quite a few wrinkles when you start digging into the details. Cohen himself defined it primarily in the context of an independent samples <span class="math inline">\(t\)</span>-test, specifically the Student test. In that context, a natural way of defining the effect size is to divide the difference between the means by an estimate of the standard deviation. In other words, we’re looking to calculate <em>something</em> along the lines of this: <span class="math display">\[
d = \frac{\mbox{(mean 1)} - \mbox{(mean 2)}}{\mbox{std dev}}
\]</span> and he suggested a rough guide for interpreting <span class="math inline">\(d\)</span> in Table <a href="#tab:cohensdinterpretation"><strong>??</strong></a>. You’d think that this would be pretty unambiguous, but it’s not; largely because Cohen wasn’t too specific on what he thought should be used as the measure of the standard deviation (in his defence, he was trying to make a broader point in his book, not nitpick about tiny details). As discussed by <span class="citation">McGrath and Meyer (<a href="#ref-McGrath2006">2006</a>)</span>, there are several different version in common usage, and each author tends to adopt slightly different notation. For the sake of simplicity (as opposed to accuracy) I’ll use <span class="math inline">\(d\)</span> to refer to any statistic that you calculate from the sample, and use <span class="math inline">\(\delta\)</span> to refer to a theoretical population effect. Obviously, that does mean that there are several different things all called <span class="math inline">\(d\)</span>. The <code>cohensD()</code> function in the <code>lsr</code> package uses the <code>method</code> argument to distinguish between them, so that’s what I’ll do in the text.</p>
<p>My suspicion is that the only time that you would want Cohen’s <span class="math inline">\(d\)</span> is when you’re running a <span class="math inline">\(t\)</span>-test, and if you’re using the <code>oneSampleTTest</code>, <code>independentSamplesTTest</code> and <code>pairedSamplesTTest()</code> functions to run your <span class="math inline">\(t\)</span>-tests, then you don’t need to learn any new commands, because they automatically produce an estimate of Cohen’s <span class="math inline">\(d\)</span> as part of the output. However, if you’re using <code>t.test()</code> then you’ll need to use the <code>cohensD()</code> function (also in the <code>lsr</code> package) to do the calculations.</p>
<table>
<thead>
<tr class="header">
<th align="left"><span class="math inline">\(d\)</span>-value</th>
<th align="left">rough interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">about 0.2</td>
<td align="left">small effect</td>
</tr>
<tr class="even">
<td align="left">about 0.5</td>
<td align="left">moderate effect</td>
</tr>
<tr class="odd">
<td align="left">about 0.8</td>
<td align="left">large effect</td>
</tr>
</tbody>
</table>
<div id="cohens-d-from-one-sample" class="section level3">
<h3><span class="header-section-number">13.8.1</span> Cohen’s <span class="math inline">\(d\)</span> from one sample</h3>
<p>The simplest situation to consider is the one corresponding to a one-sample <span class="math inline">\(t\)</span>-test. In this case, the one sample mean <span class="math inline">\(\bar{X}\)</span> and one (hypothesised) population mean <span class="math inline">\(\mu_o\)</span> to compare it to. Not only that, there’s really only one sensible way to estimate the population standard deviation: we just use our usual estimate <span class="math inline">\(\hat{\sigma}\)</span>. Therefore, we end up with the following as the only way to calculate <span class="math inline">\(d\)</span>, <span class="math display">\[
d = \frac{\bar{X} - \mu_0}{\hat{\sigma}}
\]</span> When writing the <code>cohensD()</code> function, I’ve made some attempt to make it work in a similar way to <code>t.test()</code>. As a consequence, <code>cohensD()</code> can calculate your effect size regardless of which type of <span class="math inline">\(t\)</span>-test you performed. If what you want is a measure of Cohen’s <span class="math inline">\(d\)</span> to accompany a one-sample <span class="math inline">\(t\)</span>-test, there’s only two arguments that you need to care about. These are:</p>
<ul>
<li><code>x</code>. A numeric vector containing the sample data.</li>
<li><code>mu</code>. The mean against which the mean of <code>x</code> is compared (default value is <code>mu = 0</code>).</li>
</ul>
<p>We don’t need to specify what <code>method</code> to use, because there’s only one version of <span class="math inline">\(d\)</span> that makes sense in this context. So, in order to compute an effect size for the data from Dr Zeppo’s class (Section <a href="ttest.html#onesamplettest">13.2</a>), we’d type something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cohensD</span>( <span class="dt">x =</span> grades,    <span class="co"># data are stored in the grades vector</span>
          <span class="dt">mu =</span> <span class="fl">67.5</span>      <span class="co"># compare students to a mean of 67.5</span>
 )</code></pre></div>
<pre><code>## [1] 0.5041691</code></pre>
<p>and, just so that you can see that there’s nothing fancy going on, the command below shows you how to calculate it if there weren’t no fancypants <code>cohensD()</code> function available:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">( <span class="kw">mean</span>(grades) <span class="op">-</span><span class="st"> </span><span class="fl">67.5</span> ) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(grades)</code></pre></div>
<pre><code>## [1] 0.5041691</code></pre>
<p>Yep, same number. Overall, then, the psychology students in Dr Zeppo’s class are achieving grades (mean = 72.3%) that are about .5 standard deviations higher than the level that you’d expect (67.5%) if they were performing at the same level as other students. Judged against Cohen’s rough guide, this is a moderate effect size.</p>
</div>
<div id="cohens-d-from-a-student-t-test" class="section level3">
<h3><span class="header-section-number">13.8.2</span> Cohen’s <span class="math inline">\(d\)</span> from a Student <span class="math inline">\(t\)</span> test</h3>
<p>The majority of discussions of Cohen’s <span class="math inline">\(d\)</span> focus on a situation that is analogous to Student’s independent samples <span class="math inline">\(t\)</span> test, and it’s in this context that the story becomes messier, since there are several different versions of <span class="math inline">\(d\)</span> that you might want to use in this situation, and you can use the <code>method</code> argument to the <code>cohensD()</code> function to pick the one you want. To understand why there are multiple versions of <span class="math inline">\(d\)</span>, it helps to take the time to write down a formula that corresponds to the true population effect size <span class="math inline">\(\delta\)</span>. It’s pretty straightforward, <span class="math display">\[
\delta = \frac{\mu_1 - \mu_2}{\sigma}
\]</span> where, as usual, <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> are the population means corresponding to group 1 and group 2 respectively, and <span class="math inline">\(\sigma\)</span> is the standard deviation (the same for both populations). The obvious way to estimate <span class="math inline">\(\delta\)</span> is to do exactly the same thing that we did in the <span class="math inline">\(t\)</span>-test itself: use the sample means as the top line, and a pooled standard deviation estimate for the bottom line: <span class="math display">\[
d = \frac{\bar{X}_1 - \bar{X}_2}{\hat{\sigma}_p}
\]</span> where <span class="math inline">\(\hat\sigma_p\)</span> is the exact same pooled standard deviation measure that appears in the <span class="math inline">\(t\)</span>-test. This is the most commonly used version of Cohen’s <span class="math inline">\(d\)</span> when applied to the outcome of a Student <span class="math inline">\(t\)</span>-test ,and is sometimes referred to as Hedges’ <span class="math inline">\(g\)</span> statistic <span class="citation">(Hedges <a href="#ref-Hedges1981">1981</a>)</span>. It corresponds to <code>method = &quot;pooled&quot;</code> in the <code>cohensD()</code> function, and it’s the default.</p>
<p>However, there are other possibilities, which I’ll briefly describe. Firstly, you may have reason to want to use only one of the two groups as the basis for calculating the standard deviation. This approach (often called Glass’ <span class="math inline">\(\Delta\)</span>) only makes most sense when you have good reason to treat one of the two groups as a purer reflection of “natural variation” than the other. This can happen if, for instance, one of the two groups is a control group. If that’s what you want, then use <code>method = &quot;x.sd&quot;</code> or <code>method = &quot;y.sd&quot;</code> when using <code>cohensD()</code>. Secondly, recall that in the usual calculation of the pooled standard deviation we divide by <span class="math inline">\(N-2\)</span> to correct for the bias in the sample variance; in one version of Cohen’s <span class="math inline">\(d\)</span> this correction is omitted. Instead, we divide by <span class="math inline">\(N\)</span>. This version (<code>method = &quot;raw&quot;</code>) makes sense primarily when you’re trying to calculate the effect size in the sample; rather than estimating an effect size in the population. Finally, there is a version based on <span class="citation">Hedges and Olkin (<a href="#ref-Hedges1985">1985</a>)</span>, who point out there is a small bias in the usual (pooled) estimation for Cohen’s <span class="math inline">\(d\)</span>. Thus they introduce a small correction (<code>method = &quot;corrected&quot;</code>), by multiplying the usual value of <span class="math inline">\(d\)</span> by <span class="math inline">\((N-3)/(N-2.25)\)</span>.</p>
<p>In any case, ignoring all those variations that you could make use of if you wanted, let’s have a look at how to calculate the default version. In particular, suppose we look at the data from Dr Harpo’s class (the <code>harpo</code> data frame). The command that we want to use is very similar to the relevant <code>t.test()</code> command, but also specifies a <code>method</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cohensD</span>( <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>tutor,  <span class="co"># outcome ~ group</span>
          <span class="dt">data =</span> harpo,             <span class="co"># data frame </span>
          <span class="dt">method =</span> <span class="st">&quot;pooled&quot;</span>         <span class="co"># which version to calculate?</span>
)</code></pre></div>
<pre><code>## [1] 0.7395614</code></pre>
<p>This is the version of Cohen’s <span class="math inline">\(d\)</span> that gets reported by the <code>independentSamplesTTest()</code> function whenever it runs a Student <span class="math inline">\(t\)</span>-test.</p>
</div>
<div id="cohens-d-from-a-welch-test" class="section level3">
<h3><span class="header-section-number">13.8.3</span> Cohen’s <span class="math inline">\(d\)</span> from a Welch test</h3>
<p>Suppose the situation you’re in is more like the Welch test: you still have two independent samples, but you no longer believe that the corresponding populations have equal variances. When this happens, we have to redefine what we mean by the population effect size. I’ll refer to this new measure as <span class="math inline">\(\delta^\prime\)</span>, so as to keep it distinct from the measure <span class="math inline">\(\delta\)</span> which we defined previously. What <span class="citation">Cohen (<a href="#ref-Cohen1988">1988</a>)</span> suggests is that we could define our new population effect size by averaging the two population variances. What this means is that we get: <span class="math display">\[
\delta^\prime = \frac{\mu_1 - \mu_2}{\sigma^\prime}
\]</span> where <span class="math display">\[
\sigma^\prime = \sqrt{\displaystyle{\frac{ {\sigma_1}^2 + {\sigma_2}^2}{2}}}
\]</span> This seems quite reasonable, but notice that none of the measures that we’ve discussed so far are attempting to estimate this new quantity. It might just be my own ignorance of the topic, but I’m only aware of one version of Cohen’s <span class="math inline">\(d\)</span> that actually estimates the unequal-variance effect size <span class="math inline">\(\delta^\prime\)</span> rather than the equal-variance effect size <span class="math inline">\(\delta\)</span>. All we do to calculate <span class="math inline">\(d\)</span> for this version (<code>method = &quot;unequal&quot;</code>) is substitute the sample means <span class="math inline">\(\bar{X}_1\)</span> and <span class="math inline">\(\bar{X}_2\)</span> and the corrected sample standard deviations <span class="math inline">\(\hat{\sigma}_1\)</span> and <span class="math inline">\(\hat{\sigma}_2\)</span> into the equation for <span class="math inline">\(\delta^\prime\)</span>. This gives us the following equation for <span class="math inline">\(d\)</span>, <span class="math display">\[
d = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\displaystyle{\frac{ {\hat\sigma_1}^2 + {\hat\sigma_2}^2}{2}}}}
\]</span> as our estimate of the effect size. There’s nothing particularly difficult about calculating this version in R, since all we have to do is change the <code>method</code> argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cohensD</span>( <span class="dt">formula =</span> grade <span class="op">~</span><span class="st"> </span>tutor, 
          <span class="dt">data =</span> harpo,
          <span class="dt">method =</span> <span class="st">&quot;unequal&quot;</span> 
 )</code></pre></div>
<pre><code>## [1] 0.7244995</code></pre>
<p>This is the version of Cohen’s <span class="math inline">\(d\)</span> that gets reported by the <code>independentSamplesTTest()</code> function whenever it runs a Welch <span class="math inline">\(t\)</span>-test.</p>
</div>
<div id="cohens-d-from-a-paired-samples-test" class="section level3">
<h3><span class="header-section-number">13.8.4</span> Cohen’s <span class="math inline">\(d\)</span> from a paired-samples test</h3>
<p>Finally, what should we do for a paired samples <span class="math inline">\(t\)</span>-test? In this case, the answer depends on what it is you’re trying to do. <em>If</em> you want to measure your effect sizes relative to the distribution of difference scores, the measure of <span class="math inline">\(d\)</span> that you calculate is just (<code>method = &quot;paired&quot;</code>) <span class="math display">\[
d = \frac{\bar{D}}{\hat{\sigma}_D}
\]</span> where <span class="math inline">\(\hat{\sigma}_D\)</span> is the estimate of the standard deviation of the differences. The calculation here is pretty straightforward</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cohensD</span>( <span class="dt">x =</span> chico<span class="op">$</span>grade_test2, 
          <span class="dt">y =</span> chico<span class="op">$</span>grade_test1,
          <span class="dt">method =</span> <span class="st">&quot;paired&quot;</span> 
 )</code></pre></div>
<pre><code>## [1] 1.447952</code></pre>
<p>This is the version of Cohen’s <span class="math inline">\(d\)</span> that gets reported by the <code>pairedSamplesTTest()</code> function. The only wrinkle is figuring out whether this is the measure you want or not. To the extent that you care about the practical consequences of your research, you often want to measure the effect size relative to the <em>original</em> variables, not the <em>difference</em> scores (e.g., the 1% improvement in Dr Chico’s class is pretty small when measured against the amount of between-student variation in grades), in which case you use the same versions of Cohen’s <span class="math inline">\(d\)</span> that you would use for a Student or Welch test. For instance, when we do that for Dr Chico’s class,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cohensD</span>( <span class="dt">x =</span> chico<span class="op">$</span>grade_test2, 
          <span class="dt">y =</span> chico<span class="op">$</span>grade_test1,
          <span class="dt">method =</span> <span class="st">&quot;pooled&quot;</span> 
 )</code></pre></div>
<pre><code>## [1] 0.2157646</code></pre>
<p>what we see is that the overall effect size is quite small, when assessed on the scale of the original variables.</p>
</div>
</div>
<div id="shapiro" class="section level2">
<h2><span class="header-section-number">13.9</span> Checking the normality of a sample</h2>
<p>All of the tests that we have discussed so far in this chapter have assumed that the data are normally distributed. This assumption is often quite reasonable, because the central limit theorem (Section <a href="estimation.html#clt">10.3.3</a>) does tend to ensure that many real world quantities are normally distributed: any time that you suspect that your variable is <em>actually</em> an average of lots of different things, there’s a pretty good chance that it will be normally distributed; or at least close enough to normal that you can get away with using <span class="math inline">\(t\)</span>-tests. However, life doesn’t come with guarantees; and besides, there are lots of ways in which you can end up with variables that are highly non-normal. For example, any time you think that your variable is actually the minimum of lots of different things, there’s a very good chance it will end up quite skewed. In psychology, response time (RT) data is a good example of this. If you suppose that there are lots of things that could trigger a response from a human participant, then the actual response will occur the first time one of these trigger events occurs.<a href="#fn199" class="footnoteRef" id="fnref199"><sup>199</sup></a> This means that RT data are systematically non-normal. Okay, so if normality is assumed by all the tests, and is mostly but not always satisfied (at least approximately) by real world data, how can we check the normality of a sample? In this section I discuss two methods: QQ plots, and the Shapiro-Wilk test.</p>
<div id="qq-plots" class="section level3">
<h3><span class="header-section-number">13.9.1</span> QQ plots</h3>
<div class="figure"><span id="fig:qq1a"></span>
<img src="lsr_files/figure-html/qq1a-1.png" alt="Histogram of `normal.data`, a normally distributed sample with 100 observations." width="672" />
<p class="caption">
Figure 13.14: Histogram of <code>normal.data</code>, a normally distributed sample with 100 observations.
</p>
</div>
<pre><code>## Normally Distributed Data 
## skew= -0.02936155 
## kurtosis= -0.06035938 
## 
##  Shapiro-Wilk normality test
## 
## data:  data
## W = 0.99108, p-value = 0.7515</code></pre>
<div class="figure"><span id="fig:qq1b"></span>
<img src="lsr_files/figure-html/qq1b-1.png" alt="Normal QQ plot of `normal.data`, a normally distributed sample with 100 observations." width="672" />
<p class="caption">
Figure 13.15: Normal QQ plot of <code>normal.data</code>, a normally distributed sample with 100 observations.
</p>
</div>
<p>The Shapiro-Wilk statistic associated with the data in Figures <a href="ttest.html#fig:qq1a">13.14</a> and <a href="ttest.html#fig:qq1b">13.15</a> is <span class="math inline">\(W = .99\)</span>, indicating that no significant departures from normality were detected (<span class="math inline">\(p = .73\)</span>). As you can see, these data form a pretty straight line; which is no surprise given that we sampled them from a normal distribution! In contrast, have a look at the two data sets shown in Figures <a href="ttest.html#fig:qq2a">13.16</a>, <a href="ttest.html#fig:qq2b">13.17</a>, <a href="ttest.html#fig:qq2c">13.18</a>, <a href="ttest.html#fig:qq2d">13.19</a>. Figures <a href="ttest.html#fig:qq2a">13.16</a> and <a href="ttest.html#fig:qq2b">13.17</a> show the histogram and a QQ plot for a data set that is highly skewed: the QQ plot curves upwards. Figures <a href="ttest.html#fig:qq2c">13.18</a> and <a href="ttest.html#fig:qq2d">13.19</a> show the same plots for a heavy tailed (i.e., high kurtosis) data set: in this case, the QQ plot flattens in the middle and curves sharply at either end.</p>
<div class="figure"><span id="fig:qq2a"></span>
<img src="lsr_files/figure-html/qq2a-1.png" alt="A histogram of the 100 observations in a `skewed.data` set" width="672" />
<p class="caption">
Figure 13.16: A histogram of the 100 observations in a <code>skewed.data</code> set
</p>
</div>
<pre><code>## Skewed Data 
## skew= 1.889475 
## kurtosis= 4.4396 
## 
##  Shapiro-Wilk normality test
## 
## data:  data
## W = 0.81758, p-value = 8.908e-10</code></pre>
<div class="figure"><span id="fig:qq2b"></span>
<img src="lsr_files/figure-html/qq2b-1.png" alt="A normal QQ plot of the 100 observations in a `skewed.data` set" width="672" />
<p class="caption">
Figure 13.17: A normal QQ plot of the 100 observations in a <code>skewed.data</code> set
</p>
</div>
<p>The skewness of the data in Figures <a href="ttest.html#fig:qq2a">13.16</a> and <a href="ttest.html#fig:qq2b">13.17</a> is 1.94, and is reflected in a QQ plot that curves upwards. As a consequence, the Shapiro-Wilk statistic is <span class="math inline">\(W=.80\)</span>, reflecting a significant departure from normality (<span class="math inline">\(p&lt;.001\)</span>).</p>
<div class="figure"><span id="fig:qq2c"></span>
<img src="lsr_files/figure-html/qq2c-1.png" alt="A histogram of the 100 observations in a *heavy tailed*` data set, again consisting of 100 observations. " width="672" />
<p class="caption">
Figure 13.18: A histogram of the 100 observations in a <em>heavy tailed</em>` data set, again consisting of 100 observations.
</p>
</div>
<pre><code>## Heavy-Tailed Data 
## skew= -0.05308273 
## kurtosis= 7.508765 
## 
##  Shapiro-Wilk normality test
## 
## data:  data
## W = 0.83892, p-value = 4.718e-09</code></pre>
<div class="figure"><span id="fig:qq2d"></span>
<img src="lsr_files/figure-html/qq2d-1.png" alt="A histogram of the 100 observations in a *heavy tailed*` data set, again consisting of 100 observations. " width="672" />
<p class="caption">
Figure 13.19: A histogram of the 100 observations in a <em>heavy tailed</em>` data set, again consisting of 100 observations.
</p>
</div>
<p>Figures <a href="ttest.html#fig:qq2c">13.18</a> and <a href="ttest.html#fig:qq2d">13.19</a> shows the same plots for a heavy tailed data set, again consisting of 100 observations. In this case, the heavy tails in the data produce a high kurtosis (2.80), and cause the QQ plot to flatten in the middle, and curve away sharply on either side. The resulting Shapiro-Wilk statistic is <span class="math inline">\(W = .93\)</span>, again reflecting significant non-normality (<span class="math inline">\(p &lt; .001\)</span>).</p>
<p>One way to check whether a sample violates the normality assumption is to draw a <strong><em>“quantile-quantile” plot</em></strong> (QQ plot). This allows you to visually check whether you’re seeing any systematic violations. In a QQ plot, each observation is plotted as a single dot. The x co-ordinate is the theoretical quantile that the observation should fall in, if the data were normally distributed (with mean and variance estimated from the sample) and on the y co-ordinate is the actual quantile of the data within the sample. If the data are normal, the dots should form a straight line. For instance, lets see what happens if we generate data by sampling from a normal distribution, and then drawing a QQ plot using the R function <code>qqnorm()</code>. The <code>qqnorm()</code> function has a few arguments, but the only one we really need to care about here is <code>y</code>, a vector specifying the data whose normality we’re interested in checking. Here’s the R commands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">normal.data &lt;-<span class="st"> </span><span class="kw">rnorm</span>( <span class="dt">n =</span> <span class="dv">100</span> )  <span class="co"># generate N = 100 normally distributed numbers</span>
<span class="kw">hist</span>( <span class="dt">x =</span> normal.data )          <span class="co"># draw a histogram of these numbers</span></code></pre></div>
<p><img src="lsr_files/figure-html/unnamed-chunk-587-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>( <span class="dt">y =</span> normal.data )        <span class="co"># draw the QQ plot</span></code></pre></div>
<p><img src="lsr_files/figure-html/unnamed-chunk-587-2.png" width="672" /></p>
</div>
<div id="shapiro-wilk-tests" class="section level3">
<h3><span class="header-section-number">13.9.2</span> Shapiro-Wilk tests</h3>
<p>Although QQ plots provide a nice way to informally check the normality of your data, sometimes you’ll want to do something a bit more formal. And when that moment comes, the <strong><em>Shapiro-Wilk test</em></strong> <span class="citation">(Shapiro and Wilk <a href="#ref-Shapiro1965">1965</a>)</span> is probably what you’re looking for.<a href="#fn200" class="footnoteRef" id="fnref200"><sup>200</sup></a> As you’d expect, the null hypothesis being tested is that a set of <span class="math inline">\(N\)</span> observations is normally distributed. The test statistic that it calculates is conventionally denoted as <span class="math inline">\(W\)</span>, and it’s calculated as follows. First, we sort the observations in order of increasing size, and let <span class="math inline">\(X_1\)</span> be the smallest value in the sample, <span class="math inline">\(X_2\)</span> be the second smallest and so on. Then the value of <span class="math inline">\(W\)</span> is given by <span class="math display">\[
W = \frac{ \left( \sum_{i = 1}^N a_i X_i \right)^2 }{ \sum_{i = 1}^N (X_i - \bar{X})^2}
\]</span> where <span class="math inline">\(\bar{X}\)</span> is the mean of the observations, and the <span class="math inline">\(a_i\)</span> values are … mumble, mumble … something complicated that is a bit beyond the scope of an introductory text.</p>
<p>Because it’s a little hard to explain the maths behind the <span class="math inline">\(W\)</span> statistic, a better idea is to give a broad brush description of how it behaves. Unlike most of the test statistics that we’ll encounter in this book, it’s actually <em>small</em> values of <span class="math inline">\(W\)</span> that indicated departure from normality. The <span class="math inline">\(W\)</span> statistic has a maximum value of 1, which arises when the data look “perfectly normal”. The smaller the value of <span class="math inline">\(W\)</span>, the less normal the data are. However, the sampling distribution for <span class="math inline">\(W\)</span> – which is not one of the standard ones that I discussed in Chapter <a href="probability.html#probability">9</a> and is in fact a complete pain in the arse to work with – does depend on the sample size <span class="math inline">\(N\)</span>. To give you a feel for what these sampling distributions look like, I’ve plotted three of them in Figure <a href="ttest.html#fig:swdist">13.20</a>. Notice that, as the sample size starts to get large, the sampling distribution becomes very tightly clumped up near <span class="math inline">\(W=1\)</span>, and as a consequence, for larger samples <span class="math inline">\(W\)</span> doesn’t have to be very much smaller than 1 in order for the test to be significant.</p>
<div class="figure"><span id="fig:swdist"></span>
<img src="C:/Users/pcmis/Documents/rbook/bookdown/img/ttest2/shapirowilkdist.png" alt="Sampling distribution of the Shapiro-Wilk $W$ statistic, under the null hypothesis that the data are normally distributed, for samples of size 10, 20 and 50. Note that *small* values of $W$ indicate departure from normality."  />
<p class="caption">
Figure 13.20: Sampling distribution of the Shapiro-Wilk <span class="math inline">\(W\)</span> statistic, under the null hypothesis that the data are normally distributed, for samples of size 10, 20 and 50. Note that <em>small</em> values of <span class="math inline">\(W\)</span> indicate departure from normality.
</p>
</div>
<p>To run the test in R, we use the <code>shapiro.test()</code> function. It has only a single argument <code>x</code>, which is a numeric vector containing the data whose normality needs to be tested. For example, when we apply this function to our <code>normal.data</code>, we get the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shapiro.test</span>( <span class="dt">x =</span> normal.data )</code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  normal.data
## W = 0.98654, p-value = 0.4076</code></pre>
<p>So, not surprisingly, we have no evidence that these data depart from normality. When reporting the results for a Shapiro-Wilk test, you should (as usual) make sure to include the test statistic <span class="math inline">\(W\)</span> and the <span class="math inline">\(p\)</span> value, though given that the sampling distribution depends so heavily on <span class="math inline">\(N\)</span> it would probably be a politeness to include <span class="math inline">\(N\)</span> as well.</p>
</div>
</div>
<div id="wilcox" class="section level2">
<h2><span class="header-section-number">13.10</span> Testing non-normal data with Wilcoxon tests</h2>
<p>Okay, suppose your data turn out to be pretty substantially non-normal, but you still want to run something like a <span class="math inline">\(t\)</span>-test? This situation occurs a lot in real life: for the AFL winning margins data, for instance, the Shapiro-Wilk test made it very clear that the normality assumption is violated. This is the situation where you want to use Wilcoxon tests.</p>
<p>Like the <span class="math inline">\(t\)</span>-test, the Wilcoxon test comes in two forms, one-sample and two-sample, and they’re used in more or less the exact same situations as the corresponding <span class="math inline">\(t\)</span>-tests. Unlike the <span class="math inline">\(t\)</span>-test, the Wilcoxon test doesn’t assume normality, which is nice. In fact, they don’t make any assumptions about what kind of distribution is involved: in statistical jargon, this makes them <strong><em>nonparametric tests</em></strong>. While avoiding the normality assumption is nice, there’s a drawback: the Wilcoxon test is usually less powerful than the <span class="math inline">\(t\)</span>-test (i.e., higher Type II error rate). I won’t discuss the Wilcoxon tests in as much detail as the <span class="math inline">\(t\)</span>-tests, but I’ll give you a brief overview.</p>
<div id="two-sample-wilcoxon-test" class="section level3">
<h3><span class="header-section-number">13.10.1</span> Two sample Wilcoxon test</h3>
<p>I’ll start by describing the <strong><em>two sample Wilcoxon test</em></strong> (also known as the Mann-Whitney test), since it’s actually simpler than the one sample version. Suppose we’re looking at the scores of 10 people on some test. Since my imagination has now failed me completely, let’s pretend it’s a “test of awesomeness”, and there are two groups of people, “A” and “B”. I’m curious to know which group is more awesome. The data are included in the file <code>awesome.Rdata</code>, and like many of the data sets I’ve been using, it contains only a single data frame, in this case called <code>awesome</code>. Here’s the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">file.path</span>(projecthome, <span class="st">&quot;data/awesome.Rdata&quot;</span>))
<span class="kw">print</span>( awesome )</code></pre></div>
<pre><code>##    scores group
## 1     6.4     A
## 2    10.7     A
## 3    11.9     A
## 4     7.3     A
## 5    10.0     A
## 6    14.5     B
## 7    10.4     B
## 8    12.9     B
## 9    11.7     B
## 10   13.0     B</code></pre>
<p>As long as there are no ties (i.e., people with the exact same awesomeness score), then the test that we want to do is surprisingly simple. All we have to do is construct a table that compares every observation in group <span class="math inline">\(A\)</span> against every observation in group <span class="math inline">\(B\)</span>. Whenever the group <span class="math inline">\(A\)</span> datum is larger, we place a check mark in the table:</p>
<p><img src="C:/Users/pcmis/Documents/rbook/bookdown/img/ttest2/wilcox1.png" /><!-- --></p>
<p>We then count up the number of checkmarks. This is our test statistic, <span class="math inline">\(W\)</span>.<a href="#fn201" class="footnoteRef" id="fnref201"><sup>201</sup></a> The actual sampling distribution for <span class="math inline">\(W\)</span> is somewhat complicated, and I’ll skip the details. For our purposes, it’s sufficient to note that the interpretation of <span class="math inline">\(W\)</span> is qualitatively the same as the interpretation of <span class="math inline">\(t\)</span> or <span class="math inline">\(z\)</span>. That is, if we want a two-sided test, then we reject the null hypothesis when <span class="math inline">\(W\)</span> is very large or very small; but if we have a directional (i.e., one-sided) hypothesis, then we only use one or the other.</p>
<p>The structure of the <code>wilcox.test()</code> function should feel very familiar to you by now. When you have your data organised in terms of an outcome variable and a grouping variable, then you use the <code>formula</code> and <code>data</code> arguments, so your command looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>( <span class="dt">formula =</span> scores <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> awesome)</code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  scores by group
## W = 3, p-value = 0.05556
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>Just like we saw with the <code>t.test()</code> function, there is an <code>alternative</code> argument that you can use to switch between two-sided tests and one-sided tests, plus a few other arguments that we don’t need to worry too much about at an introductory level. Similarly, the <code>wilcox.test()</code> function allows you to use the <code>x</code> and <code>y</code> arguments when you have your data stored separately for each group. For instance, suppose we use the data from the <code>awesome2.Rdata</code> file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>( <span class="kw">file.path</span>(projecthome, <span class="st">&quot;data/awesome2.Rdata&quot;</span> ))
score.A</code></pre></div>
<pre><code>## [1]  6.4 10.7 11.9  7.3 10.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">score.B</code></pre></div>
<pre><code>## [1] 14.5 10.4 12.9 11.7 13.0</code></pre>
<p>When your data are organised like this, then you would use a command like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>( <span class="dt">x =</span> score.A, <span class="dt">y =</span> score.B )</code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  score.A and score.B
## W = 3, p-value = 0.05556
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>The output that R produces is pretty much the same as last time.</p>
</div>
<div id="one-sample-wilcoxon-test" class="section level3">
<h3><span class="header-section-number">13.10.2</span> One sample Wilcoxon test</h3>
<p>What about the <strong><em>one sample Wilcoxon test</em></strong> (or equivalently, the paired samples Wilcoxon test)? Suppose I’m interested in finding out whether taking a statistics class has any effect on the happiness of students. Here’s my data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>( <span class="kw">file.path</span>(projecthome, <span class="st">&quot;data/happy.Rdata&quot;</span> ))
<span class="kw">print</span>( happiness )</code></pre></div>
<pre><code>##    before after change
## 1      30     6    -24
## 2      43    29    -14
## 3      21    11    -10
## 4      24    31      7
## 5      23    17     -6
## 6      40     2    -38
## 7      29    31      2
## 8      56    21    -35
## 9      38     8    -30
## 10     16    21      5</code></pre>
<p>What I’ve measured here is the happiness of each student <code>before</code> taking the class and <code>after</code> taking the class; the <code>change</code> score is the difference between the two. Just like we saw with the <span class="math inline">\(t\)</span>-test, there’s no fundamental difference between doing a paired-samples test using <code>before</code> and <code>after</code>, versus doing a one-sample test using the <code>change</code> scores. As before, the simplest way to think about the test is to construct a tabulation. The way to do it this time is to take those change scores that are positive valued, and tabulate them against all the complete sample. What you end up with is a table that looks like this:</p>
<p><img src="C:/Users/pcmis/Documents/rbook/bookdown/img/ttest2/wilcox2.png" /><!-- --></p>
<p>Counting up the tick marks this time, we get a test statistic of <span class="math inline">\(V = 7\)</span>. As before, if our test is two sided, then we reject the null hypothesis when <span class="math inline">\(V\)</span> is very large or very small. As far of running it in R goes, it’s pretty much what you’d expect. For the one-sample version, the command you would use is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>( <span class="dt">x =</span> happiness<span class="op">$</span>change,
              <span class="dt">mu =</span> <span class="dv">0</span>
)</code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank test
## 
## data:  happiness$change
## V = 7, p-value = 0.03711
## alternative hypothesis: true location is not equal to 0</code></pre>
<p>As this shows, we have a significant effect. Evidently, taking a statistics class does have an effect on your happiness. Switching to a paired samples version of the test won’t give us different answers, of course; but here’s the command to do it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>( <span class="dt">x =</span> happiness<span class="op">$</span>after,
              <span class="dt">y =</span> happiness<span class="op">$</span>before,
              <span class="dt">paired =</span> <span class="ot">TRUE</span> 
)</code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank test
## 
## data:  happiness$after and happiness$before
## V = 7, p-value = 0.03711
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div id="summary-11" class="section level2">
<h2><span class="header-section-number">13.11</span> Summary</h2>
<ul>
<li>A one sample <span class="math inline">\(t\)</span>-test is used to compare a single sample mean against a hypothesised value for the population mean. (Section <a href="ttest.html#onesamplettest">13.2</a>)</li>
<li>An independent samples <span class="math inline">\(t\)</span>-test is used to compare the means of two groups, and tests the null hypothesis that they have the same mean. It comes in two forms: the Student test (Section <a href="ttest.html#studentttest">13.3</a> assumes that the groups have the same standard deviation, the Welch test (Section <a href="ttest.html#welchttest">13.4</a>) does not.</li>
<li>A paired samples <span class="math inline">\(t\)</span>-test is used when you have two scores from each person, and you want to test the null hypothesis that the two scores have the same mean. It is equivalent to taking the difference between the two scores for each person, and then running a one sample <span class="math inline">\(t\)</span>-test on the difference scores. (Section <a href="ttest.html#pairedsamplesttest">13.5</a>)</li>
<li>Effect size calculations for the difference between means can be calculated via the Cohen’s <span class="math inline">\(d\)</span> statistic. (Section <a href="ttest.html#cohensd">13.8</a>).</li>
<li>You can check the normality of a sample using QQ plots and the Shapiro-Wilk test. (Section <a href="ttest.html#shapiro">13.9</a>)</li>
<li>If your data are non-normal, you can use Wilcoxon tests instead of <span class="math inline">\(t\)</span>-tests. (Section <a href="ttest.html#wilcox">13.10</a>)</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Student1908">
<p>Student, A. 1908. “The Probable Error of a Mean.” <em>Biometrika</em> 6: 1–2.</p>
</div>
<div id="ref-Box1987">
<p>Box, J. F. 1987. “Guinness, Gosset, Fisher, and Small Samples.” <em>Statistical Science</em> 2: 45–52.</p>
</div>
<div id="ref-Welch1947">
<p>Welch, B. L. 1947. “The Generalization of ‘Student’s’ Problem When Several Different Population Variances Are Involved.” <em>Biometrika</em> 34: 28–35.</p>
</div>
<div id="ref-Cohen1988">
<p>Cohen, J. 1988. <em>Statistical Power Analysis for the Behavioral Sciences</em>. 2nd ed. Lawrence Erlbaum.</p>
</div>
<div id="ref-McGrath2006">
<p>McGrath, R. E., and G. J. Meyer. 2006. “When Effect Sizes Disagree: The Case of <span class="math inline">\(r\)</span> and <span class="math inline">\(d\)</span>.” <em>Psychological Methods</em> 11: 386–401.</p>
</div>
<div id="ref-Hedges1981">
<p>Hedges, L. V. 1981. “Distribution Theory for Glass’s Estimator of Effect Size and Related Estimators.” <em>Journal of Educational Statistics</em> 6: 107–28.</p>
</div>
<div id="ref-Hedges1985">
<p>Hedges, L. V., and I. Olkin. 1985. <em>Statistical Methods for Meta-Analysis</em>. New York: Academic Press.</p>
</div>
<div id="ref-Shapiro1965">
<p>Shapiro, S. S., and M. B. Wilk. 1965. “An Analysis of Variance Test for Normality (Complete Samples).” <em>Biometrika</em> 52: 591–611.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="185">
<li id="fn185"><p>We won’t cover multiple predictors until Chapter <a href="regression.html#regression">15</a><a href="ttest.html#fnref185">↩</a></p></li>
<li id="fn186"><p>Informal experimentation in my garden suggests that yes, it does. Australian natives are adapted to low phosphorus levels relative to everywhere else on Earth, apparently, so if you’ve bought a house with a bunch of exotics and you want to plant natives, don’t follow my example: keep them separate. Nutrients to European plants are poison to Australian ones. There’s probably a joke in that, but I can’t figure out what it is.<a href="ttest.html#fnref186">↩</a></p></li>
<li id="fn187"><p>Actually this is too strong. Strictly speaking the <span class="math inline">\(z\)</span> test only requires that the sampling distribution of the mean be normally distributed; if the population is normal then it necessarily follows that the sampling distribution of the mean is also normal. However, as we saw when talking about the central limit theorem, it’s quite possible (even commonplace) for the sampling distribution to be normal even if the population distribution itself is non-normal. However, in light of the sheer ridiculousness of the assumption that the true standard deviation is known, there really isn’t much point in going into details on this front!<a href="ttest.html#fnref187">↩</a></p></li>
<li id="fn188"><p>Well, sort of. As I understand the history, Gosset only provided a partial solution: the general solution to the problem was provided by Sir Ronald Fisher.<a href="ttest.html#fnref188">↩</a></p></li>
<li id="fn189"><p>More seriously, I tend to think the reverse is true: I get very suspicious of technical reports that fill their results sections with nothing except the numbers. It might just be that I’m an arrogant jerk, but I often feel like an author that makes no attempt to explain and interpret their analysis to the reader either doesn’t understand it themselves, or is being a bit lazy. Your readers are smart, but not infinitely patient. Don’t annoy them if you can help it.<a href="ttest.html#fnref189">↩</a></p></li>
<li id="fn190"><p>Although it is the simplest, which is why I started with it.<a href="ttest.html#fnref190">↩</a></p></li>
<li id="fn191"><p>A funny question almost always pops up at this point: what the heck <em>is</em> the population being referred to in this case? Is it the set of students actually taking Dr Harpo’s class (all 33 of them)? The set of people who might take the class (an unknown number) of them? Or something else? Does it matter which of these we pick? It’s traditional in an introductory behavioural stats class to mumble a lot at this point, but since I get asked this question every year by my students, I’ll give a brief answer. Technically yes, it does matter: if you change your definition of what the “real world” population actually is, then the sampling distribution of your observed mean <span class="math inline">\(\bar{X}\)</span> changes too. The <span class="math inline">\(t\)</span>-test relies on an assumption that the observations are sampled at random from an infinitely large population; and to the extent that real life isn’t like that, then the <span class="math inline">\(t\)</span>-test can be wrong. In practice, however, this isn’t usually a big deal: even though the assumption is almost always wrong, it doesn’t lead to a lot of pathological behaviour from the test, so we tend to just ignore it.<a href="ttest.html#fnref191">↩</a></p></li>
<li id="fn192"><p>Yes, I have a “favourite” way of thinking about pooled standard deviation estimates. So what?<a href="ttest.html#fnref192">↩</a></p></li>
<li id="fn193"><p>A more correct notation will be introduced in Chapter <a href="anova.html#anova">14</a>.<a href="ttest.html#fnref193">↩</a></p></li>
<li id="fn194"><p>Well, I guess you can average apples and oranges, and what you end up with is a delicious fruit smoothie. But no one really thinks that a fruit smoothie is a very good way to describe the original fruits, do they?<a href="ttest.html#fnref194">↩</a></p></li>
<li id="fn195"><p>This design is very similar to the one in Section <a href="chisquare.html#mcnemar">12.8</a> that motivated the McNemar test. This should be no surprise. Both are standard repeated measures designs involving two measurements. The only difference is that this time our outcome variable is interval scale (working memory capacity) rather than a binary, nominal scale variable (a yes-or-no question).<a href="ttest.html#fnref195">↩</a></p></li>
<li id="fn196"><p>At this point we have Drs Harpo, Chico and Zeppo. No prizes for guessing who Dr Groucho is.<a href="ttest.html#fnref196">↩</a></p></li>
<li id="fn197"><p>This is obviously a class being taught at a very small or very expensive university, or else is a postgraduate class. <em>I’ve</em> never taught an intro stats class with less than 350 students.<a href="ttest.html#fnref197">↩</a></p></li>
<li id="fn198"><p>The <code>sortFrame()</code> function sorts factor variables like <code>id</code> in alphabetical order, which is why it jumps from “student1” to “student10”<a href="ttest.html#fnref198">↩</a></p></li>
<li id="fn199"><p>This is a massive oversimplification.<a href="ttest.html#fnref199">↩</a></p></li>
<li id="fn200"><p>Either that, or the Kolmogorov-Smirnov test, which is probably more traditional than the Shapiro-Wilk, though most things I’ve read seem to suggest Shapiro-Wilk is the better test of normality; although Kolomogorov-Smirnov is a general purpose test of distributional equivalence, so it can be adapted to handle other kinds of distribution tests; in R it’s implemented via the <code>ks.test()</code> function.<a href="ttest.html#fnref200">↩</a></p></li>
<li id="fn201"><p>Actually, there are two different versions of the test statistic; they differ from each other by a constant value. The version that I’ve described is the one that R calculates.<a href="ttest.html#fnref201">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chisquare.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
